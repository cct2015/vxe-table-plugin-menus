"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = exports.VXETablePluginMenus = void 0;

var _xeUtils = _interopRequireDefault(require("xe-utils/methods/xe-utils"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

var menuMap = {
  CLEAR_CELL: function CLEAR_CELL(_ref) {
    var $table = _ref.$table,
        row = _ref.row,
        column = _ref.column;

    if (row && column) {
      $table.clearData(row, column.property);
    }
  },
  CLEAR_ROW: function CLEAR_ROW(_ref2) {
    var $table = _ref2.$table,
        row = _ref2.row;

    if (row) {
      $table.clearData(row);
    }
  },
  CLEAR_SELECTED_ROW: function CLEAR_SELECTED_ROW(_ref3) {
    var $table = _ref3.$table;
    $table.clearData($table.getSelectRecords());
  },
  CLEAR_ALL: function CLEAR_ALL(_ref4) {
    var $table = _ref4.$table;
    $table.clearData();
  },
  REVERT_CELL: function REVERT_CELL(_ref5) {
    var $table = _ref5.$table,
        row = _ref5.row,
        column = _ref5.column;

    if (row && column) {
      $table.revertData(row, column.property);
    }
  },
  REVERT_ROW: function REVERT_ROW(_ref6) {
    var $table = _ref6.$table,
        row = _ref6.row;

    if (row) {
      $table.revertData(row);
    }
  },
  REVERT_SELECTED_ROW: function REVERT_SELECTED_ROW(_ref7) {
    var $table = _ref7.$table;
    $table.revertData($table.getSelectRecords());
  },
  REVERT_ALL: function REVERT_ALL(_ref8) {
    var $table = _ref8.$table;
    $table.revertData();
  },
  INSERT_ROW: function INSERT_ROW(_ref9) {
    var $table = _ref9.$table,
        menu = _ref9.menu;
    $table.insert(menu.params);
  },
  INSERT_ACTIVED_ROW: function INSERT_ACTIVED_ROW(_ref10) {
    var $table = _ref10.$table,
        menu = _ref10.menu,
        column = _ref10.column;
    var args = menu.params || [];
    $table.insert(args[0]).then(function (_ref11) {
      var row = _ref11.row;
      return $table.setActiveCell(row, args[1] || column.property);
    });
  },
  INSERT_AT_ROW: function INSERT_AT_ROW(_ref12) {
    var $table = _ref12.$table,
        menu = _ref12.menu,
        row = _ref12.row;

    if (row) {
      $table.insertAt(menu.params, row);
    }
  },
  INSERT_AT_ACTIVED_ROW: function INSERT_AT_ACTIVED_ROW(_ref13) {
    var $table = _ref13.$table,
        menu = _ref13.menu,
        row = _ref13.row,
        column = _ref13.column;

    if (row) {
      var args = menu.params || [];
      $table.insertAt(args[0], row).then(function (_ref14) {
        var row = _ref14.row;
        return $table.setActiveCell(row, args[1] || column.property);
      });
    }
  },
  DELETE_ROW: function DELETE_ROW(_ref15) {
    var $table = _ref15.$table,
        row = _ref15.row;

    if (row) {
      $table.remove(row);
    }
  },
  DELETE_SELECTED_ROW: function DELETE_SELECTED_ROW(_ref16) {
    var $table = _ref16.$table;
    $table.removeSelecteds();
  },
  DELETE_ALL: function DELETE_ALL(_ref17) {
    var $table = _ref17.$table;
    $table.remove();
  },
  CLEAR_SORT: function CLEAR_SORT(_ref18) {
    var $table = _ref18.$table;
    $table.clearSort();
  },
  SORT_ASC: function SORT_ASC(_ref19, evnt) {
    var $table = _ref19.$table,
        column = _ref19.column;

    if (column) {
      $table.triggerSortEvent(evnt, column, 'asc');
    }
  },
  SORT_DESC: function SORT_DESC(_ref20, evnt) {
    var $table = _ref20.$table,
        column = _ref20.column;

    if (column) {
      $table.triggerSortEvent(evnt, column, 'desc');
    }
  },
  CLEAR_FILTER: function CLEAR_FILTER(_ref21) {
    var $table = _ref21.$table,
        column = _ref21.column;

    if (column) {
      $table.clearFilter(column.property);
    }
  },
  CLEAR_ALL_FILTER: function CLEAR_ALL_FILTER(_ref22) {
    var $table = _ref22.$table;
    $table.clearFilter();
  },
  FILTER_CELL: function FILTER_CELL(_ref23) {
    var $table = _ref23.$table,
        row = _ref23.row,
        column = _ref23.column;

    if (row && column) {
      var property = column.property;
      $table.filter(property).then(function (options) {
        if (options.length) {
          var option = options[0];
          option.data = _xeUtils["default"].get(row, property);
          option.checked = true;
        }
      }).then(function () {
        return $table.updateData();
      });
    }
  },
  EXPORT_ROW: function EXPORT_ROW(_ref24) {
    var $table = _ref24.$table,
        menu = _ref24.menu,
        row = _ref24.row;

    if (row) {
      var opts = {
        data: [row]
      };
      $table.exportData(_xeUtils["default"].assign(opts, menu.params[0]));
    }
  },
  EXPORT_SELECTED_ROW: function EXPORT_SELECTED_ROW(_ref25) {
    var $table = _ref25.$table,
        menu = _ref25.menu;
    var opts = {
      data: $table.getSelectRecords()
    };
    $table.exportData(_xeUtils["default"].assign(opts, menu.params[0]));
  },
  EXPORT_ALL: function EXPORT_ALL(_ref26) {
    var $table = _ref26.$table,
        menu = _ref26.menu;
    $table.exportData(menu.params);
  },
  PRINT_ALL: function PRINT_ALL(_ref27) {
    var $table = _ref27.$table,
        menu = _ref27.menu;
    $table.print(menu.params);
  },
  PRINT_SELECTED_ROW: function PRINT_SELECTED_ROW(_ref28) {
    var $table = _ref28.$table,
        menu = _ref28.menu;
    var opts = {
      data: $table.getSelectRecords()
    };
    $table.print(_xeUtils["default"].assign(opts, menu.params));
  },
  HIDDEN_COLUMN: function HIDDEN_COLUMN(_ref29) {
    var $table = _ref29.$table,
        column = _ref29.column;

    if (column) {
      $table.hideColumn();
    }
  },
  RESET_COLUMN: function RESET_COLUMN(_ref30) {
    var $table = _ref30.$table;
    $table.resetCustoms();
  },
  RESET_RESIZABLE: function RESET_RESIZABLE(_ref31) {
    var $table = _ref31.$table;
    $table.resetResizable();
  },
  RESET_ALL: function RESET_ALL(_ref32) {
    var $table = _ref32.$table;
    $table.resetAll();
  }
};

function checkPrivilege(item, params) {
  var code = item.code;
  var columns = params.columns,
      column = params.column;

  switch (code) {
    case 'CLEAR_SORT':
      item.disabled = !columns.some(function (column) {
        return column.sortable && column.order;
      });
      break;

    case 'CLEAR_ALL_FILTER':
      item.disabled = !columns.some(function (column) {
        return column.filters && column.filters.some(function (option) {
          return option.checked;
        });
      });
      break;

    case 'CLEAR_CELL':
    case 'CLEAR_ROW':
    case 'REVERT_CELL':
    case 'REVERT_ROW':
    case 'INSERT_AT_ROW':
    case 'INSERT_AT_ACTIVED_ROW':
    case 'DELETE_ROW':
    case 'SORT_ASC':
    case 'SORT_DESC':
    case 'CLEAR_FILTER':
    case 'FILTER_CELL':
    case 'EXPORT_ROW':
    case 'HIDDEN_COLUMN':
      item.disabled = !column;

      if (!item.disabled) {
        switch (code) {
          case 'SORT_ASC':
          case 'SORT_DESC':
            item.disabled = !column.sortable;
            break;

          case 'FILTER_CELL':
          case 'CLEAR_FILTER':
            item.disabled = !column.filters || !column.filters.length;

            if (!item.disabled) {
              switch (code) {
                case 'CLEAR_FILTER':
                  item.disabled = !column.filters.some(function (option) {
                    return option.checked;
                  });
                  break;
              }
            }

            break;
        }
      }

      break;
  }
}

function handlePrivilegeEvent(params) {
  params.options.forEach(function (list) {
    list.forEach(function (item) {
      checkPrivilege(item, params);

      if (item.children) {
        item.children.forEach(function (child) {
          checkPrivilege(child, params);
        });
      }
    });
  });
}
/**
 * 基于 vxe-table 表格的增强插件，提供实用的快捷菜单集
 */


var VXETablePluginMenus = {
  install: function install(xtable) {
    xtable.interceptor.add('event.showMenu', handlePrivilegeEvent);
    xtable.menus.mixin(menuMap);
  }
};
exports.VXETablePluginMenus = VXETablePluginMenus;

if (typeof window !== 'undefined' && window.VXETable) {
  window.VXETable.use(VXETablePluginMenus);
}

var _default = VXETablePluginMenus;
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LnRzIl0sIm5hbWVzIjpbIm1lbnVNYXAiLCJDTEVBUl9DRUxMIiwiJHRhYmxlIiwicm93IiwiY29sdW1uIiwiY2xlYXJEYXRhIiwicHJvcGVydHkiLCJDTEVBUl9ST1ciLCJDTEVBUl9TRUxFQ1RFRF9ST1ciLCJnZXRTZWxlY3RSZWNvcmRzIiwiQ0xFQVJfQUxMIiwiUkVWRVJUX0NFTEwiLCJyZXZlcnREYXRhIiwiUkVWRVJUX1JPVyIsIlJFVkVSVF9TRUxFQ1RFRF9ST1ciLCJSRVZFUlRfQUxMIiwiSU5TRVJUX1JPVyIsIm1lbnUiLCJpbnNlcnQiLCJwYXJhbXMiLCJJTlNFUlRfQUNUSVZFRF9ST1ciLCJhcmdzIiwidGhlbiIsInNldEFjdGl2ZUNlbGwiLCJJTlNFUlRfQVRfUk9XIiwiaW5zZXJ0QXQiLCJJTlNFUlRfQVRfQUNUSVZFRF9ST1ciLCJERUxFVEVfUk9XIiwicmVtb3ZlIiwiREVMRVRFX1NFTEVDVEVEX1JPVyIsInJlbW92ZVNlbGVjdGVkcyIsIkRFTEVURV9BTEwiLCJDTEVBUl9TT1JUIiwiY2xlYXJTb3J0IiwiU09SVF9BU0MiLCJldm50IiwidHJpZ2dlclNvcnRFdmVudCIsIlNPUlRfREVTQyIsIkNMRUFSX0ZJTFRFUiIsImNsZWFyRmlsdGVyIiwiQ0xFQVJfQUxMX0ZJTFRFUiIsIkZJTFRFUl9DRUxMIiwiZmlsdGVyIiwib3B0aW9ucyIsImxlbmd0aCIsIm9wdGlvbiIsImRhdGEiLCJYRVV0aWxzIiwiZ2V0IiwiY2hlY2tlZCIsInVwZGF0ZURhdGEiLCJFWFBPUlRfUk9XIiwib3B0cyIsImV4cG9ydERhdGEiLCJhc3NpZ24iLCJFWFBPUlRfU0VMRUNURURfUk9XIiwiRVhQT1JUX0FMTCIsIlBSSU5UX0FMTCIsInByaW50IiwiUFJJTlRfU0VMRUNURURfUk9XIiwiSElEREVOX0NPTFVNTiIsImhpZGVDb2x1bW4iLCJSRVNFVF9DT0xVTU4iLCJyZXNldEN1c3RvbXMiLCJSRVNFVF9SRVNJWkFCTEUiLCJyZXNldFJlc2l6YWJsZSIsIlJFU0VUX0FMTCIsInJlc2V0QWxsIiwiY2hlY2tQcml2aWxlZ2UiLCJpdGVtIiwiY29kZSIsImNvbHVtbnMiLCJkaXNhYmxlZCIsInNvbWUiLCJzb3J0YWJsZSIsIm9yZGVyIiwiZmlsdGVycyIsImhhbmRsZVByaXZpbGVnZUV2ZW50IiwiZm9yRWFjaCIsImxpc3QiLCJjaGlsZHJlbiIsImNoaWxkIiwiVlhFVGFibGVQbHVnaW5NZW51cyIsImluc3RhbGwiLCJ4dGFibGUiLCJpbnRlcmNlcHRvciIsImFkZCIsIm1lbnVzIiwibWl4aW4iLCJ3aW5kb3ciLCJWWEVUYWJsZSIsInVzZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOzs7O0FBR0EsSUFBTUEsT0FBTyxHQUFHO0FBQ2RDLEVBQUFBLFVBRGMsNEJBQ3lCO0FBQUEsUUFBMUJDLE1BQTBCLFFBQTFCQSxNQUEwQjtBQUFBLFFBQWxCQyxHQUFrQixRQUFsQkEsR0FBa0I7QUFBQSxRQUFiQyxNQUFhLFFBQWJBLE1BQWE7O0FBQ3JDLFFBQUlELEdBQUcsSUFBSUMsTUFBWCxFQUFtQjtBQUNqQkYsTUFBQUEsTUFBTSxDQUFDRyxTQUFQLENBQWlCRixHQUFqQixFQUFzQkMsTUFBTSxDQUFDRSxRQUE3QjtBQUNEO0FBQ0YsR0FMYTtBQU1kQyxFQUFBQSxTQU5jLDRCQU1nQjtBQUFBLFFBQWxCTCxNQUFrQixTQUFsQkEsTUFBa0I7QUFBQSxRQUFWQyxHQUFVLFNBQVZBLEdBQVU7O0FBQzVCLFFBQUlBLEdBQUosRUFBUztBQUNQRCxNQUFBQSxNQUFNLENBQUNHLFNBQVAsQ0FBaUJGLEdBQWpCO0FBQ0Q7QUFDRixHQVZhO0FBV2RLLEVBQUFBLGtCQVhjLHFDQVdvQjtBQUFBLFFBQWJOLE1BQWEsU0FBYkEsTUFBYTtBQUNoQ0EsSUFBQUEsTUFBTSxDQUFDRyxTQUFQLENBQWlCSCxNQUFNLENBQUNPLGdCQUFQLEVBQWpCO0FBQ0QsR0FiYTtBQWNkQyxFQUFBQSxTQWRjLDRCQWNXO0FBQUEsUUFBYlIsTUFBYSxTQUFiQSxNQUFhO0FBQ3ZCQSxJQUFBQSxNQUFN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QU9QLElBQUksT0FBT3lGLE1BQVAsS0FBa0IsV0FBbEIsSUFBaUNBLE1BQU0sQ0FBQ0MsUUFBNUMsRUFBc0Q7QUFDcERELEVBQUFBLE1BQU0sQ0FBQ0MsUUFBUCxDQUFnQkMsR0FBaEIsQ0FBb0JULG1CQUFwQjtBQUNEOztlQUVjQSxtQiIsImZpbGUiOiJpbmRleC5jb21tb24uanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgWEVVdGlscyBmcm9tICd4ZS11dGlscy9tZXRob2RzL3hlLXV0aWxzJ1xyXG5pbXBvcnQgVlhFVGFibGUgZnJvbSAndnhlLXRhYmxlL2xpYi92eGUtdGFibGUnXHJcblxyXG5jb25zdCBtZW51TWFwID0ge1xyXG4gIENMRUFSX0NFTEwoeyAkdGFibGUsIHJvdywgY29sdW1uIH06IGFueSkge1xyXG4gICAgaWYgKHJvdyAmJiBjb2x1bW4pIHtcclxuICAgICAgJHRhYmxlLmNsZWFyRGF0YShyb3csIGNvbHVtbi5wcm9wZXJ0eSlcclxuICAgIH1cclxuICB9LFxyXG4gIENMRUFSX1JPVyh7ICR0YWJsZSwgcm93IH06IGFueSkge1xyXG4gICAgaWYgKHJvdykge1xyXG4gICAgICAkdGFibGUuY2xlYXJEYXRhKHJvdylcclxuICAgIH1cclxuICB9LFxyXG4gIENMRUFSX1NFTEVDVEVEX1JPVyh7ICR0YWJsZSB9OiBhbnkpIHtcclxuICAgICR0YWJsZS5jbGVhckRhdGEoJHRhYmxlLmdldFNlbGVjdFJlY29yZHMoKSlcclxuICB9LFxyXG4gIENMRUFSX0FMTCh7ICR0YWJsZSB9OiBhbnkpIHtcclxuICAgICR0YWJsZS5jbGVhckRhdGEoKVxyXG4gIH0sXHJcbiAgUkVWRVJUX0NFTEwoeyAkdGFibGUsIHJvdywgY29sdW1uIH06IGFueSkge1xyXG4gICAgaWYgKHJvdyAmJiBjb2x1bW4pIHtcclxuICAgICAgJHRhYmxlLnJldmVydERhdGEocm93LCBjb2x1bW4ucHJvcGVydHkpXHJcbiAgICB9XHJcbiAgfSxcclxuICBSRVZFUlRfUk9XKHsgJHRhYmxlLCByb3cgfTogYW55KSB7XHJcbiAgICBpZiAocm93KSB7XHJcbiAgICAgICR0YWJsZS5yZXZlcnREYXRhKHJvdylcclxuICAgIH1cclxuICB9LFxyXG4gIFJFVkVSVF9TRUxFQ1RFRF9ST1coeyAkdGFibGUgfTogYW55KSB7XHJcbiAgICAkdGFibGUucmV2ZXJ0RGF0YSgkdGFibGUuZ2V0U2VsZWN0UmVjb3JkcygpKVxyXG4gIH0sXHJcbiAgUkVWRVJUX0FMTCh7ICR0YWJsZSB9OiBhbnkpIHtcclxuICAgICR0YWJsZS5yZXZlcnREYXRhKClcclxuICB9LFxyXG4gIElOU0VSVF9ST1coeyAkdGFibGUsIG1lbnUgfTogYW55KSB7XHJcbiAgICAkdGFibGUuaW5zZXJ0KG1lbnUucGFyYW1zKVxyXG4gIH0sXHJcbiAgSU5TRVJUX0FDVElWRURfUk9XKHsgJHRhYmxlLCBtZW51LCBjb2x1bW4gfTogYW55KSB7XHJcbiAgICBjb25zdCBhcmdzID0gbWVudS5wYXJhbXMgfHwgW11cclxuICAgICR0YWJsZS5pbnNlcnQoYXJnc1swXSlcclxuICAgICAgLnRoZW4oKHsgcm93IH06IGFueSkgPT4gJHRhYmxlLnNldEFjdGl2ZUNlbGwocm93LCBhcmdzWzFdIHx8IGNvbHVtbi5wcm9wZXJ0eSkpXHJcbiAgfSxcclxuICBJTlNFUlRfQVRfUk9XKHsgJHRhYmxlLCBtZW51LCByb3cgfTogYW55KSB7XHJcbiAgICBpZiAocm93KSB7XHJcbiAgICAgICR0YWJsZS5pbnNlcnRBdChtZW51LnBhcmFtcywgcm93KVxyXG4gICAgfVxyXG4gIH0sXHJcbiAgSU5TRVJUX0FUX0FDVElWRURfUk9XKHsgJHRhYmxlLCBtZW51LCByb3csIGNvbHVtbiB9OiBhbnkpIHtcclxuICAgIGlmIChyb3cpIHtcclxuICAgICAgY29uc3QgYXJncyA9IG1lbnUucGFyYW1zIHx8IFtdXHJcbiAgICAgICR0YWJsZS5pbnNlcnRBdChhcmdzWzBdLCByb3cpXHJcbiAgICAgICAgLnRoZW4oKHsgcm93IH06IGFueSkgPT4gJHRhYmxlLnNldEFjdGl2ZUNlbGwocm93LCBhcmdzWzFdIHx8IGNvbHVtbi5wcm9wZXJ0eSkpXHJcbiAgICB9XHJcbiAgfSxcclxuICBERUxFVEVfUk9XKHsgJHRhYmxlLCByb3cgfTogYW55KSB7XHJcbiAgICBpZiAocm93KSB7XHJcbiAgICAgICR0YWJsZS5yZW1vdmUocm93KVxyXG4gICAgfVxyXG4gIH0sXHJcbiAgREVMRVRFX1NFTEVDVEVEX1JPVyh7ICR0YWJsZSB9OiBhbnkpIHtcclxuICAgICR0YWJsZS5yZW1vdmVTZWxlY3RlZHMoKVxyXG4gIH0sXHJcbiAgREVMRVRFX0FMTCh7ICR0YWJsZSB9OiBhbnkpIHtcclxuICAgICR0YWJsZS5yZW1vdmUoKVxyXG4gIH0sXHJcbiAgQ0xFQVJfU09SVCh7ICR0YWJsZSB9OiBhbnkpIHtcclxuICAgICR0YWJsZS5jbGVhclNvcnQoKVxyXG4gIH0sXHJcbiAgU09SVF9BU0MoeyAkdGFibGUsIGNvbHVtbiB9OiBhbnksIGV2bnQ6IGFueSkge1xyXG4gICAgaWYgKGNvbHVtbikge1xyXG4gICAgICAkdGFibGUudHJpZ2dlclNvcnRFdmVudChldm50LCBjb2x1bW4sICdhc2MnKVxyXG4gICAgfVxyXG4gIH0sXHJcbiAgU09SVF9ERVNDKHsgJHRhYmxlLCBjb2x1bW4gfTogYW55LCBldm50OiBhbnkpIHtcclxuICAgIGlmIChjb2x1bW4pIHtcclxuICAgICAgJHRhYmxlLnRyaWdnZXJTb3J0RXZlbnQoZXZudCwgY29sdW1uLCAnZGVzYycpXHJcbiAgICB9XHJcbiAgfSxcclxuICBDTEVBUl9GSUxURVIoeyAkdGFibGUsIGNvbHVtbiB9OiBhbnkpIHtcclxuICAgIGlmIChjb2x1bW4pIHtcclxuICAgICAgJHRhYmxlLmNsZWFyRmlsdGVyKGNvbHVtbi5wcm9wZXJ0eSlcclxuICAgIH1cclxuICB9LFxyXG4gIENMRUFSX0FMTF9GSUxURVIoeyAkdGFibGUgfTogYW55KSB7XHJcbiAgICAkdGFibGUuY2xlYXJGaWx0ZXIoKVxyXG4gIH0sXHJcbiAgRklMVEVSX0NFTEwoeyAkdGFibGUsIHJvdywgY29sdW1uIH06IGFueSkge1xyXG4gICAgaWYgKHJvdyAmJiBjb2x1bW4pIHtcclxuICAgICAgbGV0IHsgcHJvcGVydHkgfSA9IGNvbHVtblxyXG4gICAgICAkdGFibGUuZmlsdGVyKHByb3BlcnR5KVxyXG4gICAgICAgIC50aGVuKChvcHRpb25zOiBBcnJheTxhbnk+KSA9PiB7XHJcbiAgICAgICAgICBpZiAob3B0aW9ucy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgbGV0IG9wdGlvbiA9IG9wdGlvbnNbMF1cclxuICAgICAgICAgICAgb3B0aW9uLmRhdGEgPSBYRVV0aWxzLmdldChyb3csIHByb3BlcnR5KVxyXG4gICAgICAgICAgICBvcHRpb24uY2hlY2tlZCA9IHRydWVcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgICAgIC50aGVuKCgpID0+ICR0YWJsZS51cGRhdGVEYXRhKCkpXHJcbiAgICB9XHJcbiAgfSxcclxuICBFWFBPUlRfUk9XKHsgJHRhYmxlLCBtZW51LCByb3cgfTogYW55KSB7XHJcbiAgICBpZiAocm93KSB7XHJcbiAgICAgIGxldCBvcHRzID0geyBkYXRhOiBbcm93XSB9XHJcbiAgICAgICR0YWJsZS5leHBvcnREYXRhKFhFVXRpbHMuYXNzaWduKG9wdHMsIG1lbnUucGFyYW1zWzBdKSlcclxuICAgIH1cclxuICB9LFxyXG4gIEVYUE9SVF9TRUxFQ1RFRF9ST1coeyAkdGFibGUsIG1lbnUgfTogYW55KSB7XHJcbiAgICBsZXQgb3B0cyA9IHsgZGF0YTogJHRhYmxlLmdldFNlbGVjdFJlY29yZHMoKSB9XHJcbiAgICAkdGFibGUuZXhwb3J0RGF0YShYRVV0aWxzLmFzc2lnbihvcHRzLCBtZW51LnBhcmFtc1swXSkpXHJcbiAgfSxcclxuICBFWFBPUlRfQUxMKHsgJHRhYmxlLCBtZW51IH06IGFueSkge1xyXG4gICAgJHRhYmxlLmV4cG9ydERhdGEobWVudS5wYXJhbXMpXHJcbiAgfSxcclxuICBQUklOVF9BTEwoeyAkdGFibGUsIG1lbnUgfTogYW55KSB7XHJcbiAgICAkdGFibGUucHJpbnQobWVudS5wYXJhbXMpXHJcbiAgfSxcclxuICBQUklOVF9TRUxFQ1RFRF9ST1coeyAkdGFibGUsIG1lbnUgfTogYW55KSB7XHJcbiAgICBsZXQgb3B0cyA9IHsgZGF0YTogJHRhYmxlLmdldFNlbGVjdFJlY29yZHMoKSB9XHJcbiAgICAkdGFibGUucHJpbnQoWEVVdGlscy5hc3NpZ24ob3B0cywgbWVudS5wYXJhbXMpKVxyXG4gIH0sXHJcbiAgSElEREVOX0NPTFVNTih7ICR0YWJsZSwgY29sdW1uIH06IGFueSkge1xyXG4gICAgaWYgKGNvbHVtbikge1xyXG4gICAgICAkdGFibGUuaGlkZUNvbHVtbigpXHJcbiAgICB9XHJcbiAgfSxcclxuICBSRVNFVF9DT0xVTU4oeyAkdGFibGUgfTogYW55KSB7XHJcbiAgICAkdGFibGUucmVzZXRDdXN0b21zKClcclxuICB9LFxyXG4gIFJFU0VUX1JFU0laQUJMRSh7ICR0YWJsZSB9OiBhbnkpIHtcclxuICAgICR0YWJsZS5yZXNldFJlc2l6YWJsZSgpXHJcbiAgfSxcclxuICBSRVNFVF9BTEwoeyAkdGFibGUgfTogYW55KSB7XHJcbiAgICAkdGFibGUucmVzZXRBbGwoKVxyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gY2hlY2tQcml2aWxlZ2UoaXRlbTogYW55LCBwYXJhbXM6IGFueSkge1xyXG4gIGxldCB7IGNvZGUgfSA9IGl0ZW1cclxuICBsZXQgeyBjb2x1bW5zLCBjb2x1bW4gfSA9IHBhcmFtc1xyXG4gIHN3aXRjaCAoY29kZSkge1xyXG4gICAgY2FzZSAnQ0xFQVJfU09SVCc6XHJcbiAgICAgIGl0ZW0uZGlzYWJsZWQgPSAhY29sdW1ucy5zb21lKChjb2x1bW46IGFueSkgPT4gY29sdW1uLnNvcnRhYmxlICYmIGNvbHVtbi5vcmRlcilcclxuICAgICAgYnJlYWtcclxuICAgIGNhc2UgJ0NMRUFSX0FMTF9GSUxURVInOlxyXG4gICAgICBpdGVtLmRpc2FibGVkID0gIWNvbHVtbnMuc29tZSgoY29sdW1uOiBhbnkpID0+IGNvbHVtbi5maWx0ZXJzICYmIGNvbHVtbi5maWx0ZXJzLnNvbWUoKG9wdGlvbjogYW55KSA9PiBvcHRpb24uY2hlY2tlZCkpXHJcbiAgICAgIGJyZWFrXHJcbiAgICBjYXNlICdDTEVBUl9DRUxMJzpcclxuICAgIGNhc2UgJ0NMRUFSX1JPVyc6XHJcbiAgICBjYXNlICdSRVZFUlRfQ0VMTCc6XHJcbiAgICBjYXNlICdSRVZFUlRfUk9XJzpcclxuICAgIGNhc2UgJ0lOU0VSVF9BVF9ST1cnOlxyXG4gICAgY2FzZSAnSU5TRVJUX0FUX0FDVElWRURfUk9XJzpcclxuICAgIGNhc2UgJ0RFTEVURV9ST1cnOlxyXG4gICAgY2FzZSAnU09SVF9BU0MnOlxyXG4gICAgY2FzZSAnU09SVF9ERVNDJzpcclxuICAgIGNhc2UgJ0NMRUFSX0ZJTFRFUic6XHJcbiAgICBjYXNlICdGSUxURVJfQ0VMTCc6XHJcbiAgICBjYXNlICdFWFBPUlRfUk9XJzpcclxuICAgIGNhc2UgJ0hJRERFTl9DT0xVTU4nOlxyXG4gICAgICBpdGVtLmRpc2FibGVkID0gIWNvbHVtblxyXG4gICAgICBpZiAoIWl0ZW0uZGlzYWJsZWQpIHtcclxuICAgICAgICBzd2l0Y2ggKGNvZGUpIHtcclxuICAgICAgICAgIGNhc2UgJ1NPUlRfQVNDJzpcclxuICAgICAgICAgIGNhc2UgJ1NPUlRfREVTQyc6XHJcbiAgICAgICAgICAgIGl0ZW0uZGlzYWJsZWQgPSAhY29sdW1uLnNvcnRhYmxlXHJcbiAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgICBjYXNlICdGSUxURVJfQ0VMTCc6XHJcbiAgICAgICAgICBjYXNlICdDTEVBUl9GSUxURVInOlxyXG4gICAgICAgICAgICBpdGVtLmRpc2FibGVkID0gIWNvbHVtbi5maWx0ZXJzIHx8ICFjb2x1bW4uZmlsdGVycy5sZW5ndGhcclxuICAgICAgICAgICAgaWYgKCFpdGVtLmRpc2FibGVkKSB7XHJcbiAgICAgICAgICAgICAgc3dpdGNoIChjb2RlKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdDTEVBUl9GSUxURVInOlxyXG4gICAgICAgICAgICAgICAgICBpdGVtLmRpc2FibGVkID0gIWNvbHVtbi5maWx0ZXJzLnNvbWUoKG9wdGlvbjogYW55KSA9PiBvcHRpb24uY2hlY2tlZClcclxuICAgICAgICAgICAgICAgICAgYnJlYWtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgYnJlYWtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgYnJlYWtcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZVByaXZpbGVnZUV2ZW50KHBhcmFtczogYW55KSB7XHJcbiAgcGFyYW1zLm9wdGlvbnMuZm9yRWFjaCgobGlzdDogQXJyYXk8YW55PikgPT4ge1xyXG4gICAgbGlzdC5mb3JFYWNoKChpdGVtOiBhbnkpID0+IHtcclxuICAgICAgY2hlY2tQcml2aWxlZ2UoaXRlbSwgcGFyYW1zKVxyXG4gICAgICBpZiAoaXRlbS5jaGlsZHJlbikge1xyXG4gICAgICAgIGl0ZW0uY2hpbGRyZW4uZm9yRWFjaCgoY2hpbGQ6IGFueSkgPT4ge1xyXG4gICAgICAgICAgY2hlY2tQcml2aWxlZ2UoY2hpbGQsIHBhcmFtcylcclxuICAgICAgICB9KVxyXG4gICAgICB9XHJcbiAgICB9KVxyXG4gIH0pXHJcbn1cclxuXHJcbi8qKlxyXG4gKiDln7rkuo4gdnhlLXRhYmxlIOihqOagvOeahOWinuW8uuaPkuS7tu+8jOaPkOS+m+WunueUqOeahOW/q+aNt+iPnOWNlembhlxyXG4gKi9cclxuZXhwb3J0IGNvbnN0IFZYRVRhYmxlUGx1Z2luTWVudXMgPSB7XHJcbiAgaW5zdGFsbCh4dGFibGU6IHR5cGVvZiBWWEVUYWJsZSkge1xyXG4gICAgeHRhYmxlLmludGVyY2VwdG9yLmFkZCgnZXZlbnQuc2hvd01lbnUnLCBoYW5kbGVQcml2aWxlZ2VFdmVudClcclxuICAgIHh0YWJsZS5tZW51cy5taXhpbihtZW51TWFwKVxyXG4gIH1cclxufVxyXG5cclxuaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmIHdpbmRvdy5WWEVUYWJsZSkge1xyXG4gIHdpbmRvdy5WWEVUYWJsZS51c2UoVlhFVGFibGVQbHVnaW5NZW51cylcclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgVlhFVGFibGVQbHVnaW5NZW51c1xyXG4iXX0=
