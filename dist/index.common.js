"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = exports.VXETablePluginMenus = void 0;

var _xeUtils = _interopRequireDefault(require("xe-utils/methods/xe-utils"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

/* eslint-disable no-unused-vars */

/* eslint-enable no-unused-vars */
var menuMap = {
  CLEAR_CELL: function CLEAR_CELL(params) {
    var $table = params.$table,
        row = params.row,
        column = params.column;

    if (row && column) {
      $table.clearData(row, column.property);
    }
  },
  CLEAR_ROW: function CLEAR_ROW(params) {
    var $table = params.$table,
        row = params.row;

    if (row) {
      $table.clearData(row);
    }
  },
  CLEAR_SELECTED_ROW: function CLEAR_SELECTED_ROW(params) {
    var $table = params.$table;
    $table.clearData($table.getCheckboxRecords());
  },
  CLEAR_ALL: function CLEAR_ALL(params) {
    var $table = params.$table;
    $table.clearData();
  },
  REVERT_CELL: function REVERT_CELL(params) {
    var $table = params.$table,
        row = params.row,
        column = params.column;

    if (row && column) {
      $table.revertData(row, column.property);
    }
  },
  REVERT_ROW: function REVERT_ROW(params) {
    var $table = params.$table,
        row = params.row;

    if (row) {
      $table.revertData(row);
    }
  },
  REVERT_SELECTED_ROW: function REVERT_SELECTED_ROW(params) {
    var $table = params.$table;
    $table.revertData($table.getCheckboxRecords());
  },
  REVERT_ALL: function REVERT_ALL(params) {
    var $table = params.$table;
    $table.revertData();
  },
  INSERT_ROW: function INSERT_ROW(params) {
    var $table = params.$table,
        menu = params.menu;
    $table.insert(menu.params);
  },
  INSERT_ACTIVED_ROW: function INSERT_ACTIVED_ROW(params) {
    var $table = params.$table,
        menu = params.menu,
        column = params.column;
    var args = menu.params || [];
    $table.insert(args[0]).then(function (_ref) {
      var row = _ref.row;
      return $table.setActiveCell(row, args[1] || column.property);
    });
  },
  INSERT_AT_ROW: function INSERT_AT_ROW(params) {
    var $table = params.$table,
        menu = params.menu,
        row = params.row;

    if (row) {
      $table.insertAt(menu.params, row);
    }
  },
  INSERT_AT_ACTIVED_ROW: function INSERT_AT_ACTIVED_ROW(params) {
    var $table = params.$table,
        menu = params.menu,
        row = params.row,
        column = params.column;

    if (row) {
      var args = menu.params || [];
      $table.insertAt(args[0], row).then(function (_ref2) {
        var row = _ref2.row;
        return $table.setActiveCell(row, args[1] || column.property);
      });
    }
  },
  DELETE_ROW: function DELETE_ROW(params) {
    var $table = params.$table,
        row = params.row;

    if (row) {
      $table.remove(row);
    }
  },
  DELETE_SELECTED_ROW: function DELETE_SELECTED_ROW(params) {
    var $table = params.$table;
    $table.removeCheckboxRow();
  },
  DELETE_ALL: function DELETE_ALL(params) {
    var $table = params.$table;
    $table.remove();
  },
  CLEAR_SORT: function CLEAR_SORT(params) {
    var $table = params.$table;
    $table.clearSort();
  },
  SORT_ASC: function SORT_ASC(params) {
    var $table = params.$table,
        column = params.column;

    if (column) {
      $table.sort(column.property, 'asc');
    }
  },
  SORT_DESC: function SORT_DESC(params) {
    var $table = params.$table,
        column = params.column;

    if (column) {
      $table.sort(column.property, 'desc');
    }
  },
  CLEAR_FILTER: function CLEAR_FILTER(params) {
    var $table = params.$table,
        column = params.column;

    if (column) {
      $table.clearFilter(column.property);
    }
  },
  CLEAR_ALL_FILTER: function CLEAR_ALL_FILTER(params) {
    var $table = params.$table;
    $table.clearFilter();
  },
  FILTER_CELL: function FILTER_CELL(params) {
    var $table = params.$table,
        row = params.row,
        column = params.column;

    if (row && column) {
      var property = column.property,
          filters = column.filters;

      if (filters.length) {
        var option = filters[0];
        option.data = _xeUtils["default"].get(row, property);
        option.checked = true;
        $table.updateData();
      }
    }
  },
  EXPORT_ROW: function EXPORT_ROW(params) {
    var $table = params.$table,
        menu = params.menu,
        row = params.row;

    if (row) {
      var opts = {
        data: [row]
      };
      $table.exportData(_xeUtils["default"].assign(opts, menu.params[0]));
    }
  },
  EXPORT_SELECTED_ROW: function EXPORT_SELECTED_ROW(params) {
    var $table = params.$table,
        menu = params.menu;
    var opts = {
      data: $table.getCheckboxRecords()
    };
    $table.exportData(_xeUtils["default"].assign(opts, menu.params[0]));
  },
  EXPORT_ALL: function EXPORT_ALL(params) {
    var $table = params.$table,
        menu = params.menu;
    $table.exportData(menu.params);
  },
  PRINT_ALL: function PRINT_ALL(params) {
    var $table = params.$table,
        menu = params.menu;
    $table.print(menu.params);
  },
  PRINT_SELECTED_ROW: function PRINT_SELECTED_ROW(params) {
    var $table = params.$table,
        menu = params.menu;
    var opts = {
      data: $table.getCheckboxRecords()
    };
    $table.print(_xeUtils["default"].assign(opts, menu.params));
  },
  HIDDEN_COLUMN: function HIDDEN_COLUMN(params) {
    var $table = params.$table,
        column = params.column;

    if (column) {
      $table.hideColumn(column);
    }
  },
  RESET_COLUMN: function RESET_COLUMN(params) {
    var $table = params.$table;
    $table.resetColumn({
      visible: true,
      resizable: false
    });
  },
  RESET_RESIZABLE: function RESET_RESIZABLE(params) {
    var $table = params.$table;
    $table.resetColumn({
      visible: false,
      resizable: true
    });
  },
  RESET_ALL: function RESET_ALL(params) {
    var $table = params.$table;
    $table.resetColumn(true);
  }
};

function checkPrivilege(item, params) {
  var code = item.code;
  var columns = params.columns,
      column = params.column;

  switch (code) {
    case 'CLEAR_SORT':
      item.disabled = !columns.some(function (column) {
        return column.sortable && column.order;
      });
      break;

    case 'CLEAR_ALL_FILTER':
      item.disabled = !columns.some(function (column) {
        return column.filters && column.filters.some(function (option) {
          return option.checked;
        });
      });
      break;

    case 'CLEAR_CELL':
    case 'CLEAR_ROW':
    case 'REVERT_CELL':
    case 'REVERT_ROW':
    case 'INSERT_AT_ROW':
    case 'INSERT_AT_ACTIVED_ROW':
    case 'DELETE_ROW':
    case 'SORT_ASC':
    case 'SORT_DESC':
    case 'CLEAR_FILTER':
    case 'FILTER_CELL':
    case 'EXPORT_ROW':
    case 'HIDDEN_COLUMN':
      item.disabled = !column;

      if (column) {
        switch (code) {
          case 'SORT_ASC':
          case 'SORT_DESC':
            item.disabled = !column.sortable;
            break;

          case 'FILTER_CELL':
          case 'CLEAR_FILTER':
            item.disabled = !column.filters || !column.filters.length;

            if (!item.disabled) {
              switch (code) {
                case 'CLEAR_FILTER':
                  item.disabled = !column.filters.some(function (option) {
                    return option.checked;
                  });
                  break;
              }
            }

            break;
        }
      }

      break;
  }
}

function handlePrivilegeEvent(params) {
  params.options.forEach(function (list) {
    list.forEach(function (item) {
      checkPrivilege(item, params);

      if (item.children) {
        item.children.forEach(function (child) {
          checkPrivilege(child, params);
        });
      }
    });
  });
}
/**
 * 基于 vxe-table 表格的增强插件，提供实用的快捷菜单集
 */


var VXETablePluginMenus = {
  install: function install(_ref3) {
    var interceptor = _ref3.interceptor,
        menus = _ref3.menus;
    interceptor.add('event.showMenu', handlePrivilegeEvent);
    menus.mixin(menuMap);
  }
};
exports.VXETablePluginMenus = VXETablePluginMenus;

if (typeof window !== 'undefined' && window.VXETable) {
  window.VXETable.use(VXETablePluginMenus);
}

var _default = VXETablePluginMenus;
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LnRzIl0sIm5hbWVzIjpbIm1lbnVNYXAiLCJDTEVBUl9DRUxMIiwicGFyYW1zIiwiJHRhYmxlIiwicm93IiwiY29sdW1uIiwiY2xlYXJEYXRhIiwicHJvcGVydHkiLCJDTEVBUl9ST1ciLCJDTEVBUl9TRUxFQ1RFRF9ST1ciLCJnZXRDaGVja2JveFJlY29yZHMiLCJDTEVBUl9BTEwiLCJSRVZFUlRfQ0VMTCIsInJldmVydERhdGEiLCJSRVZFUlRfUk9XIiwiUkVWRVJUX1NFTEVDVEVEX1JPVyIsIlJFVkVSVF9BTEwiLCJJTlNFUlRfUk9XIiwibWVudSIsImluc2VydCIsIklOU0VSVF9BQ1RJVkVEX1JPVyIsImFyZ3MiLCJ0aGVuIiwic2V0QWN0aXZlQ2VsbCIsIklOU0VSVF9BVF9ST1ciLCJpbnNlcnRBdCIsIklOU0VSVF9BVF9BQ1RJVkVEX1JPVyIsIkRFTEVURV9ST1ciLCJyZW1vdmUiLCJERUxFVEVfU0VMRUNURURfUk9XIiwicmVtb3ZlQ2hlY2tib3hSb3ciLCJERUxFVEVfQUxMIiwiQ0xFQVJfU09SVCIsImNsZWFyU29ydCIsIlNPUlRfQVNDIiwic29ydCIsIlNPUlRfREVTQyIsIkNMRUFSX0ZJTFRFUiIsImNsZWFyRmlsdGVyIiwiQ0xFQVJfQUxMX0ZJTFRFUiIsIkZJTFRFUl9DRUxMIiwiZmlsdGVycyIsImxlbmd0aCIsIm9wdGlvbiIsImRhdGEiLCJYRVV0aWxzIiwiZ2V0IiwiY2hlY2tlZCIsInVwZGF0ZURhdGEiLCJFWFBPUlRfUk9XIiwib3B0cyIsImV4cG9ydERhdGEiLCJhc3NpZ24iLCJFWFBPUlRfU0VMRUNURURfUk9XIiwiRVhQT1JUX0FMTCIsIlBSSU5UX0FMTCIsInByaW50IiwiUFJJTlRfU0VMRUNURURfUk9XIiwiSElEREVOX0NPTFVNTiIsImhpZGVDb2x1bW4iLCJSRVNFVF9DT0xVTU4iLCJyZXNldENvbHVtbiIsInZpc2libGUiLCJyZXNpemFibGUiLCJSRVNFVF9SRVNJWkFCTEUiLCJSRVNFVF9BTEwiLCJjaGVja1ByaXZpbGVnZSIsIml0ZW0iLCJjb2RlIiwiY29sdW1ucyIsImRpc2FibGVkIiwic29tZSIsInNvcnRhYmxlIiwib3JkZXIiLCJoYW5kbGVQcml2aWxlZ2VFdmVudCIsIm9wdGlvbnMiLCJmb3JFYWNoIiwibGlzdCIsImNoaWxkcmVuIiwiY2hpbGQiLCJWWEVUYWJsZVBsdWdpbk1lbnVzIiwiaW5zdGFsbCIsImludGVyY2VwdG9yIiwibWVudXMiLCJhZGQiLCJtaXhpbiIsIndpbmRvdyIsIlZYRVRhYmxlIiwidXNlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQ0E7Ozs7QUFEQTs7QUFTQTtBQUVBLElBQU1BLE9BQU8sR0FBRztBQUNkQyxFQUFBQSxVQURjLHNCQUNGQyxNQURFLEVBQ29CO0FBQUEsUUFDeEJDLE1BRHdCLEdBQ0FELE1BREEsQ0FDeEJDLE1BRHdCO0FBQUEsUUFDaEJDLEdBRGdCLEdBQ0FGLE1BREEsQ0FDaEJFLEdBRGdCO0FBQUEsUUFDWEMsTUFEVyxHQUNBSCxNQURBLENBQ1hHLE1BRFc7O0FBRWhDLFFBQUlELEdBQUcsSUFBSUMsTUFBWCxFQUFtQjtBQUNqQkYsTUFBQUEsTUFBTSxDQUFDRyxTQUFQLENBQWlCRixHQUFqQixFQUFzQkMsTUFBTSxDQUFDRSxRQUE3QjtBQUNEO0FBQ0YsR0FOYTtBQU9kQyxFQUFBQSxTQVBjLHFCQU9ITixNQVBHLEVBT21CO0FBQUEsUUFDdkJDLE1BRHVCLEdBQ1BELE1BRE8sQ0FDdkJDLE1BRHVCO0FBQUEsUUFDZkMsR0FEZSxHQUNQRixNQURPLENBQ2ZFLEdBRGU7O0FBRS9CLFFBQUlBLEdBQUosRUFBUztBQUNQRCxNQUFBQSxNQUFNLENBQUNHLFNBQVAsQ0FBaUJGLEdBQWpCO0FBQ0Q7QUFDRixHQVphO0FBYWRLLEVBQUFBLGtCQWJjLDhCQWFNUCxNQWJOLEVBYTRCO0FBQUEsUUFDaENDLE1BRGdDLEdBQ3JCRCxNQURxQixDQUNoQ0MsTUFEZ0M7QUFFeENBLElBQUFBLE1BQU0sQ0FBQ0csU0FBUCxDQUFpQkgsTUFBTSxDQUFDTyxrQkFBUCxFQUFqQjtBQUNELEdBaEJhO0FBaUJkQyxFQUFBQSxTQWpCYyxxQkFpQkhULE1BakJHLEVBaUJtQjtBQUFBLFFBQ3ZCQyxNQUR1QixHQUNaRCxNQURZLENBQ3ZCQyxNQUR1QjtBQUUvQkEsSUFBQUEsTUFBTSxDQUFDRyxTQUFQO0FBQ0QsR0FwQmE7QUFxQmRNLEVBQUFBLFdBckJjLHVCQXFCRFYsTUFyQkMsRUFxQnFCO0FBQUEsUUFDekJDLE1BRHlCLEdBQ0RELE1BREMsQ0FDekJDLE1BRHlCO0FBQUEsUUFDakJDLEdBRGlCLEdBQ0RGLE1BREMsQ0FDakJFLEdBRGlCO0FBQUEsUUFDWkMsTUFEWSxHQUNESCxNQURDLENBQ1pHLE1BRFk7O0FBRWpDLFFBQUlELEdBQUcsSUFBSUMsTUFBWCxFQUFtQjtBQUNqQkYsTUFBQUEsTUFBTSxDQUFDVSxVQUFQLENBQWtCVCxHQUFsQixFQUF1QkMsTUFBTSxDQUFDRSxRQUE5QjtBQUNEO0FBQ0YsR0ExQmE7QUEyQmRPLEVBQUFBLFVBM0JjLHNCQTJCRlosTUEzQkUsRUEyQm9CO0FBQUEsUUFDeEJDLE1BRHdCLEdBQ1JELE1BRFEsQ0FDeEJDLE1BRHdCO0FBQUEsUUFDaEJDLEdBRGdCLEdBQ1JGLE1BRFEsQ0FDaEJFLEdBRGdCOztBQUVoQyxRQUFJQSxHQUFKLEVBQVM7QUFDUEQsTUFBQUEsTUFBTSxDQUFDVSxVQUFQLENBQWtCVCxHQUFsQjtBQUNEO0FBQ0YsR0FoQ2E7QUFpQ2RXLEVBQUFBLG1CQWpDYywrQkFpQ09iLE1BakNQLEVBaUM2QjtBQUFBLFFBQ2pDQyxNQURpQyxHQUN0QkQsTUFEc0IsQ0FDakNDLE1BRGlDO0FBRXpDQSxJQUFBQSxNQUFNLENBQUNVLFVBQVAsQ0FBa0JWLE1BQU0sQ0FBQ08sa0JBQVAsRUFBbEI7QUFDRCxHQXBDYTtBQXFDZE0sRUFBQUEsVUFyQ2Msc0JBcUNGZCxNQXJDRSxFQXFDb0I7QUFBQSxRQUN4QkMsTUFEd0IsR0FDYkQsTUFEYSxDQUN4QkMsTUFEd0I7QUFFaENBLElBQUFBLE1BQU0sQ0FBQ1UsVUFBUDtBQUNELEdBeENhO0FBeUNkSSxFQUFBQSxVQXpDYyxzQkF5Q0ZmLE1BekNFLEVBeUNvQjtBQUFBLFFBQ3hCQyxNQUR3QixHQUNQRCxNQURPLENBQ3hCQyxNQUR3QjtBQUFBLFFBQ2hCZSxJQURnQixHQUNQaEIsTUFETyxDQUNoQmdCLElBRGdCO0FBRWhDZixJQUFBQSxNQUFNLENBQUNnQixNQUFQLENBQWNELElBQUksQ0FBQ2hCLE1BQW5CO0FBQ0QsR0E1Q2E7QUE2Q2RrQixFQUFBQSxrQkE3Q2MsOEJBNkNNbEIsTUE3Q04sRUE2QzRCO0FBQUEsUUFDaENDLE1BRGdDLEdBQ1BELE1BRE8sQ0FDaENDLE1BRGdDO0FBQUEsUUFDeEJlLElBRHdCLEdBQ1BoQixNQURPLENBQ3hCZ0IsSUFEd0I7QUFBQSxRQUNsQmIsTUFEa0IsR0FDUEgsTUFETyxDQUNsQkcsTUFEa0I7QUFFeEMsUUFBTWdCLElBQUksR0FBR0gsSUFBSSxDQUFDaEIsTUFBTCxJQUFlLEVBQTVCO0FBQ0FDLElBQUFBLE1BQU0sQ0FBQ2dCLE1BQVAsQ0FBY0UsSUFBSSxDQUFDLENBQUQsQ0FBbEIsRUFDR0MsSUFESCxDQUNRO0FBQUEsVUFBR2xCLEdBQUgsUUFBR0EsR0FBSDtBQUFBLGFBQWFELE1BQU0sQ0FBQ29CLGFBQVAsQ0FBcUJuQixHQUFyQixFQUEwQmlCLElBQUksQ0FBQyxDQUFELENBQUosSUFBV2hCLE1BQU0sQ0FBQ0UsUUFBNUMsQ0FBYjtBQUFBLEtBRFI7QUFFRCxHQWxEYTtBQW1EZGlCLEVBQUFBLGFBbkRjLHlCQW1EQ3RCLE1BbkRELEVBbUR1QjtBQUFBLFFBQzNCQyxNQUQyQixHQUNMRCxNQURLLENBQzNCQyxNQUQyQjtBQUFBLFFBQ25CZSxJQURtQixHQUNMaEIsTUFESyxDQUNuQmdCLElBRG1CO0FBQUEsUUFDYmQsR0FEYSxHQUNMRixNQURLLENBQ2JFLEdBRGE7O0FBRW5DLFFBQUlBLEdBQUosRUFBUztBQUNQRCxNQUFBQSxNQUFNLENBQUNzQixRQUFQLENBQWdCUCxJQUFJLENBQUNoQixNQUFyQixFQUE2QkUsR0FBN0I7QUFDRDtBQUNGLEdBeERhO0FBeURkc0IsRUFBQUEscUJBekRjLGlDQXlEU3hCLE1BekRULEVBeUQrQjtBQUFBLFFBQ25DQyxNQURtQyxHQUNMRCxNQURLLENBQ25DQyxNQURtQztBQUFBLFFBQzNCZSxJQUQyQixHQUNMaEIsTUFESyxDQUMzQmdCLElBRDJCO0FBQUEsUUFDckJkLEdBRHFCLEdBQ0xGLE1BREssQ0FDckJFLEdBRHFCO0FBQUEsUUFDaEJDLE1BRGdCLEdBQ0xILE1BREssQ0FDaEJHLE1BRGdCOztBQUUzQyxRQUFJRCxHQUFKLEVBQVM7QUFDUCxVQUFNaUIsSUFBSSxHQUFHSCxJQUFJLENBQUNoQixNQUFMLElBQWUsRUFBNUI7QUFDQUMsTUFBQUEsTUFBTSxDQUFDc0IsUUFBUCxDQUFnQkosSUFBSSxDQUFDLENBQUQsQ0FBcEIsRUFBeUJqQixHQUF6QixFQUNHa0IsSUFESCxDQUNRO0FBQUEsWUFBR2xCLEdBQUgsU0FBR0EsR0FBSDtBQUFBLGVBQWFELE1BQU0sQ0FBQ29CLGFBQVAsQ0FBcUJuQixHQUFyQixFQUEwQmlCLElBQUksQ0FBQyxDQUFELENBQUosSUFBV2hCLE1BQU0sQ0FBQ0UsUUFBNUMsQ0FBYjtBQUFBLE9BRFI7QUFFRDtBQUNGLEdBaEVhO0FBaUVkb0IsRUFBQUEsVUFqRWMsc0JBaUVGekIsTUFqRUUsRUFpRW9CO0FBQUEsUUFDeEJDLE1BRHdCLEdBQ1JELE1BRFEsQ0FDeEJDLE1BRHdCO0FBQUEsUUFDaEJDLEdBRGdCLEdBQ1JGLE1BRFEsQ0FDaEJFLEdBRGdCOztBQUVoQyxRQUFJQSxHQUFKLEVBQVM7QUFDUEQsTUFBQUEsTUFBTSxDQUFDeUIsTUFBUCxDQUFjeEIsR0FBZDtBQUNEO0FBQ0YsR0F0RWE7QUF1RWR5QixFQUFBQSxtQkF2RWMsK0JBdUVPM0IsTUF2RVAsRUF1RTZCO0FBQUEsUUFDakNDLE1BRGlDLEdBQ3RCRCxNQURzQixDQUNqQ0MsTUFEaUM7QUFFekNBLElBQUFBLE1BQU0sQ0FBQzJCLGlCQUFQO0FBQ0QsR0ExRWE7QUEyRWRDLEVBQUFBLFVBM0VjLHNCQTJFRjdCLE1BM0VFLEVBMkVvQjtBQUFBLFFBQ3hCQyxNQUR3QixHQUNiRCxNQURhLENBQ3hCQyxNQUR3QjtBQUVoQ0EsSUFBQUEsTUFBTSxDQUFDeUIsTUFBUDtBQUNELEdBOUVhO0FBK0VkSSxFQUFBQSxVQS9FYyxzQkErRUY5QixNQS9FRSxFQStFb0I7QUFBQSxRQUN4QkMsTUFEd0IsR0FDYkQsTUFEYSxDQUN4QkMsTUFEd0I7QUFFaENBLElBQUFBLE1BQU0sQ0FBQzhCLFNBQVA7QUFDRCxHQWxGYTtBQW1GZEMsRUFBQUEsUUFuRmMsb0JBbUZKaEMsTUFuRkksRUFtRmtCO0FBQUEsUUFDdEJDLE1BRHNCLEdBQ0hELE1BREcsQ0FDdEJDLE1BRHNCO0FBQUEsUUFDZEUsTUFEYyxHQUNISCxNQURHLENBQ2RHLE1BRGM7O0FBRTlCLFFBQUlBLE1BQUosRUFBWTtBQUNWRixNQUFBQSxNQUFNLENBQUNnQyxJQUFQLENBQVk5QixNQUFNLENBQUNFLFFBQW5CLEVBQTZCLEtBQTdCO0FBQ0Q7QUFDRixHQXhGYTtBQXlGZDZCLEVBQUFBLFNBekZjLHFCQXlGSGxDLE1BekZHLEVBeUZtQjtBQUFBLFFBQ3ZCQyxNQUR1QixHQUNKRCxNQURJLENBQ3ZCQyxNQUR1QjtBQUFBLFFBQ2ZFLE1BRGUsR0FDSkgsTUFESSxDQUNmRyxNQURlOztBQUUvQixRQUFJQSxNQUFKLEVBQVk7QUFDVkYsTUFBQUEsTUFBTSxDQUFDZ0MsSUFBUCxDQUFZOUIsTUFBTSxDQUFDRSxRQUFuQixFQUE2QixNQUE3QjtBQUNEO0FBQ0YsR0E5RmE7QUErRmQ4QixFQUFBQSxZQS9GYyx3QkErRkFuQyxNQS9GQSxFQStGc0I7QUFBQSxRQUMxQkMsTUFEMEIsR0FDUEQsTUFETyxDQUMxQkMsTUFEMEI7QUFBQSxRQUNsQkUsTUFEa0IsR0FDUEgsTUFETyxDQUNsQkcsTUFEa0I7O0FBRWxDLFFBQUlBLE1BQUosRUFBWTtBQUNWRixNQUFBQSxNQUFNLENBQUNtQyxXQUFQLENBQW1CakMsTUFBTSxDQUFDRSxRQUExQjtBQUNEO0FBQ0YsR0FwR2E7QUFxR2RnQyxFQUFBQSxnQkFyR2MsNEJBcUdJckMsTUFyR0osRUFxRzBCO0FBQUEsUUFDOUJDLE1BRDhCLEdBQ25CRCxNQURtQixDQUM5QkMsTUFEOEI7QUFFdENBLElBQUFBLE1BQU0sQ0FBQ21DLFdBQVA7QUFDRCxHQXhHYTtBQXlHZEUsRUFBQUEsV0F6R2MsdUJBeUdEdEMsTUF6R0MsRUF5R3FCO0FBQUEsUUFDekJDLE1BRHlCLEdBQ0RELE1BREMsQ0FDekJDLE1BRHlCO0FBQUEsUUFDakJDLEdBRGlCLEdBQ0RGLE1BREMsQ0FDakJFLEdBRGlCO0FBQUEsUUFDWkMsTUFEWSxHQUNESCxNQURDLENBQ1pHLE1BRFk7O0FBRWpDLFFBQUlELEdBQUcsSUFBSUMsTUFBWCxFQUFtQjtBQUFBLFVBQ1hFLFFBRFcsR0FDV0YsTUFEWCxDQUNYRSxRQURXO0FBQUEsVUFDRGtDLE9BREMsR0FDV3BDLE1BRFgsQ0FDRG9DLE9BREM7O0FBRWpCLFVBQUlBLE9BQU8sQ0FBQ0MsTUFBWixFQUFvQjtBQUNsQixZQUFJQyxNQUFNLEdBQUdGLE9BQU8sQ0FBQyxDQUFELENBQXBCO0FBQ0FFLFFBQUFBLE1BQU0sQ0FBQ0MsSUFBUCxHQUFjQyxvQkFBUUMsR0FBUixDQUFZMUMsR0FBWixFQUFpQkcsUUFBakIsQ0FBZDtBQUNBb0MsUUFBQUEsTUFBTSxDQUFDSSxPQUFQLEdBQWlCLElBQWpCO0FBQ0E1QyxRQUFBQSxNQUFNLENBQUM2QyxVQUFQO0FBQ0Q7QUFDRjtBQUNGLEdBcEhhO0FBcUhkQyxFQUFBQSxVQXJIYyxzQkFxSEYvQyxNQXJIRSxFQXFIb0I7QUFBQSxRQUN4QkMsTUFEd0IsR0FDRkQsTUFERSxDQUN4QkMsTUFEd0I7QUFBQSxRQUNoQmUsSUFEZ0IsR0FDRmhCLE1BREUsQ0FDaEJnQixJQURnQjtBQUFBLFFBQ1ZkLEdBRFUsR0FDRkYsTUFERSxDQUNWRSxHQURVOztBQUVoQyxRQUFJQSxHQUFKLEVBQVM7QUFDUCxVQUFJOEMsSUFBSSxHQUFHO0FBQUVOLFFBQUFBLElBQUksRUFBRSxDQUFDeEMsR0FBRDtBQUFSLE9BQVg7QUFDQUQsTUFBQUEsTUFBTSxDQUFDZ0QsVUFBUCxDQUFrQk4sb0JBQVFPLE1BQVIsQ0FBZUYsSUFBZixFQUFxQmhDLElBQUksQ0FBQ2hCLE1BQUwsQ0FBWSxDQUFaLENBQXJCLENBQWxCO0FBQ0Q7QUFDRixHQTNIYTtBQTRIZG1ELEVBQUFBLG1CQTVIYywrQkE0SE9uRCxNQTVIUCxFQTRINkI7QUFBQSxRQUNqQ0MsTUFEaUMsR0FDaEJELE1BRGdCLENBQ2pDQyxNQURpQztBQUFBLFFBQ3pCZSxJQUR5QixHQUNoQmhCLE1BRGdCLENBQ3pCZ0IsSUFEeUI7QUFFekMsUUFBSWdDLElBQUksR0FBRztBQUFFTixNQUFBQSxJQUFJLEVBQUV6QyxNQUFNLENBQUNPLGtCQUFQO0FBQVIsS0FBWDtBQUNBUCxJQUFBQSxNQUFNLENBQUNnRCxVQUFQLENBQWtCTixvQkFBUU8sTUFBUixDQUFlRixJQUFmLEVBQXFCaEMsSUFBSSxDQUFDaEIsTUFBTCxDQUFZLENBQVosQ0FBckIsQ0FBbEI7QUFDRCxHQWhJYTtBQWlJZG9ELEVBQUFBLFVBakljLHNCQWlJRnBELE1BaklFLEVBaUlvQjtBQUFBLFFBQ3hCQyxNQUR3QixHQUNQRCxNQURPLENBQ3hCQyxNQUR3QjtBQUFBLFFBQ2hCZSxJQURnQixHQUNQaEIsTUFETyxDQUNoQmdCLElBRGdCO0FBRWhDZixJQUFBQSxNQUFNLENBQUNnRCxVQUFQLENBQWtCakMsSUFBSSxDQUFDaEIsTUFBdkI7QUFDRCxHQXBJYTtBQXFJZHFELEVBQUFBLFNBckljLHFCQXFJSHJELE1BcklHLEVBcUltQjtBQUFBLFFBQ3ZCQyxNQUR1QixHQUNORCxNQURNLENBQ3ZCQyxNQUR1QjtBQUFBLFFBQ2ZlLElBRGUsR0FDTmhCLE1BRE0sQ0FDZmdCLElBRGU7QUFFL0JmLElBQUFBLE1BQU0sQ0FBQ3FELEtBQVAsQ0FBYXRDLElBQUksQ0FBQ2hCLE1BQWxCO0FBQ0QsR0F4SWE7QUF5SWR1RCxFQUFBQSxrQkF6SWMsOEJBeUlNdkQsTUF6SU4sRUF5STRCO0FBQUEsUUFDaENDLE1BRGdDLEdBQ2ZELE1BRGUsQ0FDaENDLE1BRGdDO0FBQUEsUUFDeEJlLElBRHdCLEdBQ2ZoQixNQURlLENBQ3hCZ0IsSUFEd0I7QUFFeEMsUUFBSWdDLElBQUksR0FBRztBQUFFTixNQUFBQSxJQUFJLEVBQUV6QyxNQUFNLENBQUNPLGtCQUFQO0FBQVIsS0FBWDtBQUNBUCxJQUFBQSxNQUFNLENBQUNxRCxLQUFQLENBQWFYLG9CQUFRTyxNQUFSLENBQWVGLElBQWYsRUFBcUJoQyxJQUFJLENBQUNoQixNQUExQixDQUFiO0FBQ0QsR0E3SWE7QUE4SWR3RCxFQUFBQSxhQTlJYyx5QkE4SUN4RCxNQTlJRCxFQThJdUI7QUFBQSxRQUMzQkMsTUFEMkIsR0FDUkQsTUFEUSxDQUMzQkMsTUFEMkI7QUFBQSxRQUNuQkUsTUFEbUIsR0FDUkgsTUFEUSxDQUNuQkcsTUFEbUI7O0FBRW5DLFFBQUlBLE1BQUosRUFBWTtBQUNWRixNQUFBQSxNQUFNLENBQUN3RCxVQUFQLENBQWtCdEQsTUFBbEI7QUFDRDtBQUNGLEdBbkphO0FBb0pkdUQsRUFBQUEsWUFwSmMsd0JBb0pBMUQsTUFwSkEsRUFvSnNCO0FBQUEsUUFDMUJDLE1BRDBCLEdBQ2ZELE1BRGUsQ0FDMUJDLE1BRDBCO0FBRWxDQSxJQUFBQSxNQUFNLENBQUMwRCxXQUFQLENBQW1CO0FBQUVDLE1BQUFBLE9BQU8sRUFBRSxJQUFYO0FBQWlCQyxNQUFBQSxTQUFTLEVBQUU7QUFBNUIsS0FBbkI7QUFDRCxHQXZKYTtBQXdKZEMsRUFBQUEsZUF4SmMsMkJBd0pHOUQsTUF4SkgsRUF3SnlCO0FBQUEsUUFDN0JDLE1BRDZCLEdBQ2xCRCxNQURrQixDQUM3QkMsTUFENkI7QUFFckNBLElBQUFBLE1BQU0sQ0FBQzBELFdBQVAsQ0FBbUI7QUFBRUMsTUFBQUEsT0FBTyxFQUFFLEtBQVg7QUFBa0JDLE1BQUFBLFNBQVMsRUFBRTtBQUE3QixLQUFuQjtBQUNELEdBM0phO0FBNEpkRSxFQUFBQSxTQTVKYyxxQkE0SkgvRCxNQTVKRyxFQTRKbUI7QUFBQSxRQUN2QkMsTUFEdUIsR0FDWkQsTUFEWSxDQUN2QkMsTUFEdUI7QUFFL0JBLElBQUFBLE1BQU0sQ0FBQzBELFdBQVAsQ0FBbUIsSUFBbkI7QUFDRDtBQS9KYSxDQUFoQjs7QUFrS0EsU0FBU0ssY0FBVCxDQUF5QkMsSUFBekIsRUFBa0VqRSxNQUFsRSxFQUErRjtBQUFBLE1BQ3ZGa0UsSUFEdUYsR0FDOUVELElBRDhFLENBQ3ZGQyxJQUR1RjtBQUFBLE1BRXZGQyxPQUZ1RixHQUVuRW5FLE1BRm1FLENBRXZGbUUsT0FGdUY7QUFBQSxNQUU5RWhFLE1BRjhFLEdBRW5FSCxNQUZtRSxDQUU5RUcsTUFGOEU7O0FBRzdGLFVBQVErRCxJQUFSO0FBQ0UsU0FBSyxZQUFMO0FBQ0VELE1BQUFBLElBQUksQ0FBQ0csUUFBTCxHQUFnQixDQUFDRCxPQUFPLENBQUNFLElBQVIsQ0FBYSxVQUFDbEUsTUFBRDtBQUFBLGVBQVlBLE1BQU0sQ0FBQ21FLFFBQVAsSUFBbUJuRSxNQUFNLENBQUNvRSxLQUF0QztBQUFBLE9BQWIsQ0FBakI7QUFDQTs7QUFDRixTQUFLLGtCQUFMO0FBQ0VOLE1BQUFBLElBQUksQ0FBQ0csUUFBTCxHQUFnQixDQUFDRCxPQUFPLENBQUNFLElBQVIsQ0FBYSxVQUFDbEUsTUFBRDtBQUFBLGVBQVlBLE1BQU0sQ0FBQ29DLE9BQVAsSUFBa0JwQyxNQUFNLENBQUNvQyxPQUFQLENBQWU4QixJQUFmLENBQW9CLFVBQUM1QixNQUFEO0FBQUEsaUJBQVlBLE1BQU0sQ0FBQ0ksT0FBbkI7QUFBQSxTQUFwQixDQUE5QjtBQUFBLE9BQWIsQ0FBakI7QUFDQTs7QUFDRixTQUFLLFlBQUw7QUFDQSxTQUFLLFdBQUw7QUFDQSxTQUFLLGFBQUw7QUFDQSxTQUFLLFlBQUw7QUFDQSxTQUFLLGVBQUw7QUFDQSxTQUFLLHVCQUFMO0FBQ0EsU0FBSyxZQUFMO0FBQ0EsU0FBSyxVQUFMO0FBQ0EsU0FBSyxXQUFMO0FBQ0EsU0FBSyxjQUFMO0FBQ0EsU0FBSyxhQUFMO0FBQ0EsU0FBSyxZQUFMO0FBQ0EsU0FBSyxlQUFMO0FBQ0VvQixNQUFBQSxJQUFJLENBQUNHLFFBQUwsR0FBZ0IsQ0FBQ2pFLE1BQWpCOztBQUNBLFVBQUlBLE1BQUosRUFBWTtBQUNWLGdCQUFRK0QsSUFBUjtBQUNFLGVBQUssVUFBTDtBQUNBLGVBQUssV0FBTDtBQUNFRCxZQUFBQSxJQUFJLENBQUNHLFFBQUwsR0FBZ0IsQ0FBQ2pFLE1BQU0sQ0FBQ21FLFFBQXhCO0FBQ0E7O0FBQ0YsZUFBSyxhQUFMO0FBQ0EsZUFBSyxjQUFMO0FBQ0VMLFlBQUFBLElBQUksQ0FBQ0csUUFBTCxHQUFnQixDQUFDakUsTUFBTSxDQUFDb0MsT0FBUixJQUFtQixDQUFDcEMsTUFBTSxDQUFDb0MsT0FBUCxDQUFlQyxNQUFuRDs7QUFDQSxnQkFBSSxDQUFDeUIsSUFBSSxDQUFDRyxRQUFWLEVBQW9CO0FBQ2xCLHNCQUFRRixJQUFSO0FBQ0UscUJBQUssY0FBTDtBQUNFRCxrQkFBQUEsSUFBSSxDQUFDRyxRQUFMLEdBQWdCLENBQUNqRSxNQUFNLENBQUNvQyxPQUFQLENBQWU4QixJQUFmLENBQW9CLFVBQUM1QixNQUFEO0FBQUEsMkJBQVlBLE1BQU0sQ0FBQ0ksT0FBbkI7QUFBQSxtQkFBcEIsQ0FBakI7QUFDQTtBQUhKO0FBS0Q7O0FBQ0Q7QUFmSjtBQWlCRDs7QUFDRDtBQXhDSjtBQTBDRDs7QUFFRCxTQUFTMkIsb0JBQVQsQ0FBK0J4RSxNQUEvQixFQUE0RDtBQUMxREEsRUFBQUEsTUFBTSxDQUFDeUUsT0FBUCxDQUFlQyxPQUFmLENBQXVCLFVBQUNDLElBQUQsRUFBUztBQUM5QkEsSUFBQUEsSUFBSSxDQUFDRCxPQUFMLENBQWEsVUFBQ1QsSUFBRCxFQUFTO0FBQ3BCRCxNQUFBQSxjQUFjLENBQUNDLElBQUQsRUFBT2pFLE1BQVAsQ0FBZDs7QUFDQSxVQUFJaUUsSUFBSSxDQUFDVyxRQUFULEVBQW1CO0FBQ2pCWCxRQUFBQSxJQUFJLENBQUNXLFFBQUwsQ0FBY0YsT0FBZCxDQUFzQixVQUFDRyxLQUFELEVBQVU7QUFDOUJiLFVBQUFBLGNBQWMsQ0FBQ2EsS0FBRCxFQUFRN0UsTUFBUixDQUFkO0FBQ0QsU0FGRDtBQUdEO0FBQ0YsS0FQRDtBQVFELEdBVEQ7QUFVRDtBQUVEOzs7OztBQUdPLElBQU04RSxtQkFBbUIsR0FBRztBQUNqQ0MsRUFBQUEsT0FEaUMsMEJBQ2U7QUFBQSxRQUFyQ0MsV0FBcUMsU0FBckNBLFdBQXFDO0FBQUEsUUFBeEJDLEtBQXdCLFNBQXhCQSxLQUF3QjtBQUM5Q0QsSUFBQUEsV0FBVyxDQUFDRSxHQUFaLENBQWdCLGdCQUFoQixFQUFrQ1Ysb0JBQWxDO0FBQ0FTLElBQUFBLEtBQUssQ0FBQ0UsS0FBTixDQUFZckYsT0FBWjtBQUNEO0FBSmdDLENBQTVCOzs7QUFPUCxJQUFJLE9BQU9zRixNQUFQLEtBQWtCLFdBQWxCLElBQWlDQSxNQUFNLENBQUNDLFFBQTVDLEVBQXNEO0FBQ3BERCxFQUFBQSxNQUFNLENBQUNDLFFBQVAsQ0FBZ0JDLEdBQWhCLENBQW9CUixtQkFBcEI7QUFDRDs7ZUFFY0EsbUIiLCJmaWxlIjoiaW5kZXguY29tbW9uLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyogZXNsaW50LWRpc2FibGUgbm8tdW51c2VkLXZhcnMgKi9cclxuaW1wb3J0IFhFVXRpbHMgZnJvbSAneGUtdXRpbHMvbWV0aG9kcy94ZS11dGlscydcclxuaW1wb3J0IHtcclxuICBWWEVUYWJsZSxcclxuICBNZW51TGlua1BhcmFtcyxcclxuICBJbnRlcmNlcHRvck1lbnVQYXJhbXMsXHJcbiAgTWVudUZpcnN0T3B0aW9uLFxyXG4gIE1lbnVDaGlsZE9wdGlvblxyXG59IGZyb20gJ3Z4ZS10YWJsZS9saWIvdnhlLXRhYmxlJ1xyXG4vKiBlc2xpbnQtZW5hYmxlIG5vLXVudXNlZC12YXJzICovXHJcblxyXG5jb25zdCBtZW51TWFwID0ge1xyXG4gIENMRUFSX0NFTEwgKHBhcmFtczogTWVudUxpbmtQYXJhbXMpIHtcclxuICAgIGNvbnN0IHsgJHRhYmxlLCByb3csIGNvbHVtbiB9ID0gcGFyYW1zXHJcbiAgICBpZiAocm93ICYmIGNvbHVtbikge1xyXG4gICAgICAkdGFibGUuY2xlYXJEYXRhKHJvdywgY29sdW1uLnByb3BlcnR5KVxyXG4gICAgfVxyXG4gIH0sXHJcbiAgQ0xFQVJfUk9XIChwYXJhbXM6IE1lbnVMaW5rUGFyYW1zKSB7XHJcbiAgICBjb25zdCB7ICR0YWJsZSwgcm93IH0gPSBwYXJhbXNcclxuICAgIGlmIChyb3cpIHtcclxuICAgICAgJHRhYmxlLmNsZWFyRGF0YShyb3cpXHJcbiAgICB9XHJcbiAgfSxcclxuICBDTEVBUl9TRUxFQ1RFRF9ST1cgKHBhcmFtczogTWVudUxpbmtQYXJhbXMpIHtcclxuICAgIGNvbnN0IHsgJHRhYmxlIH0gPSBwYXJhbXNcclxuICAgICR0YWJsZS5jbGVhckRhdGEoJHRhYmxlLmdldENoZWNrYm94UmVjb3JkcygpKVxyXG4gIH0sXHJcbiAgQ0xFQVJfQUxMIChwYXJhbXM6IE1lbnVMaW5rUGFyYW1zKSB7XHJcbiAgICBjb25zdCB7ICR0YWJsZSB9ID0gcGFyYW1zXHJcbiAgICAkdGFibGUuY2xlYXJEYXRhKClcclxuICB9LFxyXG4gIFJFVkVSVF9DRUxMIChwYXJhbXM6IE1lbnVMaW5rUGFyYW1zKSB7XHJcbiAgICBjb25zdCB7ICR0YWJsZSwgcm93LCBjb2x1bW4gfSA9IHBhcmFtc1xyXG4gICAgaWYgKHJvdyAmJiBjb2x1bW4pIHtcclxuICAgICAgJHRhYmxlLnJldmVydERhdGEocm93LCBjb2x1bW4ucHJvcGVydHkpXHJcbiAgICB9XHJcbiAgfSxcclxuICBSRVZFUlRfUk9XIChwYXJhbXM6IE1lbnVMaW5rUGFyYW1zKSB7XHJcbiAgICBjb25zdCB7ICR0YWJsZSwgcm93IH0gPSBwYXJhbXNcclxuICAgIGlmIChyb3cpIHtcclxuICAgICAgJHRhYmxlLnJldmVydERhdGEocm93KVxyXG4gICAgfVxyXG4gIH0sXHJcbiAgUkVWRVJUX1NFTEVDVEVEX1JPVyAocGFyYW1zOiBNZW51TGlua1BhcmFtcykge1xyXG4gICAgY29uc3QgeyAkdGFibGUgfSA9IHBhcmFtc1xyXG4gICAgJHRhYmxlLnJldmVydERhdGEoJHRhYmxlLmdldENoZWNrYm94UmVjb3JkcygpKVxyXG4gIH0sXHJcbiAgUkVWRVJUX0FMTCAocGFyYW1zOiBNZW51TGlua1BhcmFtcykge1xyXG4gICAgY29uc3QgeyAkdGFibGUgfSA9IHBhcmFtc1xyXG4gICAgJHRhYmxlLnJldmVydERhdGEoKVxyXG4gIH0sXHJcbiAgSU5TRVJUX1JPVyAocGFyYW1zOiBNZW51TGlua1BhcmFtcykge1xyXG4gICAgY29uc3QgeyAkdGFibGUsIG1lbnUgfSA9IHBhcmFtc1xyXG4gICAgJHRhYmxlLmluc2VydChtZW51LnBhcmFtcylcclxuICB9LFxyXG4gIElOU0VSVF9BQ1RJVkVEX1JPVyAocGFyYW1zOiBNZW51TGlua1BhcmFtcykge1xyXG4gICAgY29uc3QgeyAkdGFibGUsIG1lbnUsIGNvbHVtbiB9ID0gcGFyYW1zXHJcbiAgICBjb25zdCBhcmdzID0gbWVudS5wYXJhbXMgfHwgW11cclxuICAgICR0YWJsZS5pbnNlcnQoYXJnc1swXSlcclxuICAgICAgLnRoZW4oKHsgcm93IH0pID0+ICR0YWJsZS5zZXRBY3RpdmVDZWxsKHJvdywgYXJnc1sxXSB8fCBjb2x1bW4ucHJvcGVydHkpKVxyXG4gIH0sXHJcbiAgSU5TRVJUX0FUX1JPVyAocGFyYW1zOiBNZW51TGlua1BhcmFtcykge1xyXG4gICAgY29uc3QgeyAkdGFibGUsIG1lbnUsIHJvdyB9ID0gcGFyYW1zXHJcbiAgICBpZiAocm93KSB7XHJcbiAgICAgICR0YWJsZS5pbnNlcnRBdChtZW51LnBhcmFtcywgcm93KVxyXG4gICAgfVxyXG4gIH0sXHJcbiAgSU5TRVJUX0FUX0FDVElWRURfUk9XIChwYXJhbXM6IE1lbnVMaW5rUGFyYW1zKSB7XHJcbiAgICBjb25zdCB7ICR0YWJsZSwgbWVudSwgcm93LCBjb2x1bW4gfSA9IHBhcmFtc1xyXG4gICAgaWYgKHJvdykge1xyXG4gICAgICBjb25zdCBhcmdzID0gbWVudS5wYXJhbXMgfHwgW11cclxuICAgICAgJHRhYmxlLmluc2VydEF0KGFyZ3NbMF0sIHJvdylcclxuICAgICAgICAudGhlbigoeyByb3cgfSkgPT4gJHRhYmxlLnNldEFjdGl2ZUNlbGwocm93LCBhcmdzWzFdIHx8IGNvbHVtbi5wcm9wZXJ0eSkpXHJcbiAgICB9XHJcbiAgfSxcclxuICBERUxFVEVfUk9XIChwYXJhbXM6IE1lbnVMaW5rUGFyYW1zKSB7XHJcbiAgICBjb25zdCB7ICR0YWJsZSwgcm93IH0gPSBwYXJhbXNcclxuICAgIGlmIChyb3cpIHtcclxuICAgICAgJHRhYmxlLnJlbW92ZShyb3cpXHJcbiAgICB9XHJcbiAgfSxcclxuICBERUxFVEVfU0VMRUNURURfUk9XIChwYXJhbXM6IE1lbnVMaW5rUGFyYW1zKSB7XHJcbiAgICBjb25zdCB7ICR0YWJsZSB9ID0gcGFyYW1zXHJcbiAgICAkdGFibGUucmVtb3ZlQ2hlY2tib3hSb3coKVxyXG4gIH0sXHJcbiAgREVMRVRFX0FMTCAocGFyYW1zOiBNZW51TGlua1BhcmFtcykge1xyXG4gICAgY29uc3QgeyAkdGFibGUgfSA9IHBhcmFtc1xyXG4gICAgJHRhYmxlLnJlbW92ZSgpXHJcbiAgfSxcclxuICBDTEVBUl9TT1JUIChwYXJhbXM6IE1lbnVMaW5rUGFyYW1zKSB7XHJcbiAgICBjb25zdCB7ICR0YWJsZSB9ID0gcGFyYW1zXHJcbiAgICAkdGFibGUuY2xlYXJTb3J0KClcclxuICB9LFxyXG4gIFNPUlRfQVNDIChwYXJhbXM6IE1lbnVMaW5rUGFyYW1zKSB7XHJcbiAgICBjb25zdCB7ICR0YWJsZSwgY29sdW1uIH0gPSBwYXJhbXNcclxuICAgIGlmIChjb2x1bW4pIHtcclxuICAgICAgJHRhYmxlLnNvcnQoY29sdW1uLnByb3BlcnR5LCAnYXNjJylcclxuICAgIH1cclxuICB9LFxyXG4gIFNPUlRfREVTQyAocGFyYW1zOiBNZW51TGlua1BhcmFtcykge1xyXG4gICAgY29uc3QgeyAkdGFibGUsIGNvbHVtbiB9ID0gcGFyYW1zXHJcbiAgICBpZiAoY29sdW1uKSB7XHJcbiAgICAgICR0YWJsZS5zb3J0KGNvbHVtbi5wcm9wZXJ0eSwgJ2Rlc2MnKVxyXG4gICAgfVxyXG4gIH0sXHJcbiAgQ0xFQVJfRklMVEVSIChwYXJhbXM6IE1lbnVMaW5rUGFyYW1zKSB7XHJcbiAgICBjb25zdCB7ICR0YWJsZSwgY29sdW1uIH0gPSBwYXJhbXNcclxuICAgIGlmIChjb2x1bW4pIHtcclxuICAgICAgJHRhYmxlLmNsZWFyRmlsdGVyKGNvbHVtbi5wcm9wZXJ0eSlcclxuICAgIH1cclxuICB9LFxyXG4gIENMRUFSX0FMTF9GSUxURVIgKHBhcmFtczogTWVudUxpbmtQYXJhbXMpIHtcclxuICAgIGNvbnN0IHsgJHRhYmxlIH0gPSBwYXJhbXNcclxuICAgICR0YWJsZS5jbGVhckZpbHRlcigpXHJcbiAgfSxcclxuICBGSUxURVJfQ0VMTCAocGFyYW1zOiBNZW51TGlua1BhcmFtcykge1xyXG4gICAgY29uc3QgeyAkdGFibGUsIHJvdywgY29sdW1uIH0gPSBwYXJhbXNcclxuICAgIGlmIChyb3cgJiYgY29sdW1uKSB7XHJcbiAgICAgIGxldCB7IHByb3BlcnR5LCBmaWx0ZXJzIH0gPSBjb2x1bW5cclxuICAgICAgaWYgKGZpbHRlcnMubGVuZ3RoKSB7XHJcbiAgICAgICAgbGV0IG9wdGlvbiA9IGZpbHRlcnNbMF1cclxuICAgICAgICBvcHRpb24uZGF0YSA9IFhFVXRpbHMuZ2V0KHJvdywgcHJvcGVydHkpXHJcbiAgICAgICAgb3B0aW9uLmNoZWNrZWQgPSB0cnVlXHJcbiAgICAgICAgJHRhYmxlLnVwZGF0ZURhdGEoKVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfSxcclxuICBFWFBPUlRfUk9XIChwYXJhbXM6IE1lbnVMaW5rUGFyYW1zKSB7XHJcbiAgICBjb25zdCB7ICR0YWJsZSwgbWVudSwgcm93IH0gPSBwYXJhbXNcclxuICAgIGlmIChyb3cpIHtcclxuICAgICAgbGV0IG9wdHMgPSB7IGRhdGE6IFtyb3ddIH1cclxuICAgICAgJHRhYmxlLmV4cG9ydERhdGEoWEVVdGlscy5hc3NpZ24ob3B0cywgbWVudS5wYXJhbXNbMF0pKVxyXG4gICAgfVxyXG4gIH0sXHJcbiAgRVhQT1JUX1NFTEVDVEVEX1JPVyAocGFyYW1zOiBNZW51TGlua1BhcmFtcykge1xyXG4gICAgY29uc3QgeyAkdGFibGUsIG1lbnUgfSA9IHBhcmFtc1xyXG4gICAgbGV0IG9wdHMgPSB7IGRhdGE6ICR0YWJsZS5nZXRDaGVja2JveFJlY29yZHMoKSB9XHJcbiAgICAkdGFibGUuZXhwb3J0RGF0YShYRVV0aWxzLmFzc2lnbihvcHRzLCBtZW51LnBhcmFtc1swXSkpXHJcbiAgfSxcclxuICBFWFBPUlRfQUxMIChwYXJhbXM6IE1lbnVMaW5rUGFyYW1zKSB7XHJcbiAgICBjb25zdCB7ICR0YWJsZSwgbWVudSB9ID0gcGFyYW1zXHJcbiAgICAkdGFibGUuZXhwb3J0RGF0YShtZW51LnBhcmFtcylcclxuICB9LFxyXG4gIFBSSU5UX0FMTCAocGFyYW1zOiBNZW51TGlua1BhcmFtcykge1xyXG4gICAgY29uc3QgeyAkdGFibGUsIG1lbnUgfSA9IHBhcmFtc1xyXG4gICAgJHRhYmxlLnByaW50KG1lbnUucGFyYW1zKVxyXG4gIH0sXHJcbiAgUFJJTlRfU0VMRUNURURfUk9XIChwYXJhbXM6IE1lbnVMaW5rUGFyYW1zKSB7XHJcbiAgICBjb25zdCB7ICR0YWJsZSwgbWVudSB9ID0gcGFyYW1zXHJcbiAgICBsZXQgb3B0cyA9IHsgZGF0YTogJHRhYmxlLmdldENoZWNrYm94UmVjb3JkcygpIH1cclxuICAgICR0YWJsZS5wcmludChYRVV0aWxzLmFzc2lnbihvcHRzLCBtZW51LnBhcmFtcykpXHJcbiAgfSxcclxuICBISURERU5fQ09MVU1OIChwYXJhbXM6IE1lbnVMaW5rUGFyYW1zKSB7XHJcbiAgICBjb25zdCB7ICR0YWJsZSwgY29sdW1uIH0gPSBwYXJhbXNcclxuICAgIGlmIChjb2x1bW4pIHtcclxuICAgICAgJHRhYmxlLmhpZGVDb2x1bW4oY29sdW1uKVxyXG4gICAgfVxyXG4gIH0sXHJcbiAgUkVTRVRfQ09MVU1OIChwYXJhbXM6IE1lbnVMaW5rUGFyYW1zKSB7XHJcbiAgICBjb25zdCB7ICR0YWJsZSB9ID0gcGFyYW1zXHJcbiAgICAkdGFibGUucmVzZXRDb2x1bW4oeyB2aXNpYmxlOiB0cnVlLCByZXNpemFibGU6IGZhbHNlIH0pXHJcbiAgfSxcclxuICBSRVNFVF9SRVNJWkFCTEUgKHBhcmFtczogTWVudUxpbmtQYXJhbXMpIHtcclxuICAgIGNvbnN0IHsgJHRhYmxlIH0gPSBwYXJhbXNcclxuICAgICR0YWJsZS5yZXNldENvbHVtbih7IHZpc2libGU6IGZhbHNlLCByZXNpemFibGU6IHRydWUgfSlcclxuICB9LFxyXG4gIFJFU0VUX0FMTCAocGFyYW1zOiBNZW51TGlua1BhcmFtcykge1xyXG4gICAgY29uc3QgeyAkdGFibGUgfSA9IHBhcmFtc1xyXG4gICAgJHRhYmxlLnJlc2V0Q29sdW1uKHRydWUpXHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBjaGVja1ByaXZpbGVnZSAoaXRlbTogTWVudUZpcnN0T3B0aW9uIHwgTWVudUNoaWxkT3B0aW9uLCBwYXJhbXM6IEludGVyY2VwdG9yTWVudVBhcmFtcykge1xyXG4gIGxldCB7IGNvZGUgfSA9IGl0ZW1cclxuICBsZXQgeyBjb2x1bW5zLCBjb2x1bW4gfSA9IHBhcmFtc1xyXG4gIHN3aXRjaCAoY29kZSkge1xyXG4gICAgY2FzZSAnQ0xFQVJfU09SVCc6XHJcbiAgICAgIGl0ZW0uZGlzYWJsZWQgPSAhY29sdW1ucy5zb21lKChjb2x1bW4pID0+IGNvbHVtbi5zb3J0YWJsZSAmJiBjb2x1bW4ub3JkZXIpXHJcbiAgICAgIGJyZWFrXHJcbiAgICBjYXNlICdDTEVBUl9BTExfRklMVEVSJzpcclxuICAgICAgaXRlbS5kaXNhYmxlZCA9ICFjb2x1bW5zLnNvbWUoKGNvbHVtbikgPT4gY29sdW1uLmZpbHRlcnMgJiYgY29sdW1uLmZpbHRlcnMuc29tZSgob3B0aW9uKSA9PiBvcHRpb24uY2hlY2tlZCkpXHJcbiAgICAgIGJyZWFrXHJcbiAgICBjYXNlICdDTEVBUl9DRUxMJzpcclxuICAgIGNhc2UgJ0NMRUFSX1JPVyc6XHJcbiAgICBjYXNlICdSRVZFUlRfQ0VMTCc6XHJcbiAgICBjYXNlICdSRVZFUlRfUk9XJzpcclxuICAgIGNhc2UgJ0lOU0VSVF9BVF9ST1cnOlxyXG4gICAgY2FzZSAnSU5TRVJUX0FUX0FDVElWRURfUk9XJzpcclxuICAgIGNhc2UgJ0RFTEVURV9ST1cnOlxyXG4gICAgY2FzZSAnU09SVF9BU0MnOlxyXG4gICAgY2FzZSAnU09SVF9ERVNDJzpcclxuICAgIGNhc2UgJ0NMRUFSX0ZJTFRFUic6XHJcbiAgICBjYXNlICdGSUxURVJfQ0VMTCc6XHJcbiAgICBjYXNlICdFWFBPUlRfUk9XJzpcclxuICAgIGNhc2UgJ0hJRERFTl9DT0xVTU4nOlxyXG4gICAgICBpdGVtLmRpc2FibGVkID0gIWNvbHVtblxyXG4gICAgICBpZiAoY29sdW1uKSB7XHJcbiAgICAgICAgc3dpdGNoIChjb2RlKSB7XHJcbiAgICAgICAgICBjYXNlICdTT1JUX0FTQyc6XHJcbiAgICAgICAgICBjYXNlICdTT1JUX0RFU0MnOlxyXG4gICAgICAgICAgICBpdGVtLmRpc2FibGVkID0gIWNvbHVtbi5zb3J0YWJsZVxyXG4gICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgY2FzZSAnRklMVEVSX0NFTEwnOlxyXG4gICAgICAgICAgY2FzZSAnQ0xFQVJfRklMVEVSJzpcclxuICAgICAgICAgICAgaXRlbS5kaXNhYmxlZCA9ICFjb2x1bW4uZmlsdGVycyB8fCAhY29sdW1uLmZpbHRlcnMubGVuZ3RoXHJcbiAgICAgICAgICAgIGlmICghaXRlbS5kaXNhYmxlZCkge1xyXG4gICAgICAgICAgICAgIHN3aXRjaCAoY29kZSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnQ0xFQVJfRklMVEVSJzpcclxuICAgICAgICAgICAgICAgICAgaXRlbS5kaXNhYmxlZCA9ICFjb2x1bW4uZmlsdGVycy5zb21lKChvcHRpb24pID0+IG9wdGlvbi5jaGVja2VkKVxyXG4gICAgICAgICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBicmVha1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBicmVha1xyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlUHJpdmlsZWdlRXZlbnQgKHBhcmFtczogSW50ZXJjZXB0b3JNZW51UGFyYW1zKSB7XHJcbiAgcGFyYW1zLm9wdGlvbnMuZm9yRWFjaCgobGlzdCkgPT4ge1xyXG4gICAgbGlzdC5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICAgIGNoZWNrUHJpdmlsZWdlKGl0ZW0sIHBhcmFtcylcclxuICAgICAgaWYgKGl0ZW0uY2hpbGRyZW4pIHtcclxuICAgICAgICBpdGVtLmNoaWxkcmVuLmZvckVhY2goKGNoaWxkKSA9PiB7XHJcbiAgICAgICAgICBjaGVja1ByaXZpbGVnZShjaGlsZCwgcGFyYW1zKVxyXG4gICAgICAgIH0pXHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgfSlcclxufVxyXG5cclxuLyoqXHJcbiAqIOWfuuS6jiB2eGUtdGFibGUg6KGo5qC855qE5aKe5by65o+S5Lu277yM5o+Q5L6b5a6e55So55qE5b+r5o236I+c5Y2V6ZuGXHJcbiAqL1xyXG5leHBvcnQgY29uc3QgVlhFVGFibGVQbHVnaW5NZW51cyA9IHtcclxuICBpbnN0YWxsICh7IGludGVyY2VwdG9yLCBtZW51cyB9OiB0eXBlb2YgVlhFVGFibGUpIHtcclxuICAgIGludGVyY2VwdG9yLmFkZCgnZXZlbnQuc2hvd01lbnUnLCBoYW5kbGVQcml2aWxlZ2VFdmVudClcclxuICAgIG1lbnVzLm1peGluKG1lbnVNYXApXHJcbiAgfVxyXG59XHJcblxyXG5pZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiYgd2luZG93LlZYRVRhYmxlKSB7XHJcbiAgd2luZG93LlZYRVRhYmxlLnVzZShWWEVUYWJsZVBsdWdpbk1lbnVzKVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBWWEVUYWJsZVBsdWdpbk1lbnVzXHJcbiJdfQ==
