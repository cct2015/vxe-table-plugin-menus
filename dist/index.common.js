"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = exports.VXETablePluginMenus = void 0;

var _xeUtils = _interopRequireDefault(require("xe-utils/methods/xe-utils"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

var menuMap = {
  CLEAR_CELL: function CLEAR_CELL(_ref) {
    var $table = _ref.$table,
        row = _ref.row,
        column = _ref.column;

    if (row && column) {
      $table.clearData(row, column.property);
    }
  },
  CLEAR_ROW: function CLEAR_ROW(_ref2) {
    var $table = _ref2.$table,
        row = _ref2.row;

    if (row) {
      $table.clearData(row);
    }
  },
  CLEAR_SELECTION_ROW: function CLEAR_SELECTION_ROW(_ref3) {
    var $table = _ref3.$table;
    $table.clearData($table.getSelectRecords());
  },
  CLEAR_ALL: function CLEAR_ALL(_ref4) {
    var $table = _ref4.$table;
    $table.clearData();
  },
  REVERT_CELL: function REVERT_CELL(_ref5) {
    var $table = _ref5.$table,
        row = _ref5.row,
        column = _ref5.column;

    if (row && column) {
      $table.revertData(row, column.property);
    }
  },
  REVERT_ROW: function REVERT_ROW(_ref6) {
    var $table = _ref6.$table,
        row = _ref6.row;

    if (row) {
      $table.revertData(row);
    }
  },
  REVERT_SELECTION_ROW: function REVERT_SELECTION_ROW(_ref7) {
    var $table = _ref7.$table;
    $table.revertData($table.getSelectRecords());
  },
  REVERT_ALL: function REVERT_ALL(_ref8) {
    var $table = _ref8.$table;
    $table.revertData();
  },
  INSERT_ROW: function INSERT_ROW(_ref9) {
    var $table = _ref9.$table,
        menu = _ref9.menu;
    $table.insert(menu.params);
  },
  INSERT_ACTIVED_ROW: function INSERT_ACTIVED_ROW(_ref10) {
    var $table = _ref10.$table,
        menu = _ref10.menu,
        column = _ref10.column;
    var args = menu.params || [];
    $table.insert(args[0]).then(function (_ref11) {
      var row = _ref11.row;
      return $table.setActiveCell(row, args[1] || column.property);
    });
  },
  INSERT_AT_ROW: function INSERT_AT_ROW(_ref12) {
    var $table = _ref12.$table,
        menu = _ref12.menu,
        row = _ref12.row;

    if (row) {
      $table.insertAt(menu.params, row);
    }
  },
  INSERT_AT_ACTIVED_ROW: function INSERT_AT_ACTIVED_ROW(_ref13) {
    var $table = _ref13.$table,
        menu = _ref13.menu,
        row = _ref13.row,
        column = _ref13.column;

    if (row) {
      var args = menu.params || [];
      $table.insertAt(args[0], row).then(function (_ref14) {
        var row = _ref14.row;
        return $table.setActiveCell(row, args[1] || column.property);
      });
    }
  },
  DELETE_ROW: function DELETE_ROW(_ref15) {
    var $table = _ref15.$table,
        row = _ref15.row;

    if (row) {
      $table.remove(row);
    }
  },
  DELETE_SELECTION_ROW: function DELETE_SELECTION_ROW(_ref16) {
    var $table = _ref16.$table;
    $table.removeSelecteds();
  },
  DELETE_ALL: function DELETE_ALL(_ref17) {
    var $table = _ref17.$table;
    $table.remove();
  },
  CLEAR_SORT: function CLEAR_SORT(_ref18) {
    var $table = _ref18.$table;
    $table.clearSort();
  },
  SORT_ASC: function SORT_ASC(_ref19, evnt) {
    var $table = _ref19.$table,
        column = _ref19.column;

    if (column) {
      $table.triggerSortEvent(evnt, column, 'asc');
    }
  },
  SORT_DESC: function SORT_DESC(_ref20, evnt) {
    var $table = _ref20.$table,
        column = _ref20.column;

    if (column) {
      $table.triggerSortEvent(evnt, column, 'desc');
    }
  },
  CLEAR_FILTER: function CLEAR_FILTER(_ref21) {
    var $table = _ref21.$table,
        column = _ref21.column;

    if (column) {
      $table.clearFilter(column.property);
    }
  },
  CLEAR_ALL_FILTER: function CLEAR_ALL_FILTER(_ref22) {
    var $table = _ref22.$table;
    $table.clearFilter();
  },
  FILTER_CELL: function FILTER_CELL(_ref23) {
    var $table = _ref23.$table,
        row = _ref23.row,
        column = _ref23.column;

    if (row && column) {
      var property = column.property;
      $table.filter(property).then(function (options) {
        if (options.length) {
          var option = options[0];
          option.data = _xeUtils["default"].get(row, property);
          option.checked = true;
        }
      }).then(function () {
        return $table.updateData();
      });
    }
  },
  EXPORT_ROW: function EXPORT_ROW(_ref24) {
    var $table = _ref24.$table,
        menu = _ref24.menu,
        row = _ref24.row;

    if (row) {
      var opts = {
        data: [row]
      };
      $table.exportCsv(menu.params ? _xeUtils["default"].assign(opts, menu.params[0]) : opts);
    }
  },
  EXPORT_SELECTION_ROW: function EXPORT_SELECTION_ROW(_ref25) {
    var $table = _ref25.$table,
        menu = _ref25.menu;
    var opts = {
      data: $table.getSelectRecords()
    };
    $table.exportCsv(menu.params ? _xeUtils["default"].assign(opts, menu.params[0]) : opts);
  },
  EXPORT_ALL: function EXPORT_ALL(_ref26) {
    var $table = _ref26.$table;
    $table.exportCsv();
  },
  HIDDEN_COLUMN: function HIDDEN_COLUMN(_ref27) {
    var $table = _ref27.$table,
        column = _ref27.column;

    if (column) {
      $table.hideColumn();
    }
  },
  RESET_COLUMN: function RESET_COLUMN(_ref28) {
    var $table = _ref28.$table;
    $table.resetCustoms();
  },
  RESET_RESIZABLE: function RESET_RESIZABLE(_ref29) {
    var $table = _ref29.$table;
    $table.resetResizable();
  },
  RESET_ALL: function RESET_ALL(_ref30) {
    var $table = _ref30.$table;
    $table.resetAll();
  }
};

function checkPrivilege(item, params) {
  var code = item.code;
  var columns = params.columns,
      column = params.column;

  switch (code) {
    case 'CLEAR_SORT':
      item.disabled = !columns.some(function (column) {
        return column.sortable && column.order;
      });
      break;

    case 'CLEAR_ALL_FILTER':
      item.disabled = !columns.some(function (column) {
        return column.filters && column.filters.some(function (option) {
          return option.checked;
        });
      });
      break;

    case 'CLEAR_CELL':
    case 'CLEAR_ROW':
    case 'REVERT_CELL':
    case 'REVERT_ROW':
    case 'INSERT_AT_ROW':
    case 'INSERT_AT_ACTIVED_ROW':
    case 'DELETE_ROW':
    case 'SORT_ASC':
    case 'SORT_DESC':
    case 'CLEAR_FILTER':
    case 'FILTER_CELL':
    case 'EXPORT_ROW':
    case 'HIDDEN_COLUMN':
      item.disabled = !column;

      if (!item.disabled) {
        switch (code) {
          case 'SORT_ASC':
          case 'SORT_DESC':
            item.disabled = !column.sortable;
            break;

          case 'FILTER_CELL':
          case 'CLEAR_FILTER':
            item.disabled = !column.filters || !column.filters.length;

            if (!item.disabled) {
              switch (code) {
                case 'CLEAR_FILTER':
                  item.disabled = !column.filters.some(function (option) {
                    return option.checked;
                  });
                  break;
              }
            }

            break;
        }
      }

      break;
  }
}

function handlePrivilegeEvent(params) {
  params.options.forEach(function (list) {
    list.forEach(function (item) {
      checkPrivilege(item, params);

      if (item.children) {
        item.children.forEach(function (child) {
          checkPrivilege(child, params);
        });
      }
    });
  });
}
/**
 * 基于 vxe-table 表格的增强插件，提供实用的快捷菜单集
 */


var VXETablePluginMenus = {
  install: function install(xtable) {
    xtable.interceptor.add('event.show_menu', handlePrivilegeEvent);
    xtable.menus.mixin(menuMap);
  }
};
exports.VXETablePluginMenus = VXETablePluginMenus;

if (typeof window !== 'undefined' && window.VXETable) {
  window.VXETable.use(VXETablePluginMenus);
}

var _default = VXETablePluginMenus;
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LnRzIl0sIm5hbWVzIjpbIm1lbnVNYXAiLCJDTEVBUl9DRUxMIiwiJHRhYmxlIiwicm93IiwiY29sdW1uIiwiY2xlYXJEYXRhIiwicHJvcGVydHkiLCJDTEVBUl9ST1ciLCJDTEVBUl9TRUxFQ1RJT05fUk9XIiwiZ2V0U2VsZWN0UmVjb3JkcyIsIkNMRUFSX0FMTCIsIlJFVkVSVF9DRUxMIiwicmV2ZXJ0RGF0YSIsIlJFVkVSVF9ST1ciLCJSRVZFUlRfU0VMRUNUSU9OX1JPVyIsIlJFVkVSVF9BTEwiLCJJTlNFUlRfUk9XIiwibWVudSIsImluc2VydCIsInBhcmFtcyIsIklOU0VSVF9BQ1RJVkVEX1JPVyIsImFyZ3MiLCJ0aGVuIiwic2V0QWN0aXZlQ2VsbCIsIklOU0VSVF9BVF9ST1ciLCJpbnNlcnRBdCIsIklOU0VSVF9BVF9BQ1RJVkVEX1JPVyIsIkRFTEVURV9ST1ciLCJyZW1vdmUiLCJERUxFVEVfU0VMRUNUSU9OX1JPVyIsInJlbW92ZVNlbGVjdGVkcyIsIkRFTEVURV9BTEwiLCJDTEVBUl9TT1JUIiwiY2xlYXJTb3J0IiwiU09SVF9BU0MiLCJldm50IiwidHJpZ2dlclNvcnRFdmVudCIsIlNPUlRfREVTQyIsIkNMRUFSX0ZJTFRFUiIsImNsZWFyRmlsdGVyIiwiQ0xFQVJfQUxMX0ZJTFRFUiIsIkZJTFRFUl9DRUxMIiwiZmlsdGVyIiwib3B0aW9ucyIsImxlbmd0aCIsIm9wdGlvbiIsImRhdGEiLCJYRVV0aWxzIiwiZ2V0IiwiY2hlY2tlZCIsInVwZGF0ZURhdGEiLCJFWFBPUlRfUk9XIiwib3B0cyIsImV4cG9ydENzdiIsImFzc2lnbiIsIkVYUE9SVF9TRUxFQ1RJT05fUk9XIiwiRVhQT1JUX0FMTCIsIkhJRERFTl9DT0xVTU4iLCJoaWRlQ29sdW1uIiwiUkVTRVRfQ09MVU1OIiwicmVzZXRDdXN0b21zIiwiUkVTRVRfUkVTSVpBQkxFIiwicmVzZXRSZXNpemFibGUiLCJSRVNFVF9BTEwiLCJyZXNldEFsbCIsImNoZWNrUHJpdmlsZWdlIiwiaXRlbSIsImNvZGUiLCJjb2x1bW5zIiwiZGlzYWJsZWQiLCJzb21lIiwic29ydGFibGUiLCJvcmRlciIsImZpbHRlcnMiLCJoYW5kbGVQcml2aWxlZ2VFdmVudCIsImZvckVhY2giLCJsaXN0IiwiY2hpbGRyZW4iLCJjaGlsZCIsIlZYRVRhYmxlUGx1Z2luTWVudXMiLCJpbnN0YWxsIiwieHRhYmxlIiwiaW50ZXJjZXB0b3IiLCJhZGQiLCJtZW51cyIsIm1peGluIiwid2luZG93IiwiVlhFVGFibGUiLCJ1c2UiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTs7OztBQUdBLElBQU1BLE9BQU8sR0FBRztBQUNkQyxFQUFBQSxVQURjLDRCQUMwQjtBQUFBLFFBQTFCQyxNQUEwQixRQUExQkEsTUFBMEI7QUFBQSxRQUFsQkMsR0FBa0IsUUFBbEJBLEdBQWtCO0FBQUEsUUFBYkMsTUFBYSxRQUFiQSxNQUFhOztBQUN0QyxRQUFJRCxHQUFHLElBQUlDLE1BQVgsRUFBbUI7QUFDakJGLE1BQUFBLE1BQU0sQ0FBQ0csU0FBUCxDQUFpQkYsR0FBakIsRUFBc0JDLE1BQU0sQ0FBQ0UsUUFBN0I7QUFDRDtBQUNGLEdBTGE7QUFNZEMsRUFBQUEsU0FOYyw0QkFNaUI7QUFBQSxRQUFsQkwsTUFBa0IsU0FBbEJBLE1BQWtCO0FBQUEsUUFBVkMsR0FBVSxTQUFWQSxHQUFVOztBQUM3QixRQUFJQSxHQUFKLEVBQVM7QUFDUEQsTUFBQUEsTUFBTSxDQUFDRyxTQUFQLENBQWlCRixHQUFqQjtBQUNEO0FBQ0YsR0FWYTtBQVdkSyxFQUFBQSxtQkFYYyxzQ0FXc0I7QUFBQSxRQUFiTixNQUFhLFNBQWJBLE1BQWE7QUFDbENBLElBQUFBLE1BQU0sQ0FBQ0csU0FBUCxDQUFpQkgsTUFBTSxDQUFDTyxnQkFBUCxFQUFqQjtBQUNELEdBYmE7QUFjZEMsRUFBQUEsU0FkYyw0QkFjWTtBQUFBLFFBQWJSLE1BQWEsU0FBYkEsTUFBYTtBQUN4QkEsSUFBQUEsTUFBTSxDQUFDRyxTQUFQO0FBQ0QsR0FoQmE7QUFpQmRNLEVBQUFBLFdB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Q0FBYSxVQUFDVCxJQUFELEVBQWM7QUFDekJELE1BQUFBLGNBQWMsQ0FBQ0MsSUFBRCxFQUFPL0MsTUFBUCxDQUFkOztBQUNBLFVBQUkrQyxJQUFJLENBQUNXLFFBQVQsRUFBbUI7QUFDakJYLFFBQUFBLElBQUksQ0FBQ1csUUFBTCxDQUFjRixPQUFkLENBQXNCLFVBQUNHLEtBQUQsRUFBZTtBQUNuQ2IsVUFBQUEsY0FBYyxDQUFDYSxLQUFELEVBQVEzRCxNQUFSLENBQWQ7QUFDRCxTQUZEO0FBR0Q7QUFDRixLQVBEO0FBUUQsR0FURDtBQVVEO0FBRUQ7Ozs7O0FBR08sSUFBTTRELG1CQUFtQixHQUFHO0FBQ2pDQyxFQUFBQSxPQURpQyxtQkFDeEJDLE1BRHdCLEVBQ0Q7QUFDOUJBLElBQUFBLE1BQU0sQ0FBQ0MsV0FBUCxDQUFtQkMsR0FBbkIsQ0FBdUIsaUJBQXZCLEVBQTBDVCxvQkFBMUM7QUFDQU8sSUFBQUEsTUFBTSxDQUFDRyxLQUFQLENBQWFDLEtBQWIsQ0FBbUJyRixPQUFuQjtBQUNEO0FBSmdDLENBQTVCOzs7QUFPUCxJQUFJLE9BQU9zRixNQUFQLEtBQWtCLFdBQWxCLElBQWlDQSxNQUFNLENBQUNDLFFBQTVDLEVBQXNEO0FBQ3BERCxFQUFBQSxNQUFNLENBQUNDLFFBQVAsQ0FBZ0JDLEdBQWhCLENBQW9CVCxtQkFBcEI7QUFDRDs7ZUFFY0EsbUIiLCJmaWxlIjoiaW5kZXguY29tbW9uLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFhFVXRpbHMgZnJvbSAneGUtdXRpbHMvbWV0aG9kcy94ZS11dGlscydcclxuaW1wb3J0IFZYRVRhYmxlIGZyb20gJ3Z4ZS10YWJsZS9saWIvdnhlLXRhYmxlJ1xyXG5cclxuY29uc3QgbWVudU1hcCA9IHtcclxuICBDTEVBUl9DRUxMICh7ICR0YWJsZSwgcm93LCBjb2x1bW4gfTogYW55KSB7XHJcbiAgICBpZiAocm93ICYmIGNvbHVtbikge1xyXG4gICAgICAkdGFibGUuY2xlYXJEYXRhKHJvdywgY29sdW1uLnByb3BlcnR5KVxyXG4gICAgfVxyXG4gIH0sXHJcbiAgQ0xFQVJfUk9XICh7ICR0YWJsZSwgcm93IH06IGFueSkge1xyXG4gICAgaWYgKHJvdykge1xyXG4gICAgICAkdGFibGUuY2xlYXJEYXRhKHJvdylcclxuICAgIH1cclxuICB9LFxyXG4gIENMRUFSX1NFTEVDVElPTl9ST1cgKHsgJHRhYmxlIH06IGFueSkge1xyXG4gICAgJHRhYmxlLmNsZWFyRGF0YSgkdGFibGUuZ2V0U2VsZWN0UmVjb3JkcygpKVxyXG4gIH0sXHJcbiAgQ0xFQVJfQUxMICh7ICR0YWJsZSB9OiBhbnkpIHtcclxuICAgICR0YWJsZS5jbGVhckRhdGEoKVxyXG4gIH0sXHJcbiAgUkVWRVJUX0NFTEwgKHsgJHRhYmxlLCByb3csIGNvbHVtbiB9OiBhbnkpIHtcclxuICAgIGlmIChyb3cgJiYgY29sdW1uKSB7XHJcbiAgICAgICR0YWJsZS5yZXZlcnREYXRhKHJvdywgY29sdW1uLnByb3BlcnR5KVxyXG4gICAgfVxyXG4gIH0sXHJcbiAgUkVWRVJUX1JPVyAoeyAkdGFibGUsIHJvdyB9OiBhbnkpIHtcclxuICAgIGlmIChyb3cpIHtcclxuICAgICAgJHRhYmxlLnJldmVydERhdGEocm93KVxyXG4gICAgfVxyXG4gIH0sXHJcbiAgUkVWRVJUX1NFTEVDVElPTl9ST1cgKHsgJHRhYmxlIH06IGFueSkge1xyXG4gICAgJHRhYmxlLnJldmVydERhdGEoJHRhYmxlLmdldFNlbGVjdFJlY29yZHMoKSlcclxuICB9LFxyXG4gIFJFVkVSVF9BTEwgKHsgJHRhYmxlIH06IGFueSkge1xyXG4gICAgJHRhYmxlLnJldmVydERhdGEoKVxyXG4gIH0sXHJcbiAgSU5TRVJUX1JPVyAoeyAkdGFibGUsIG1lbnUgfTogYW55KSB7XHJcbiAgICAkdGFibGUuaW5zZXJ0KG1lbnUucGFyYW1zKVxyXG4gIH0sXHJcbiAgSU5TRVJUX0FDVElWRURfUk9XICh7ICR0YWJsZSwgbWVudSwgY29sdW1uIH06IGFueSkge1xyXG4gICAgY29uc3QgYXJncyA9IG1lbnUucGFyYW1zIHx8IFtdXHJcbiAgICAkdGFibGUuaW5zZXJ0KGFyZ3NbMF0pXHJcbiAgICAgIC50aGVuKCh7IHJvdyB9OiBhbnkpID0+ICR0YWJsZS5zZXRBY3RpdmVDZWxsKHJvdywgYXJnc1sxXSB8fCBjb2x1bW4ucHJvcGVydHkpKVxyXG4gIH0sXHJcbiAgSU5TRVJUX0FUX1JPVyAoeyAkdGFibGUsIG1lbnUsIHJvdyB9OiBhbnkpIHtcclxuICAgIGlmIChyb3cpIHtcclxuICAgICAgJHRhYmxlLmluc2VydEF0KG1lbnUucGFyYW1zLCByb3cpXHJcbiAgICB9XHJcbiAgfSxcclxuICBJTlNFUlRfQVRfQUNUSVZFRF9ST1cgKHsgJHRhYmxlLCBtZW51LCByb3csIGNvbHVtbiB9OiBhbnkpIHtcclxuICAgIGlmIChyb3cpIHtcclxuICAgICAgY29uc3QgYXJncyA9IG1lbnUucGFyYW1zIHx8IFtdXHJcbiAgICAgICR0YWJsZS5pbnNlcnRBdChhcmdzWzBdLCByb3cpXHJcbiAgICAgICAgLnRoZW4oKHsgcm93IH06IGFueSkgPT4gJHRhYmxlLnNldEFjdGl2ZUNlbGwocm93LCBhcmdzWzFdIHx8IGNvbHVtbi5wcm9wZXJ0eSkpXHJcbiAgICB9XHJcbiAgfSxcclxuICBERUxFVEVfUk9XICh7ICR0YWJsZSwgcm93IH06IGFueSkge1xyXG4gICAgaWYgKHJvdykge1xyXG4gICAgICAkdGFibGUucmVtb3ZlKHJvdylcclxuICAgIH1cclxuICB9LFxyXG4gIERFTEVURV9TRUxFQ1RJT05fUk9XICh7ICR0YWJsZSB9OiBhbnkpIHtcclxuICAgICR0YWJsZS5yZW1vdmVTZWxlY3RlZHMoKVxyXG4gIH0sXHJcbiAgREVMRVRFX0FMTCAoeyAkdGFibGUgfTogYW55KSB7XHJcbiAgICAkdGFibGUucmVtb3ZlKClcclxuICB9LFxyXG4gIENMRUFSX1NPUlQgKHsgJHRhYmxlIH06IGFueSkge1xyXG4gICAgJHRhYmxlLmNsZWFyU29ydCgpXHJcbiAgfSxcclxuICBTT1JUX0FTQyAoeyAkdGFibGUsIGNvbHVtbiB9OiBhbnksIGV2bnQ6IGFueSkge1xyXG4gICAgaWYgKGNvbHVtbikge1xyXG4gICAgICAkdGFibGUudHJpZ2dlclNvcnRFdmVudChldm50LCBjb2x1bW4sICdhc2MnKVxyXG4gICAgfVxyXG4gIH0sXHJcbiAgU09SVF9ERVNDICh7ICR0YWJsZSwgY29sdW1uIH06IGFueSwgZXZudDogYW55KSB7XHJcbiAgICBpZiAoY29sdW1uKSB7XHJcbiAgICAgICR0YWJsZS50cmlnZ2VyU29ydEV2ZW50KGV2bnQsIGNvbHVtbiwgJ2Rlc2MnKVxyXG4gICAgfVxyXG4gIH0sXHJcbiAgQ0xFQVJfRklMVEVSICh7ICR0YWJsZSwgY29sdW1uIH06IGFueSkge1xyXG4gICAgaWYgKGNvbHVtbikge1xyXG4gICAgICAkdGFibGUuY2xlYXJGaWx0ZXIoY29sdW1uLnByb3BlcnR5KVxyXG4gICAgfVxyXG4gIH0sXHJcbiAgQ0xFQVJfQUxMX0ZJTFRFUiAoeyAkdGFibGUgfTogYW55KSB7XHJcbiAgICAkdGFibGUuY2xlYXJGaWx0ZXIoKVxyXG4gIH0sXHJcbiAgRklMVEVSX0NFTEwgKHsgJHRhYmxlLCByb3csIGNvbHVtbiB9OiBhbnkpIHtcclxuICAgIGlmIChyb3cgJiYgY29sdW1uKSB7XHJcbiAgICAgIGxldCB7IHByb3BlcnR5IH0gPSBjb2x1bW5cclxuICAgICAgJHRhYmxlLmZpbHRlcihwcm9wZXJ0eSlcclxuICAgICAgICAudGhlbigob3B0aW9uczogQXJyYXk8YW55PikgPT4ge1xyXG4gICAgICAgICAgaWYgKG9wdGlvbnMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIGxldCBvcHRpb24gPSBvcHRpb25zWzBdXHJcbiAgICAgICAgICAgIG9wdGlvbi5kYXRhID0gWEVVdGlscy5nZXQocm93LCBwcm9wZXJ0eSlcclxuICAgICAgICAgICAgb3B0aW9uLmNoZWNrZWQgPSB0cnVlXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgICAgICAudGhlbigoKSA9PiAkdGFibGUudXBkYXRlRGF0YSgpKVxyXG4gICAgfVxyXG4gIH0sXHJcbiAgRVhQT1JUX1JPVyAoeyAkdGFibGUsIG1lbnUsIHJvdyB9OiBhbnkpIHtcclxuICAgIGlmIChyb3cpIHtcclxuICAgICAgbGV0IG9wdHMgPSB7IGRhdGE6IFtyb3ddIH1cclxuICAgICAgJHRhYmxlLmV4cG9ydENzdihtZW51LnBhcmFtcyA/IFhFVXRpbHMuYXNzaWduKG9wdHMsIG1lbnUucGFyYW1zWzBdKSA6IG9wdHMpXHJcbiAgICB9XHJcbiAgfSxcclxuICBFWFBPUlRfU0VMRUNUSU9OX1JPVyAoeyAkdGFibGUsIG1lbnUgfTogYW55KSB7XHJcbiAgICBsZXQgb3B0cyA9IHsgZGF0YTogJHRhYmxlLmdldFNlbGVjdFJlY29yZHMoKSB9XHJcbiAgICAkdGFibGUuZXhwb3J0Q3N2KG1lbnUucGFyYW1zID8gWEVVdGlscy5hc3NpZ24ob3B0cywgbWVudS5wYXJhbXNbMF0pIDogb3B0cylcclxuICB9LFxyXG4gIEVYUE9SVF9BTEwgKHsgJHRhYmxlIH06IGFueSkge1xyXG4gICAgJHRhYmxlLmV4cG9ydENzdigpXHJcbiAgfSxcclxuICBISURERU5fQ09MVU1OICh7ICR0YWJsZSwgY29sdW1uIH06IGFueSkge1xyXG4gICAgaWYgKGNvbHVtbikge1xyXG4gICAgICAkdGFibGUuaGlkZUNvbHVtbigpXHJcbiAgICB9XHJcbiAgfSxcclxuICBSRVNFVF9DT0xVTU4gKHsgJHRhYmxlIH06IGFueSkge1xyXG4gICAgJHRhYmxlLnJlc2V0Q3VzdG9tcygpXHJcbiAgfSxcclxuICBSRVNFVF9SRVNJWkFCTEUgKHsgJHRhYmxlIH06IGFueSkge1xyXG4gICAgJHRhYmxlLnJlc2V0UmVzaXphYmxlKClcclxuICB9LFxyXG4gIFJFU0VUX0FMTCAoeyAkdGFibGUgfTogYW55KSB7XHJcbiAgICAkdGFibGUucmVzZXRBbGwoKVxyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gY2hlY2tQcml2aWxlZ2UgKGl0ZW06IGFueSwgcGFyYW1zOiBhbnkpIHtcclxuICBsZXQgeyBjb2RlIH0gPSBpdGVtXHJcbiAgbGV0IHsgY29sdW1ucywgY29sdW1uIH0gPSBwYXJhbXNcclxuICBzd2l0Y2ggKGNvZGUpIHtcclxuICAgIGNhc2UgJ0NMRUFSX1NPUlQnOlxyXG4gICAgICBpdGVtLmRpc2FibGVkID0gIWNvbHVtbnMuc29tZSgoY29sdW1uOiBhbnkpID0+IGNvbHVtbi5zb3J0YWJsZSAmJiBjb2x1bW4ub3JkZXIpXHJcbiAgICAgIGJyZWFrXHJcbiAgICBjYXNlICdDTEVBUl9BTExfRklMVEVSJzpcclxuICAgICAgaXRlbS5kaXNhYmxlZCA9ICFjb2x1bW5zLnNvbWUoKGNvbHVtbjogYW55KSA9PiBjb2x1bW4uZmlsdGVycyAmJiBjb2x1bW4uZmlsdGVycy5zb21lKChvcHRpb246IGFueSkgPT4gb3B0aW9uLmNoZWNrZWQpKVxyXG4gICAgICBicmVha1xyXG4gICAgY2FzZSAnQ0xFQVJfQ0VMTCc6XHJcbiAgICBjYXNlICdDTEVBUl9ST1cnOlxyXG4gICAgY2FzZSAnUkVWRVJUX0NFTEwnOlxyXG4gICAgY2FzZSAnUkVWRVJUX1JPVyc6XHJcbiAgICBjYXNlICdJTlNFUlRfQVRfUk9XJzpcclxuICAgIGNhc2UgJ0lOU0VSVF9BVF9BQ1RJVkVEX1JPVyc6XHJcbiAgICBjYXNlICdERUxFVEVfUk9XJzpcclxuICAgIGNhc2UgJ1NPUlRfQVNDJzpcclxuICAgIGNhc2UgJ1NPUlRfREVTQyc6XHJcbiAgICBjYXNlICdDTEVBUl9GSUxURVInOlxyXG4gICAgY2FzZSAnRklMVEVSX0NFTEwnOlxyXG4gICAgY2FzZSAnRVhQT1JUX1JPVyc6XHJcbiAgICBjYXNlICdISURERU5fQ09MVU1OJzpcclxuICAgICAgaXRlbS5kaXNhYmxlZCA9ICFjb2x1bW5cclxuICAgICAgaWYgKCFpdGVtLmRpc2FibGVkKSB7XHJcbiAgICAgICAgc3dpdGNoIChjb2RlKSB7XHJcbiAgICAgICAgICBjYXNlICdTT1JUX0FTQyc6XHJcbiAgICAgICAgICBjYXNlICdTT1JUX0RFU0MnOlxyXG4gICAgICAgICAgICBpdGVtLmRpc2FibGVkID0gIWNvbHVtbi5zb3J0YWJsZVxyXG4gICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgY2FzZSAnRklMVEVSX0NFTEwnOlxyXG4gICAgICAgICAgY2FzZSAnQ0xFQVJfRklMVEVSJzpcclxuICAgICAgICAgICAgaXRlbS5kaXNhYmxlZCA9ICFjb2x1bW4uZmlsdGVycyB8fCAhY29sdW1uLmZpbHRlcnMubGVuZ3RoXHJcbiAgICAgICAgICAgIGlmICghaXRlbS5kaXNhYmxlZCkge1xyXG4gICAgICAgICAgICAgIHN3aXRjaCAoY29kZSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnQ0xFQVJfRklMVEVSJzpcclxuICAgICAgICAgICAgICAgICAgaXRlbS5kaXNhYmxlZCA9ICFjb2x1bW4uZmlsdGVycy5zb21lKChvcHRpb246IGFueSkgPT4gb3B0aW9uLmNoZWNrZWQpXHJcbiAgICAgICAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGJyZWFrXHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVQcml2aWxlZ2VFdmVudCAocGFyYW1zOiBhbnkpIHtcclxuICBwYXJhbXMub3B0aW9ucy5mb3JFYWNoKChsaXN0OiBBcnJheTxhbnk+KSA9PiB7XHJcbiAgICBsaXN0LmZvckVhY2goKGl0ZW06IGFueSkgPT4ge1xyXG4gICAgICBjaGVja1ByaXZpbGVnZShpdGVtLCBwYXJhbXMpXHJcbiAgICAgIGlmIChpdGVtLmNoaWxkcmVuKSB7XHJcbiAgICAgICAgaXRlbS5jaGlsZHJlbi5mb3JFYWNoKChjaGlsZDogYW55KSA9PiB7XHJcbiAgICAgICAgICBjaGVja1ByaXZpbGVnZShjaGlsZCwgcGFyYW1zKVxyXG4gICAgICAgIH0pXHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgfSlcclxufVxyXG5cclxuLyoqXHJcbiAqIOWfuuS6jiB2eGUtdGFibGUg6KGo5qC855qE5aKe5by65o+S5Lu277yM5o+Q5L6b5a6e55So55qE5b+r5o236I+c5Y2V6ZuGXHJcbiAqL1xyXG5leHBvcnQgY29uc3QgVlhFVGFibGVQbHVnaW5NZW51cyA9IHtcclxuICBpbnN0YWxsICh4dGFibGU6IHR5cGVvZiBWWEVUYWJsZSkge1xyXG4gICAgeHRhYmxlLmludGVyY2VwdG9yLmFkZCgnZXZlbnQuc2hvd19tZW51JywgaGFuZGxlUHJpdmlsZWdlRXZlbnQpXHJcbiAgICB4dGFibGUubWVudXMubWl4aW4obWVudU1hcClcclxuICB9XHJcbn1cclxuXHJcbmlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB3aW5kb3cuVlhFVGFibGUpIHtcclxuICB3aW5kb3cuVlhFVGFibGUudXNlKFZYRVRhYmxlUGx1Z2luTWVudXMpXHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFZYRVRhYmxlUGx1Z2luTWVudXNcclxuIl19
