"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = exports.VXETablePluginMenus = void 0;

var _xeUtils = _interopRequireDefault(require("xe-utils/methods/xe-utils"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

var menuMap = {
  CLEAR_CELL: function CLEAR_CELL(params) {
    var $table = params.$table,
        row = params.row,
        column = params.column;

    if (row && column) {
      $table.clearData(row, column.property);
    }
  },
  CLEAR_ROW: function CLEAR_ROW(params) {
    var $table = params.$table,
        row = params.row;

    if (row) {
      $table.clearData(row);
    }
  },
  CLEAR_SELECTED_ROW: function CLEAR_SELECTED_ROW(params) {
    var $table = params.$table;
    $table.clearData($table.getCheckboxRecords());
  },
  CLEAR_ALL: function CLEAR_ALL(params) {
    var $table = params.$table;
    $table.clearData();
  },
  REVERT_CELL: function REVERT_CELL(params) {
    var $table = params.$table,
        row = params.row,
        column = params.column;

    if (row && column) {
      $table.revertData(row, column.property);
    }
  },
  REVERT_ROW: function REVERT_ROW(params) {
    var $table = params.$table,
        row = params.row;

    if (row) {
      $table.revertData(row);
    }
  },
  REVERT_SELECTED_ROW: function REVERT_SELECTED_ROW(params) {
    var $table = params.$table;
    $table.revertData($table.getCheckboxRecords());
  },
  REVERT_ALL: function REVERT_ALL(params) {
    var $table = params.$table;
    $table.revertData();
  },
  INSERT_ROW: function INSERT_ROW(params) {
    var $table = params.$table,
        menu = params.menu;
    $table.insert(menu.params);
  },
  INSERT_ACTIVED_ROW: function INSERT_ACTIVED_ROW(params) {
    var $table = params.$table,
        menu = params.menu,
        column = params.column;
    var args = menu.params || [];
    $table.insert(args[0]).then(function (_ref) {
      var row = _ref.row;
      return $table.setActiveCell(row, args[1] || column.property);
    });
  },
  INSERT_AT_ROW: function INSERT_AT_ROW(params) {
    var $table = params.$table,
        menu = params.menu,
        row = params.row;

    if (row) {
      $table.insertAt(menu.params, row);
    }
  },
  INSERT_AT_ACTIVED_ROW: function INSERT_AT_ACTIVED_ROW(params) {
    var $table = params.$table,
        menu = params.menu,
        row = params.row,
        column = params.column;

    if (row) {
      var args = menu.params || [];
      $table.insertAt(args[0], row).then(function (_ref2) {
        var row = _ref2.row;
        return $table.setActiveCell(row, args[1] || column.property);
      });
    }
  },
  DELETE_ROW: function DELETE_ROW(params) {
    var $table = params.$table,
        row = params.row;

    if (row) {
      $table.remove(row);
    }
  },
  DELETE_SELECTED_ROW: function DELETE_SELECTED_ROW(params) {
    var $table = params.$table;
    $table.removeCheckboxRow();
  },
  DELETE_ALL: function DELETE_ALL(params) {
    var $table = params.$table;
    $table.remove();
  },
  CLEAR_SORT: function CLEAR_SORT(params) {
    var $table = params.$table;
    $table.clearSort();
  },
  SORT_ASC: function SORT_ASC(params) {
    var $table = params.$table,
        column = params.column;

    if (column) {
      $table.sort(column.property, 'asc');
    }
  },
  SORT_DESC: function SORT_DESC(params) {
    var $table = params.$table,
        column = params.column;

    if (column) {
      $table.sort(column.property, 'desc');
    }
  },
  CLEAR_FILTER: function CLEAR_FILTER(params) {
    var $table = params.$table,
        column = params.column;

    if (column) {
      $table.clearFilter(column.property);
    }
  },
  CLEAR_ALL_FILTER: function CLEAR_ALL_FILTER(params) {
    var $table = params.$table;
    $table.clearFilter();
  },
  FILTER_CELL: function FILTER_CELL(params) {
    var $table = params.$table,
        row = params.row,
        column = params.column;

    if (row && column) {
      var property = column.property,
          filters = column.filters;

      if (filters.length) {
        var option = filters[0];
        option.data = _xeUtils["default"].get(row, property);
        option.checked = true;
        $table.updateData();
      }
    }
  },
  EXPORT_ROW: function EXPORT_ROW(params) {
    var $table = params.$table,
        menu = params.menu,
        row = params.row;

    if (row) {
      var opts = {
        data: [row]
      };
      $table.exportData(_xeUtils["default"].assign(opts, menu.params[0]));
    }
  },
  EXPORT_SELECTED_ROW: function EXPORT_SELECTED_ROW(params) {
    var $table = params.$table,
        menu = params.menu;
    var opts = {
      data: $table.getCheckboxRecords()
    };
    $table.exportData(_xeUtils["default"].assign(opts, menu.params[0]));
  },
  EXPORT_ALL: function EXPORT_ALL(params) {
    var $table = params.$table,
        menu = params.menu;
    $table.exportData(menu.params);
  },
  PRINT_ALL: function PRINT_ALL(params) {
    var $table = params.$table,
        menu = params.menu;
    $table.print(menu.params);
  },
  PRINT_SELECTED_ROW: function PRINT_SELECTED_ROW(params) {
    var $table = params.$table,
        menu = params.menu;
    var opts = {
      data: $table.getCheckboxRecords()
    };
    $table.print(_xeUtils["default"].assign(opts, menu.params));
  },
  HIDDEN_COLUMN: function HIDDEN_COLUMN(params) {
    var $table = params.$table,
        column = params.column;

    if (column) {
      $table.hideColumn(column);
    }
  },
  RESET_COLUMN: function RESET_COLUMN(params) {
    var $table = params.$table;
    $table.resetColumn({
      visible: true,
      resizable: false
    });
  },
  RESET_RESIZABLE: function RESET_RESIZABLE(params) {
    var $table = params.$table;
    $table.resetColumn({
      visible: false,
      resizable: true
    });
  },
  RESET_ALL: function RESET_ALL(params) {
    var $table = params.$table;
    $table.resetColumn(true);
  }
};

function checkPrivilege(item, params) {
  var code = item.code;
  var columns = params.columns,
      column = params.column;

  switch (code) {
    case 'CLEAR_SORT':
      item.disabled = !columns.some(function (column) {
        return column.sortable && column.order;
      });
      break;

    case 'CLEAR_ALL_FILTER':
      item.disabled = !columns.some(function (column) {
        return column.filters && column.filters.some(function (option) {
          return option.checked;
        });
      });
      break;

    case 'CLEAR_CELL':
    case 'CLEAR_ROW':
    case 'REVERT_CELL':
    case 'REVERT_ROW':
    case 'INSERT_AT_ROW':
    case 'INSERT_AT_ACTIVED_ROW':
    case 'DELETE_ROW':
    case 'SORT_ASC':
    case 'SORT_DESC':
    case 'CLEAR_FILTER':
    case 'FILTER_CELL':
    case 'EXPORT_ROW':
    case 'HIDDEN_COLUMN':
      item.disabled = !column;

      if (column) {
        switch (code) {
          case 'SORT_ASC':
          case 'SORT_DESC':
            item.disabled = !column.sortable;
            break;

          case 'FILTER_CELL':
          case 'CLEAR_FILTER':
            item.disabled = !column.filters || !column.filters.length;

            if (!item.disabled) {
              switch (code) {
                case 'CLEAR_FILTER':
                  item.disabled = !column.filters.some(function (option) {
                    return option.checked;
                  });
                  break;
              }
            }

            break;
        }
      }

      break;
  }
}

function handlePrivilegeEvent(params) {
  params.options.forEach(function (list) {
    list.forEach(function (item) {
      checkPrivilege(item, params);

      if (item.children) {
        item.children.forEach(function (child) {
          checkPrivilege(child, params);
        });
      }
    });
  });
}
/**
 * 基于 vxe-table 表格的增强插件，提供实用的快捷菜单集
 */


var VXETablePluginMenus = {
  install: function install(_ref3) {
    var interceptor = _ref3.interceptor,
        menus = _ref3.menus;
    interceptor.add('event.showMenu', handlePrivilegeEvent);
    menus.mixin(menuMap);
  }
};
exports.VXETablePluginMenus = VXETablePluginMenus;

if (typeof window !== 'undefined' && window.VXETable) {
  window.VXETable.use(VXETablePluginMenus);
}

var _default = VXETablePluginMenus;
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LnRzIl0sIm5hbWVzIjpbIm1lbnVNYXAiLCJDTEVBUl9DRUxMIiwicGFyYW1zIiwiJHRhYmxlIiwicm93IiwiY29sdW1uIiwiY2xlYXJEYXRhIiwicHJvcGVydHkiLCJDTEVBUl9ST1ciLCJDTEVBUl9TRUxFQ1RFRF9ST1ciLCJnZXRDaGVja2JveFJlY29yZHMiLCJDTEVBUl9BTEwiLCJSRVZFUlRfQ0VMTCIsInJldmVydERhdGEiLCJSRVZFUlRfUk9XIiwiUkVWRVJUX1NFTEVDVEVEX1JPVyIsIlJFVkVSVF9BTEwiLCJJTlNFUlRfUk9XIiwibWVudSIsImluc2VydCIsIklOU0VSVF9BQ1RJVkVEX1JPVyIsImFyZ3MiLCJ0aGVuIiwic2V0QWN0aXZlQ2VsbCIsIklOU0VSVF9BVF9ST1ciLCJpbnNlcnRBdCIsIklOU0VSVF9BVF9BQ1RJVkVEX1JPVyIsIkRFTEVURV9ST1ciLCJyZW1vdmUiLCJERUxFVEVfU0VMRUNURURfUk9XIiwicmVtb3ZlQ2hlY2tib3hSb3ciLCJERUxFVEVfQUxMIiwiQ0xFQVJfU09SVCIsImNsZWFyU29ydCIsIlNPUlRfQVNDIiwic29ydCIsIlNPUlRfREVTQyIsIkNMRUFSX0ZJTFRFUiIsImNsZWFyRmlsdGVyIiwiQ0xFQVJfQUxMX0ZJTFRFUiIsIkZJTFRFUl9DRUxMIiwiZmlsdGVycyIsImxlbmd0aCIsIm9wdGlvbiIsImRhdGEiLCJYRVV0aWxzIiwiZ2V0IiwiY2hlY2tlZCIsInVwZGF0ZURhdGEiLCJFWFBPUlRfUk9XIiwib3B0cyIsImV4cG9ydERhdGEiLCJhc3NpZ24iLCJFWFBPUlRfU0VMRUNURURfUk9XIiwiRVhQT1JUX0FMTCIsIlBSSU5UX0FMTCIsInByaW50IiwiUFJJTlRfU0VMRUNURURfUk9XIiwiSElEREVOX0NPTFVNTiIsImhpZGVDb2x1bW4iLCJSRVNFVF9DT0xVTU4iLCJyZXNldENvbHVtbiIsInZpc2libGUiLCJyZXNpemFibGUiLCJSRVNFVF9SRVNJWkFCTEUiLCJSRVNFVF9BTEwiLCJjaGVja1ByaXZpbGVnZSIsIml0ZW0iLCJjb2RlIiwiY29sdW1ucyIsImRpc2FibGVkIiwic29tZSIsInNvcnRhYmxlIiwib3JkZXIiLCJoYW5kbGVQcml2aWxlZ2VFdmVudCIsIm9wdGlvbnMiLCJmb3JFYWNoIiwibGlzdCIsImNoaWxkcmVuIiwiY2hpbGQiLCJWWEVUYWJsZVBsdWdpbk1lbnVzIiwiaW5zdGFsbCIsImludGVyY2VwdG9yIiwibWVudXMiLCJhZGQiLCJtaXhpbiIsIndpbmRvdyIsIlZYRVRhYmxlIiwidXNlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7Ozs7QUFHQSxJQUFNQSxPQUFPLEdBQUc7QUFDZEMsRUFBQUEsVUFEYyxzQkFDRkMsTUFERSxFQUNvQjtBQUFBLFFBQ3hCQyxNQUR3QixHQUNBRCxNQURBLENBQ3hCQyxNQUR3QjtBQUFBLFFBQ2hCQyxHQURnQixHQUNBRixNQURBLENBQ2hCRSxHQURnQjtBQUFBLFFBQ1hDLE1BRFcsR0FDQUgsTUFEQSxDQUNYRyxNQURXOztBQUVoQyxRQUFJRCxHQUFHLElBQUlDLE1BQVgsRUFBbUI7QUFDakJGLE1BQUFBLE1BQU0sQ0FBQ0csU0FBUCxDQUFpQkYsR0FBakIsRUFBc0JDLE1BQU0sQ0FBQ0UsUUFBN0I7QUFDRDtBQUNGLEdBTmE7QUFPZEMsRUFBQUEsU0FQYyxxQkFPSE4sTUFQRyxFQU9tQjtBQUFBLFFBQ3ZCQyxNQUR1QixHQUNQRCxNQURPLENBQ3ZCQyxNQUR1QjtBQUFBLFFBQ2ZDLEdBRGUsR0FDUEYsTUFETyxDQUNmRSxHQURlOztBQUUvQixRQUFJQSxHQUFKLEVBQVM7QUFDUEQsTUFBQUEsTUFBTSxDQUFDRyxTQUFQLENBQWlCRixHQUFqQjtBQUNEO0FBQ0YsR0FaYTtBQWFkSyxFQUFBQSxrQkFiYyw4QkFhTVAsTUFiTixFQWE0QjtBQUFBLFFBQ2hDQyxNQURnQyxHQUNyQkQsTUFEcUIsQ0FDaENDLE1BRGdDO0FBRXhDQSxJQUFBQSxNQUFNLENBQUNHLFNBQVAsQ0FBaUJILE1BQU0sQ0FBQ08sa0JBQVAsRUFBakI7QUFDRCxHQWhCYTtB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O0FBVUQ7QUFFRDs7Ozs7QUFHTyxJQUFNOEUsbUJBQW1CLEdBQUc7QUFDakNDLEVBQUFBLE9BRGlDLDBCQUNlO0FBQUEsUUFBckNDLFdBQXFDLFNBQXJDQSxXQUFxQztBQUFBLFFBQXhCQyxLQUF3QixTQUF4QkEsS0FBd0I7QUFDOUNELElBQUFBLFdBQVcsQ0FBQ0UsR0FBWixDQUFnQixnQkFBaEIsRUFBa0NWLG9CQUFsQztBQUNBUyxJQUFBQSxLQUFLLENBQUNFLEtBQU4sQ0FBWXJGLE9BQVo7QUFDRDtBQUpnQyxDQUE1Qjs7O0FBT1AsSUFBSSxPQUFPc0YsTUFBUCxLQUFrQixXQUFsQixJQUFpQ0EsTUFBTSxDQUFDQyxRQUE1QyxFQUFzRDtBQUNwREQsRUFBQUEsTUFBTSxDQUFDQyxRQUFQLENBQWdCQyxHQUFoQixDQUFvQlIsbUJBQXBCO0FBQ0Q7O2VBRWNBLG1CIiwiZmlsZSI6ImluZGV4LmNvbW1vbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBYRVV0aWxzIGZyb20gJ3hlLXV0aWxzL21ldGhvZHMveGUtdXRpbHMnXHJcbmltcG9ydCB7IFZYRVRhYmxlLCBNZW51TGlua1BhcmFtcywgSW50ZXJjZXB0b3JNZW51UGFyYW1zLCBGaXJzdE1lbnVPcHRpb24sIENoaWxkTWVudU9wdGlvbiB9IGZyb20gJ3Z4ZS10YWJsZS9saWIvdnhlLXRhYmxlJyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVudXNlZC12YXJzXHJcblxyXG5jb25zdCBtZW51TWFwID0ge1xyXG4gIENMRUFSX0NFTEwgKHBhcmFtczogTWVudUxpbmtQYXJhbXMpIHtcclxuICAgIGNvbnN0IHsgJHRhYmxlLCByb3csIGNvbHVtbiB9ID0gcGFyYW1zXHJcbiAgICBpZiAocm93ICYmIGNvbHVtbikge1xyXG4gICAgICAkdGFibGUuY2xlYXJEYXRhKHJvdywgY29sdW1uLnByb3BlcnR5KVxyXG4gICAgfVxyXG4gIH0sXHJcbiAgQ0xFQVJfUk9XIChwYXJhbXM6IE1lbnVMaW5rUGFyYW1zKSB7XHJcbiAgICBjb25zdCB7ICR0YWJsZSwgcm93IH0gPSBwYXJhbXNcclxuICAgIGlmIChyb3cpIHtcclxuICAgICAgJHRhYmxlLmNsZWFyRGF0YShyb3cpXHJcbiAgICB9XHJcbiAgfSxcclxuICBDTEVBUl9TRUxFQ1RFRF9ST1cgKHBhcmFtczogTWVudUxpbmtQYXJhbXMpIHtcclxuICAgIGNvbnN0IHsgJHRhYmxlIH0gPSBwYXJhbXNcclxuICAgICR0YWJsZS5jbGVhckRhdGEoJHRhYmxlLmdldENoZWNrYm94UmVjb3JkcygpKVxyXG4gIH0sXHJcbiAgQ0xFQVJfQUxMIChwYXJhbXM6IE1lbnVMaW5rUGFyYW1zKSB7XHJcbiAgICBjb25zdCB7ICR0YWJsZSB9ID0gcGFyYW1zXHJcbiAgICAkdGFibGUuY2xlYXJEYXRhKClcclxuICB9LFxyXG4gIFJFVkVSVF9DRUxMIChwYXJhbXM6IE1lbnVMaW5rUGFyYW1zKSB7XHJcbiAgICBjb25zdCB7ICR0YWJsZSwgcm93LCBjb2x1bW4gfSA9IHBhcmFtc1xyXG4gICAgaWYgKHJvdyAmJiBjb2x1bW4pIHtcclxuICAgICAgJHRhYmxlLnJldmVydERhdGEocm93LCBjb2x1bW4ucHJvcGVydHkpXHJcbiAgICB9XHJcbiAgfSxcclxuICBSRVZFUlRfUk9XIChwYXJhbXM6IE1lbnVMaW5rUGFyYW1zKSB7XHJcbiAgICBjb25zdCB7ICR0YWJsZSwgcm93IH0gPSBwYXJhbXNcclxuICAgIGlmIChyb3cpIHtcclxuICAgICAgJHRhYmxlLnJldmVydERhdGEocm93KVxyXG4gICAgfVxyXG4gIH0sXHJcbiAgUkVWRVJUX1NFTEVDVEVEX1JPVyAocGFyYW1zOiBNZW51TGlua1BhcmFtcykge1xyXG4gICAgY29uc3QgeyAkdGFibGUgfSA9IHBhcmFtc1xyXG4gICAgJHRhYmxlLnJldmVydERhdGEoJHRhYmxlLmdldENoZWNrYm94UmVjb3JkcygpKVxyXG4gIH0sXHJcbiAgUkVWRVJUX0FMTCAocGFyYW1zOiBNZW51TGlua1BhcmFtcykge1xyXG4gICAgY29uc3QgeyAkdGFibGUgfSA9IHBhcmFtc1xyXG4gICAgJHRhYmxlLnJldmVydERhdGEoKVxyXG4gIH0sXHJcbiAgSU5TRVJUX1JPVyAocGFyYW1zOiBNZW51TGlua1BhcmFtcykge1xyXG4gICAgY29uc3QgeyAkdGFibGUsIG1lbnUgfSA9IHBhcmFtc1xyXG4gICAgJHRhYmxlLmluc2VydChtZW51LnBhcmFtcylcclxuICB9LFxyXG4gIElOU0VSVF9BQ1RJVkVEX1JPVyAocGFyYW1zOiBNZW51TGlua1BhcmFtcykge1xyXG4gICAgY29uc3QgeyAkdGFibGUsIG1lbnUsIGNvbHVtbiB9ID0gcGFyYW1zXHJcbiAgICBjb25zdCBhcmdzID0gbWVudS5wYXJhbXMgfHwgW11cclxuICAgICR0YWJsZS5pbnNlcnQoYXJnc1swXSlcclxuICAgICAgLnRoZW4oKHsgcm93IH0pID0+ICR0YWJsZS5zZXRBY3RpdmVDZWxsKHJvdywgYXJnc1sxXSB8fCBjb2x1bW4ucHJvcGVydHkpKVxyXG4gIH0sXHJcbiAgSU5TRVJUX0FUX1JPVyAocGFyYW1zOiBNZW51TGlua1BhcmFtcykge1xyXG4gICAgY29uc3QgeyAkdGFibGUsIG1lbnUsIHJvdyB9ID0gcGFyYW1zXHJcbiAgICBpZiAocm93KSB7XHJcbiAgICAgICR0YWJsZS5pbnNlcnRBdChtZW51LnBhcmFtcywgcm93KVxyXG4gICAgfVxyXG4gIH0sXHJcbiAgSU5TRVJUX0FUX0FDVElWRURfUk9XIChwYXJhbXM6IE1lbnVMaW5rUGFyYW1zKSB7XHJcbiAgICBjb25zdCB7ICR0YWJsZSwgbWVudSwgcm93LCBjb2x1bW4gfSA9IHBhcmFtc1xyXG4gICAgaWYgKHJvdykge1xyXG4gICAgICBjb25zdCBhcmdzID0gbWVudS5wYXJhbXMgfHwgW11cclxuICAgICAgJHRhYmxlLmluc2VydEF0KGFyZ3NbMF0sIHJvdylcclxuICAgICAgICAudGhlbigoeyByb3cgfSkgPT4gJHRhYmxlLnNldEFjdGl2ZUNlbGwocm93LCBhcmdzWzFdIHx8IGNvbHVtbi5wcm9wZXJ0eSkpXHJcbiAgICB9XHJcbiAgfSxcclxuICBERUxFVEVfUk9XIChwYXJhbXM6IE1lbnVMaW5rUGFyYW1zKSB7XHJcbiAgICBjb25zdCB7ICR0YWJsZSwgcm93IH0gPSBwYXJhbXNcclxuICAgIGlmIChyb3cpIHtcclxuICAgICAgJHRhYmxlLnJlbW92ZShyb3cpXHJcbiAgICB9XHJcbiAgfSxcclxuICBERUxFVEVfU0VMRUNURURfUk9XIChwYXJhbXM6IE1lbnVMaW5rUGFyYW1zKSB7XHJcbiAgICBjb25zdCB7ICR0YWJsZSB9ID0gcGFyYW1zXHJcbiAgICAkdGFibGUucmVtb3ZlQ2hlY2tib3hSb3coKVxyXG4gIH0sXHJcbiAgREVMRVRFX0FMTCAocGFyYW1zOiBNZW51TGlua1BhcmFtcykge1xyXG4gICAgY29uc3QgeyAkdGFibGUgfSA9IHBhcmFtc1xyXG4gICAgJHRhYmxlLnJlbW92ZSgpXHJcbiAgfSxcclxuICBDTEVBUl9TT1JUIChwYXJhbXM6IE1lbnVMaW5rUGFyYW1zKSB7XHJcbiAgICBjb25zdCB7ICR0YWJsZSB9ID0gcGFyYW1zXHJcbiAgICAkdGFibGUuY2xlYXJTb3J0KClcclxuICB9LFxyXG4gIFNPUlRfQVNDIChwYXJhbXM6IE1lbnVMaW5rUGFyYW1zKSB7XHJcbiAgICBjb25zdCB7ICR0YWJsZSwgY29sdW1uIH0gPSBwYXJhbXNcclxuICAgIGlmIChjb2x1bW4pIHtcclxuICAgICAgJHRhYmxlLnNvcnQoY29sdW1uLnByb3BlcnR5LCAnYXNjJylcclxuICAgIH1cclxuICB9LFxyXG4gIFNPUlRfREVTQyAocGFyYW1zOiBNZW51TGlua1BhcmFtcykge1xyXG4gICAgY29uc3QgeyAkdGFibGUsIGNvbHVtbiB9ID0gcGFyYW1zXHJcbiAgICBpZiAoY29sdW1uKSB7XHJcbiAgICAgICR0YWJsZS5zb3J0KGNvbHVtbi5wcm9wZXJ0eSwgJ2Rlc2MnKVxyXG4gICAgfVxyXG4gIH0sXHJcbiAgQ0xFQVJfRklMVEVSIChwYXJhbXM6IE1lbnVMaW5rUGFyYW1zKSB7XHJcbiAgICBjb25zdCB7ICR0YWJsZSwgY29sdW1uIH0gPSBwYXJhbXNcclxuICAgIGlmIChjb2x1bW4pIHtcclxuICAgICAgJHRhYmxlLmNsZWFyRmlsdGVyKGNvbHVtbi5wcm9wZXJ0eSlcclxuICAgIH1cclxuICB9LFxyXG4gIENMRUFSX0FMTF9GSUxURVIgKHBhcmFtczogTWVudUxpbmtQYXJhbXMpIHtcclxuICAgIGNvbnN0IHsgJHRhYmxlIH0gPSBwYXJhbXNcclxuICAgICR0YWJsZS5jbGVhckZpbHRlcigpXHJcbiAgfSxcclxuICBGSUxURVJfQ0VMTCAocGFyYW1zOiBNZW51TGlua1BhcmFtcykge1xyXG4gICAgY29uc3QgeyAkdGFibGUsIHJvdywgY29sdW1uIH0gPSBwYXJhbXNcclxuICAgIGlmIChyb3cgJiYgY29sdW1uKSB7XHJcbiAgICAgIGxldCB7IHByb3BlcnR5LCBmaWx0ZXJzIH0gPSBjb2x1bW5cclxuICAgICAgaWYgKGZpbHRlcnMubGVuZ3RoKSB7XHJcbiAgICAgICAgbGV0IG9wdGlvbiA9IGZpbHRlcnNbMF1cclxuICAgICAgICBvcHRpb24uZGF0YSA9IFhFVXRpbHMuZ2V0KHJvdywgcHJvcGVydHkpXHJcbiAgICAgICAgb3B0aW9uLmNoZWNrZWQgPSB0cnVlXHJcbiAgICAgICAgJHRhYmxlLnVwZGF0ZURhdGEoKVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfSxcclxuICBFWFBPUlRfUk9XIChwYXJhbXM6IE1lbnVMaW5rUGFyYW1zKSB7XHJcbiAgICBjb25zdCB7ICR0YWJsZSwgbWVudSwgcm93IH0gPSBwYXJhbXNcclxuICAgIGlmIChyb3cpIHtcclxuICAgICAgbGV0IG9wdHMgPSB7IGRhdGE6IFtyb3ddIH1cclxuICAgICAgJHRhYmxlLmV4cG9ydERhdGEoWEVVdGlscy5hc3NpZ24ob3B0cywgbWVudS5wYXJhbXNbMF0pKVxyXG4gICAgfVxyXG4gIH0sXHJcbiAgRVhQT1JUX1NFTEVDVEVEX1JPVyAocGFyYW1zOiBNZW51TGlua1BhcmFtcykge1xyXG4gICAgY29uc3QgeyAkdGFibGUsIG1lbnUgfSA9IHBhcmFtc1xyXG4gICAgbGV0IG9wdHMgPSB7IGRhdGE6ICR0YWJsZS5nZXRDaGVja2JveFJlY29yZHMoKSB9XHJcbiAgICAkdGFibGUuZXhwb3J0RGF0YShYRVV0aWxzLmFzc2lnbihvcHRzLCBtZW51LnBhcmFtc1swXSkpXHJcbiAgfSxcclxuICBFWFBPUlRfQUxMIChwYXJhbXM6IE1lbnVMaW5rUGFyYW1zKSB7XHJcbiAgICBjb25zdCB7ICR0YWJsZSwgbWVudSB9ID0gcGFyYW1zXHJcbiAgICAkdGFibGUuZXhwb3J0RGF0YShtZW51LnBhcmFtcylcclxuICB9LFxyXG4gIFBSSU5UX0FMTCAocGFyYW1zOiBNZW51TGlua1BhcmFtcykge1xyXG4gICAgY29uc3QgeyAkdGFibGUsIG1lbnUgfSA9IHBhcmFtc1xyXG4gICAgJHRhYmxlLnByaW50KG1lbnUucGFyYW1zKVxyXG4gIH0sXHJcbiAgUFJJTlRfU0VMRUNURURfUk9XIChwYXJhbXM6IE1lbnVMaW5rUGFyYW1zKSB7XHJcbiAgICBjb25zdCB7ICR0YWJsZSwgbWVudSB9ID0gcGFyYW1zXHJcbiAgICBsZXQgb3B0cyA9IHsgZGF0YTogJHRhYmxlLmdldENoZWNrYm94UmVjb3JkcygpIH1cclxuICAgICR0YWJsZS5wcmludChYRVV0aWxzLmFzc2lnbihvcHRzLCBtZW51LnBhcmFtcykpXHJcbiAgfSxcclxuICBISURERU5fQ09MVU1OIChwYXJhbXM6IE1lbnVMaW5rUGFyYW1zKSB7XHJcbiAgICBjb25zdCB7ICR0YWJsZSwgY29sdW1uIH0gPSBwYXJhbXNcclxuICAgIGlmIChjb2x1bW4pIHtcclxuICAgICAgJHRhYmxlLmhpZGVDb2x1bW4oY29sdW1uKVxyXG4gICAgfVxyXG4gIH0sXHJcbiAgUkVTRVRfQ09MVU1OIChwYXJhbXM6IE1lbnVMaW5rUGFyYW1zKSB7XHJcbiAgICBjb25zdCB7ICR0YWJsZSB9ID0gcGFyYW1zXHJcbiAgICAkdGFibGUucmVzZXRDb2x1bW4oeyB2aXNpYmxlOiB0cnVlLCByZXNpemFibGU6IGZhbHNlIH0pXHJcbiAgfSxcclxuICBSRVNFVF9SRVNJWkFCTEUgKHBhcmFtczogTWVudUxpbmtQYXJhbXMpIHtcclxuICAgIGNvbnN0IHsgJHRhYmxlIH0gPSBwYXJhbXNcclxuICAgICR0YWJsZS5yZXNldENvbHVtbih7IHZpc2libGU6IGZhbHNlLCByZXNpemFibGU6IHRydWUgfSlcclxuICB9LFxyXG4gIFJFU0VUX0FMTCAocGFyYW1zOiBNZW51TGlua1BhcmFtcykge1xyXG4gICAgY29uc3QgeyAkdGFibGUgfSA9IHBhcmFtc1xyXG4gICAgJHRhYmxlLnJlc2V0Q29sdW1uKHRydWUpXHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBjaGVja1ByaXZpbGVnZSAoaXRlbTogRmlyc3RNZW51T3B0aW9uIHwgQ2hpbGRNZW51T3B0aW9uLCBwYXJhbXM6IEludGVyY2VwdG9yTWVudVBhcmFtcykge1xyXG4gIGxldCB7IGNvZGUgfSA9IGl0ZW1cclxuICBsZXQgeyBjb2x1bW5zLCBjb2x1bW4gfSA9IHBhcmFtc1xyXG4gIHN3aXRjaCAoY29kZSkge1xyXG4gICAgY2FzZSAnQ0xFQVJfU09SVCc6XHJcbiAgICAgIGl0ZW0uZGlzYWJsZWQgPSAhY29sdW1ucy5zb21lKChjb2x1bW4pID0+IGNvbHVtbi5zb3J0YWJsZSAmJiBjb2x1bW4ub3JkZXIpXHJcbiAgICAgIGJyZWFrXHJcbiAgICBjYXNlICdDTEVBUl9BTExfRklMVEVSJzpcclxuICAgICAgaXRlbS5kaXNhYmxlZCA9ICFjb2x1bW5zLnNvbWUoKGNvbHVtbikgPT4gY29sdW1uLmZpbHRlcnMgJiYgY29sdW1uLmZpbHRlcnMuc29tZSgob3B0aW9uKSA9PiBvcHRpb24uY2hlY2tlZCkpXHJcbiAgICAgIGJyZWFrXHJcbiAgICBjYXNlICdDTEVBUl9DRUxMJzpcclxuICAgIGNhc2UgJ0NMRUFSX1JPVyc6XHJcbiAgICBjYXNlICdSRVZFUlRfQ0VMTCc6XHJcbiAgICBjYXNlICdSRVZFUlRfUk9XJzpcclxuICAgIGNhc2UgJ0lOU0VSVF9BVF9ST1cnOlxyXG4gICAgY2FzZSAnSU5TRVJUX0FUX0FDVElWRURfUk9XJzpcclxuICAgIGNhc2UgJ0RFTEVURV9ST1cnOlxyXG4gICAgY2FzZSAnU09SVF9BU0MnOlxyXG4gICAgY2FzZSAnU09SVF9ERVNDJzpcclxuICAgIGNhc2UgJ0NMRUFSX0ZJTFRFUic6XHJcbiAgICBjYXNlICdGSUxURVJfQ0VMTCc6XHJcbiAgICBjYXNlICdFWFBPUlRfUk9XJzpcclxuICAgIGNhc2UgJ0hJRERFTl9DT0xVTU4nOlxyXG4gICAgICBpdGVtLmRpc2FibGVkID0gIWNvbHVtblxyXG4gICAgICBpZiAoY29sdW1uKSB7XHJcbiAgICAgICAgc3dpdGNoIChjb2RlKSB7XHJcbiAgICAgICAgICBjYXNlICdTT1JUX0FTQyc6XHJcbiAgICAgICAgICBjYXNlICdTT1JUX0RFU0MnOlxyXG4gICAgICAgICAgICBpdGVtLmRpc2FibGVkID0gIWNvbHVtbi5zb3J0YWJsZVxyXG4gICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgY2FzZSAnRklMVEVSX0NFTEwnOlxyXG4gICAgICAgICAgY2FzZSAnQ0xFQVJfRklMVEVSJzpcclxuICAgICAgICAgICAgaXRlbS5kaXNhYmxlZCA9ICFjb2x1bW4uZmlsdGVycyB8fCAhY29sdW1uLmZpbHRlcnMubGVuZ3RoXHJcbiAgICAgICAgICAgIGlmICghaXRlbS5kaXNhYmxlZCkge1xyXG4gICAgICAgICAgICAgIHN3aXRjaCAoY29kZSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnQ0xFQVJfRklMVEVSJzpcclxuICAgICAgICAgICAgICAgICAgaXRlbS5kaXNhYmxlZCA9ICFjb2x1bW4uZmlsdGVycy5zb21lKChvcHRpb24pID0+IG9wdGlvbi5jaGVja2VkKVxyXG4gICAgICAgICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBicmVha1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBicmVha1xyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlUHJpdmlsZWdlRXZlbnQgKHBhcmFtczogSW50ZXJjZXB0b3JNZW51UGFyYW1zKSB7XHJcbiAgcGFyYW1zLm9wdGlvbnMuZm9yRWFjaCgobGlzdCkgPT4ge1xyXG4gICAgbGlzdC5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICAgIGNoZWNrUHJpdmlsZWdlKGl0ZW0sIHBhcmFtcylcclxuICAgICAgaWYgKGl0ZW0uY2hpbGRyZW4pIHtcclxuICAgICAgICBpdGVtLmNoaWxkcmVuLmZvckVhY2goKGNoaWxkKSA9PiB7XHJcbiAgICAgICAgICBjaGVja1ByaXZpbGVnZShjaGlsZCwgcGFyYW1zKVxyXG4gICAgICAgIH0pXHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgfSlcclxufVxyXG5cclxuLyoqXHJcbiAqIOWfuuS6jiB2eGUtdGFibGUg6KGo5qC855qE5aKe5by65o+S5Lu277yM5o+Q5L6b5a6e55So55qE5b+r5o236I+c5Y2V6ZuGXHJcbiAqL1xyXG5leHBvcnQgY29uc3QgVlhFVGFibGVQbHVnaW5NZW51cyA9IHtcclxuICBpbnN0YWxsICh7IGludGVyY2VwdG9yLCBtZW51cyB9OiB0eXBlb2YgVlhFVGFibGUpIHtcclxuICAgIGludGVyY2VwdG9yLmFkZCgnZXZlbnQuc2hvd01lbnUnLCBoYW5kbGVQcml2aWxlZ2VFdmVudClcclxuICAgIG1lbnVzLm1peGluKG1lbnVNYXApXHJcbiAgfVxyXG59XHJcblxyXG5pZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiYgd2luZG93LlZYRVRhYmxlKSB7XHJcbiAgd2luZG93LlZYRVRhYmxlLnVzZShWWEVUYWJsZVBsdWdpbk1lbnVzKVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBWWEVUYWJsZVBsdWdpbk1lbnVzXHJcbiJdfQ==
