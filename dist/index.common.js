"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = exports.VXETablePluginMenus = void 0;

var _xeUtils = _interopRequireDefault(require("xe-utils/methods/xe-utils"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

// import { VXETable } from 'vxe-table'
var menuMap = {
  CLEAR_CELL: function CLEAR_CELL(_ref) {
    var $table = _ref.$table,
        row = _ref.row,
        column = _ref.column;

    if (row && column) {
      $table.clearData(row, column.property);
    }
  },
  CLEAR_ROW: function CLEAR_ROW(_ref2) {
    var $table = _ref2.$table,
        row = _ref2.row;

    if (row) {
      $table.clearData(row);
    }
  },
  CLEAR_SELECTION_ROW: function CLEAR_SELECTION_ROW(_ref3) {
    var $table = _ref3.$table;
    $table.clearData($table.getSelectRecords());
  },
  CLEAR_ALL: function CLEAR_ALL(_ref4) {
    var $table = _ref4.$table;
    $table.clearData();
  },
  REVERT_CELL: function REVERT_CELL(_ref5) {
    var $table = _ref5.$table,
        row = _ref5.row,
        column = _ref5.column;

    if (row && column) {
      $table.revertData(row, column.property);
    }
  },
  REVERT_ROW: function REVERT_ROW(_ref6) {
    var $table = _ref6.$table,
        row = _ref6.row;

    if (row) {
      $table.revertData(row);
    }
  },
  REVERT_SELECTION_ROW: function REVERT_SELECTION_ROW(_ref7) {
    var $table = _ref7.$table;
    $table.revertData($table.getSelectRecords());
  },
  REVERT_ALL: function REVERT_ALL(_ref8) {
    var $table = _ref8.$table;
    $table.revertData();
  },
  INSERT_ROW: function INSERT_ROW(_ref9) {
    var $table = _ref9.$table,
        menu = _ref9.menu;
    $table.insert(menu.params);
  },
  INSERT_ACTIVED_ROW: function INSERT_ACTIVED_ROW(_ref10) {
    var $table = _ref10.$table,
        menu = _ref10.menu,
        column = _ref10.column;
    var args = menu.params || [];
    $table.insert(args[0]).then(function (_ref11) {
      var row = _ref11.row;
      return $table.setActiveCell(row, args[1] || column.property);
    });
  },
  INSERT_AT_ROW: function INSERT_AT_ROW(_ref12) {
    var $table = _ref12.$table,
        menu = _ref12.menu,
        row = _ref12.row;

    if (row) {
      $table.insertAt(menu.params, row);
    }
  },
  INSERT_AT_ACTIVED_ROW: function INSERT_AT_ACTIVED_ROW(_ref13) {
    var $table = _ref13.$table,
        menu = _ref13.menu,
        row = _ref13.row,
        column = _ref13.column;

    if (row) {
      var args = menu.params || [];
      $table.insertAt(args[0], row).then(function (_ref14) {
        var row = _ref14.row;
        return $table.setActiveCell(row, args[1] || column.property);
      });
    }
  },
  DELETE_ROW: function DELETE_ROW(_ref15) {
    var $table = _ref15.$table,
        row = _ref15.row;

    if (row) {
      $table.remove(row);
    }
  },
  DELETE_SELECTION_ROW: function DELETE_SELECTION_ROW(_ref16) {
    var $table = _ref16.$table;
    $table.removeSelecteds();
  },
  DELETE_ALL: function DELETE_ALL(_ref17) {
    var $table = _ref17.$table;
    $table.remove();
  },
  CLEAR_SORT: function CLEAR_SORT(_ref18) {
    var $table = _ref18.$table;
    $table.clearSort();
  },
  SORT_ASC: function SORT_ASC(_ref19, evnt) {
    var $table = _ref19.$table,
        column = _ref19.column;

    if (column) {
      $table.triggerSortEvent(evnt, column, 'asc');
    }
  },
  SORT_DESC: function SORT_DESC(_ref20, evnt) {
    var $table = _ref20.$table,
        column = _ref20.column;

    if (column) {
      $table.triggerSortEvent(evnt, column, 'desc');
    }
  },
  CLEAR_FILTER: function CLEAR_FILTER(_ref21) {
    var $table = _ref21.$table,
        column = _ref21.column;

    if (column) {
      $table.clearFilter(column.property);
    }
  },
  CLEAR_ALL_FILTER: function CLEAR_ALL_FILTER(_ref22) {
    var $table = _ref22.$table;
    $table.clearFilter();
  },
  FILTER_CELL: function FILTER_CELL(_ref23) {
    var $table = _ref23.$table,
        row = _ref23.row,
        column = _ref23.column;

    if (row && column) {
      var property = column.property;
      $table.filter(property).then(function (options) {
        if (options.length) {
          var option = options[0];
          option.data = _xeUtils["default"].get(row, property);
          option.checked = true;
        }
      }).then(function () {
        return $table.updateData();
      });
    }
  },
  EXPORT_ROW: function EXPORT_ROW(_ref24) {
    var $table = _ref24.$table,
        menu = _ref24.menu,
        row = _ref24.row;

    if (row) {
      var opts = {
        data: [row]
      };
      $table.exportCsv(menu.params ? _xeUtils["default"].assign(opts, menu.params[0]) : opts);
    }
  },
  EXPORT_SELECTION_ROW: function EXPORT_SELECTION_ROW(_ref25) {
    var $table = _ref25.$table,
        menu = _ref25.menu;
    var opts = {
      data: $table.getSelectRecords()
    };
    $table.exportCsv(menu.params ? _xeUtils["default"].assign(opts, menu.params[0]) : opts);
  },
  EXPORT_ALL: function EXPORT_ALL(_ref26) {
    var $table = _ref26.$table;
    $table.exportCsv();
  },
  HIDDEN_COLUMN: function HIDDEN_COLUMN(_ref27) {
    var $table = _ref27.$table,
        column = _ref27.column;

    if (column) {
      $table.hideColumn();
    }
  },
  RESET_COLUMN: function RESET_COLUMN(_ref28) {
    var $table = _ref28.$table;
    $table.resetCustoms();
  },
  RESET_RESIZABLE: function RESET_RESIZABLE(_ref29) {
    var $table = _ref29.$table;
    $table.resetResizable();
  },
  RESET_ALL: function RESET_ALL(_ref30) {
    var $table = _ref30.$table;
    $table.resetAll();
  }
};

function checkPrivilege(item, params) {
  var code = item.code;
  var columns = params.columns,
      column = params.column;

  switch (code) {
    case 'CLEAR_SORT':
      item.disabled = !columns.some(function (column) {
        return column.sortable && column.order;
      });
      break;

    case 'CLEAR_ALL_FILTER':
      item.disabled = !columns.some(function (column) {
        return column.filters && column.filters.some(function (option) {
          return option.checked;
        });
      });
      break;

    case 'CLEAR_CELL':
    case 'CLEAR_ROW':
    case 'REVERT_CELL':
    case 'REVERT_ROW':
    case 'INSERT_AT_ROW':
    case 'INSERT_AT_ACTIVED_ROW':
    case 'DELETE_ROW':
    case 'SORT_ASC':
    case 'SORT_DESC':
    case 'CLEAR_FILTER':
    case 'FILTER_CELL':
    case 'EXPORT_ROW':
    case 'HIDDEN_COLUMN':
      item.disabled = !column;

      if (!item.disabled) {
        switch (code) {
          case 'SORT_ASC':
          case 'SORT_DESC':
            item.disabled = !column.sortable;
            break;

          case 'FILTER_CELL':
          case 'CLEAR_FILTER':
            item.disabled = !column.filters || !column.filters.length;

            if (!item.disabled) {
              switch (code) {
                case 'CLEAR_FILTER':
                  item.disabled = !column.filters.some(function (option) {
                    return option.checked;
                  });
                  break;
              }
            }

            break;
        }
      }

      break;
  }
}

function handlePrivilegeEvent(params) {
  params.options.forEach(function (list) {
    list.forEach(function (item) {
      checkPrivilege(item, params);

      if (item.children) {
        item.children.forEach(function (child) {
          checkPrivilege(child, params);
        });
      }
    });
  });
}
/**
 * 基于 vxe-table 表格的增强插件，提供实用的快捷菜单集
 */


var VXETablePluginMenus = {
  install: function install(xtable) {
    xtable.interceptor.add('event.show_menu', handlePrivilegeEvent);
    xtable.menus.mixin(menuMap);
  }
};
exports.VXETablePluginMenus = VXETablePluginMenus;

if (typeof window !== 'undefined' && window.VXETable) {
  window.VXETable.use(VXETablePluginMenus);
}

var _default = VXETablePluginMenus;
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LnRzIl0sIm5hbWVzIjpbIm1lbnVNYXAiLCJDTEVBUl9DRUxMIiwiJHRhYmxlIiwicm93IiwiY29sdW1uIiwiY2xlYXJEYXRhIiwicHJvcGVydHkiLCJDTEVBUl9ST1ciLCJDTEVBUl9TRUxFQ1RJT05fUk9XIiwiZ2V0U2VsZWN0UmVjb3JkcyIsIkNMRUFSX0FMTCIsIlJFVkVSVF9DRUxMIiwicmV2ZXJ0RGF0YSIsIlJFVkVSVF9ST1ciLCJSRVZFUlRfU0VMRUNUSU9OX1JPVyIsIlJFVkVSVF9BTEwiLCJJTlNFUlRfUk9XIiwibWVudSIsImluc2VydCIsInBhcmFtcyIsIklOU0VSVF9BQ1RJVkVEX1JPVyIsImFyZ3MiLCJ0aGVuIiwic2V0QWN0aXZlQ2VsbCIsIklOU0VSVF9BVF9ST1ciLCJpbnNlcnRBdCIsIklOU0VSVF9BVF9BQ1RJVkVEX1JPVyIsIkRFTEVURV9ST1ciLCJyZW1vdmUiLCJERUxFVEVfU0VMRUNUSU9OX1JPVyIsInJlbW92ZVNlbGVjdGVkcyIsIkRFTEVURV9BTEwiLCJDTEVBUl9TT1JUIiwiY2xlYXJTb3J0IiwiU09SVF9BU0MiLCJldm50IiwidHJpZ2dlclNvcnRFdmVudCIsIlNPUlRfREVTQyIsIkNMRUFSX0ZJTFRFUiIsImNsZWFyRmlsdGVyIiwiQ0xFQVJfQUxMX0ZJTFRFUiIsIkZJTFRFUl9DRUxMIiwiZmlsdGVyIiwib3B0aW9ucyIsImxlbmd0aCIsIm9wdGlvbiIsImRhdGEiLCJYRVV0aWxzIiwiZ2V0IiwiY2hlY2tlZCIsInVwZGF0ZURhdGEiLCJFWFBPUlRfUk9XIiwib3B0cyIsImV4cG9ydENzdiIsImFzc2lnbiIsIkVYUE9SVF9TRUxFQ1RJT05fUk9XIiwiRVhQT1JUX0FMTCIsIkhJRERFTl9DT0xVTU4iLCJoaWRlQ29sdW1uIiwiUkVTRVRfQ09MVU1OIiwicmVzZXRDdXN0b21zIiwiUkVTRVRfUkVTSVpBQkxFIiwicmVzZXRSZXNpemFibGUiLCJSRVNFVF9BTEwiLCJyZXNldEFsbCIsImNoZWNrUHJpdmlsZWdlIiwiaXRlbSIsImNvZGUiLCJjb2x1bW5zIiwiZGlzYWJsZWQiLCJzb21lIiwic29ydGFibGUiLCJvcmRlciIsImZpbHRlcnMiLCJoYW5kbGVQcml2aWxlZ2VFdmVudCIsImZvckVhY2giLCJsaXN0IiwiY2hpbGRyZW4iLCJjaGlsZCIsIlZYRVRhYmxlUGx1Z2luTWVudXMiLCJpbnN0YWxsIiwieHRhYmxlIiwiaW50ZXJjZXB0b3IiLCJhZGQiLCJtZW51cyIsIm1peGluIiwid2luZG93IiwiVlhFVGFibGUiLCJ1c2UiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTs7OztBQUNBO0FBRUEsSUFBTUEsT0FBTyxHQUFHO0FBQ2RDLEVBQUFBLFVBRGMsNEJBQzBCO0FBQUEsUUFBMUJDLE1BQTBCLFFBQTFCQSxNQUEwQjtBQUFBLFFBQWxCQyxHQUFrQixRQUFsQkEsR0FBa0I7QUFBQSxRQUFiQyxNQUFhLFFBQWJBLE1BQWE7O0FBQ3RDLFFBQUlELEdBQUcsSUFBSUMsTUFBWCxFQUFtQjtBQUNqQkYsTUFBQUEsTUFBTSxDQUFDRyxTQUFQLENBQWlCRixHQUFqQixFQUFzQkMsTUFBTSxDQUFDRSxRQUE3QjtBQUNEO0FBQ0YsR0FMYTtBQU1kQyxFQUFBQSxTQU5jLDRCQU1pQjtBQUFBLFFBQWxCTCxNQUFrQixTQUFsQkEsTUFBa0I7QUFBQSxRQUFWQyxHQUFVLFNBQVZBLEdBQVU7O0FBQzdCLFFBQUlBLEdBQUosRUFBUztBQUNQRCxNQUFBQSxNQUFNLENBQUNHLFNBQVAsQ0FBaUJGLEdBQWpCO0FBQ0Q7QUFDRixHQVZhO0FBV2RLLEVBQUFBLG1CQVhjLHNDQVdzQjtBQUFBLFFBQWJOLE1BQWEsU0FBYkEsTUFBYTtBQUNsQ0EsSUFBQUEsTUFBTSxDQUFDRyxTQUFQLENBQWlCSCxNQUFNLENBQUNPLGdCQUFQLEVBQWpCO0FBQ0QsR0FiYTtBQWNkQyxFQUFBQSxTQWRjLDRCQWNZO0FBQUEsUUFBYlIsTUFBYSxTQUFiQSxNQUFhO0FBQ3hCQSxJQUFBQSxNQUFNLENBQUNHLFNBQVA7QUFDRCxHQWhCYTtBQWlCZE0sRUFB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T0FBTCxDQUFhLFVBQUNULElBQUQsRUFBYztBQUN6QkQsTUFBQUEsY0FBYyxDQUFDQyxJQUFELEVBQU8vQyxNQUFQLENBQWQ7O0FBQ0EsVUFBSStDLElBQUksQ0FBQ1csUUFBVCxFQUFtQjtBQUNqQlgsUUFBQUEsSUFBSSxDQUFDVyxRQUFMLENBQWNGLE9BQWQsQ0FBc0IsVUFBQ0csS0FBRCxFQUFlO0FBQ25DYixVQUFBQSxjQUFjLENBQUNhLEtBQUQsRUFBUTNELE1BQVIsQ0FBZDtBQUNELFNBRkQ7QUFHRDtBQUNGLEtBUEQ7QUFRRCxHQVREO0FBVUQ7QUFFRDs7Ozs7QUFHTyxJQUFNNEQsbUJBQW1CLEdBQUc7QUFDakNDLEVBQUFBLE9BRGlDLG1CQUN4QkMsTUFEd0IsRUFDYjtBQUNsQkEsSUFBQUEsTUFBTSxDQUFDQyxXQUFQLENBQW1CQyxHQUFuQixDQUF1QixpQkFBdkIsRUFBMENULG9CQUExQztBQUNBTyxJQUFBQSxNQUFNLENBQUNHLEtBQVAsQ0FBYUMsS0FBYixDQUFtQnJGLE9BQW5CO0FBQ0Q7QUFKZ0MsQ0FBNUI7OztBQWFQLElBQUksT0FBT3NGLE1BQVAsS0FBa0IsV0FBbEIsSUFBaUNBLE1BQU0sQ0FBQ0MsUUFBNUMsRUFBc0Q7QUFDcERELEVBQUFBLE1BQU0sQ0FBQ0MsUUFBUCxDQUFnQkMsR0FBaEIsQ0FBb0JULG1CQUFwQjtBQUNEOztlQUVjQSxtQiIsImZpbGUiOiJpbmRleC5jb21tb24uanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgWEVVdGlscyBmcm9tICd4ZS11dGlscy9tZXRob2RzL3hlLXV0aWxzJ1xyXG4vLyBpbXBvcnQgeyBWWEVUYWJsZSB9IGZyb20gJ3Z4ZS10YWJsZSdcclxuXHJcbmNvbnN0IG1lbnVNYXAgPSB7XHJcbiAgQ0xFQVJfQ0VMTCAoeyAkdGFibGUsIHJvdywgY29sdW1uIH06IGFueSkge1xyXG4gICAgaWYgKHJvdyAmJiBjb2x1bW4pIHtcclxuICAgICAgJHRhYmxlLmNsZWFyRGF0YShyb3csIGNvbHVtbi5wcm9wZXJ0eSlcclxuICAgIH1cclxuICB9LFxyXG4gIENMRUFSX1JPVyAoeyAkdGFibGUsIHJvdyB9OiBhbnkpIHtcclxuICAgIGlmIChyb3cpIHtcclxuICAgICAgJHRhYmxlLmNsZWFyRGF0YShyb3cpXHJcbiAgICB9XHJcbiAgfSxcclxuICBDTEVBUl9TRUxFQ1RJT05fUk9XICh7ICR0YWJsZSB9OiBhbnkpIHtcclxuICAgICR0YWJsZS5jbGVhckRhdGEoJHRhYmxlLmdldFNlbGVjdFJlY29yZHMoKSlcclxuICB9LFxyXG4gIENMRUFSX0FMTCAoeyAkdGFibGUgfTogYW55KSB7XHJcbiAgICAkdGFibGUuY2xlYXJEYXRhKClcclxuICB9LFxyXG4gIFJFVkVSVF9DRUxMICh7ICR0YWJsZSwgcm93LCBjb2x1bW4gfTogYW55KSB7XHJcbiAgICBpZiAocm93ICYmIGNvbHVtbikge1xyXG4gICAgICAkdGFibGUucmV2ZXJ0RGF0YShyb3csIGNvbHVtbi5wcm9wZXJ0eSlcclxuICAgIH1cclxuICB9LFxyXG4gIFJFVkVSVF9ST1cgKHsgJHRhYmxlLCByb3cgfTogYW55KSB7XHJcbiAgICBpZiAocm93KSB7XHJcbiAgICAgICR0YWJsZS5yZXZlcnREYXRhKHJvdylcclxuICAgIH1cclxuICB9LFxyXG4gIFJFVkVSVF9TRUxFQ1RJT05fUk9XICh7ICR0YWJsZSB9OiBhbnkpIHtcclxuICAgICR0YWJsZS5yZXZlcnREYXRhKCR0YWJsZS5nZXRTZWxlY3RSZWNvcmRzKCkpXHJcbiAgfSxcclxuICBSRVZFUlRfQUxMICh7ICR0YWJsZSB9OiBhbnkpIHtcclxuICAgICR0YWJsZS5yZXZlcnREYXRhKClcclxuICB9LFxyXG4gIElOU0VSVF9ST1cgKHsgJHRhYmxlLCBtZW51IH06IGFueSkge1xyXG4gICAgJHRhYmxlLmluc2VydChtZW51LnBhcmFtcylcclxuICB9LFxyXG4gIElOU0VSVF9BQ1RJVkVEX1JPVyAoeyAkdGFibGUsIG1lbnUsIGNvbHVtbiB9OiBhbnkpIHtcclxuICAgIGNvbnN0IGFyZ3MgPSBtZW51LnBhcmFtcyB8fCBbXVxyXG4gICAgJHRhYmxlLmluc2VydChhcmdzWzBdKVxyXG4gICAgICAudGhlbigoeyByb3cgfTogYW55KSA9PiAkdGFibGUuc2V0QWN0aXZlQ2VsbChyb3csIGFyZ3NbMV0gfHwgY29sdW1uLnByb3BlcnR5KSlcclxuICB9LFxyXG4gIElOU0VSVF9BVF9ST1cgKHsgJHRhYmxlLCBtZW51LCByb3cgfTogYW55KSB7XHJcbiAgICBpZiAocm93KSB7XHJcbiAgICAgICR0YWJsZS5pbnNlcnRBdChtZW51LnBhcmFtcywgcm93KVxyXG4gICAgfVxyXG4gIH0sXHJcbiAgSU5TRVJUX0FUX0FDVElWRURfUk9XICh7ICR0YWJsZSwgbWVudSwgcm93LCBjb2x1bW4gfTogYW55KSB7XHJcbiAgICBpZiAocm93KSB7XHJcbiAgICAgIGNvbnN0IGFyZ3MgPSBtZW51LnBhcmFtcyB8fCBbXVxyXG4gICAgICAkdGFibGUuaW5zZXJ0QXQoYXJnc1swXSwgcm93KVxyXG4gICAgICAgIC50aGVuKCh7IHJvdyB9OiBhbnkpID0+ICR0YWJsZS5zZXRBY3RpdmVDZWxsKHJvdywgYXJnc1sxXSB8fCBjb2x1bW4ucHJvcGVydHkpKVxyXG4gICAgfVxyXG4gIH0sXHJcbiAgREVMRVRFX1JPVyAoeyAkdGFibGUsIHJvdyB9OiBhbnkpIHtcclxuICAgIGlmIChyb3cpIHtcclxuICAgICAgJHRhYmxlLnJlbW92ZShyb3cpXHJcbiAgICB9XHJcbiAgfSxcclxuICBERUxFVEVfU0VMRUNUSU9OX1JPVyAoeyAkdGFibGUgfTogYW55KSB7XHJcbiAgICAkdGFibGUucmVtb3ZlU2VsZWN0ZWRzKClcclxuICB9LFxyXG4gIERFTEVURV9BTEwgKHsgJHRhYmxlIH06IGFueSkge1xyXG4gICAgJHRhYmxlLnJlbW92ZSgpXHJcbiAgfSxcclxuICBDTEVBUl9TT1JUICh7ICR0YWJsZSB9OiBhbnkpIHtcclxuICAgICR0YWJsZS5jbGVhclNvcnQoKVxyXG4gIH0sXHJcbiAgU09SVF9BU0MgKHsgJHRhYmxlLCBjb2x1bW4gfTogYW55LCBldm50OiBhbnkpIHtcclxuICAgIGlmIChjb2x1bW4pIHtcclxuICAgICAgJHRhYmxlLnRyaWdnZXJTb3J0RXZlbnQoZXZudCwgY29sdW1uLCAnYXNjJylcclxuICAgIH1cclxuICB9LFxyXG4gIFNPUlRfREVTQyAoeyAkdGFibGUsIGNvbHVtbiB9OiBhbnksIGV2bnQ6IGFueSkge1xyXG4gICAgaWYgKGNvbHVtbikge1xyXG4gICAgICAkdGFibGUudHJpZ2dlclNvcnRFdmVudChldm50LCBjb2x1bW4sICdkZXNjJylcclxuICAgIH1cclxuICB9LFxyXG4gIENMRUFSX0ZJTFRFUiAoeyAkdGFibGUsIGNvbHVtbiB9OiBhbnkpIHtcclxuICAgIGlmIChjb2x1bW4pIHtcclxuICAgICAgJHRhYmxlLmNsZWFyRmlsdGVyKGNvbHVtbi5wcm9wZXJ0eSlcclxuICAgIH1cclxuICB9LFxyXG4gIENMRUFSX0FMTF9GSUxURVIgKHsgJHRhYmxlIH06IGFueSkge1xyXG4gICAgJHRhYmxlLmNsZWFyRmlsdGVyKClcclxuICB9LFxyXG4gIEZJTFRFUl9DRUxMICh7ICR0YWJsZSwgcm93LCBjb2x1bW4gfTogYW55KSB7XHJcbiAgICBpZiAocm93ICYmIGNvbHVtbikge1xyXG4gICAgICBsZXQgeyBwcm9wZXJ0eSB9ID0gY29sdW1uXHJcbiAgICAgICR0YWJsZS5maWx0ZXIocHJvcGVydHkpXHJcbiAgICAgICAgLnRoZW4oKG9wdGlvbnM6IEFycmF5PGFueT4pID0+IHtcclxuICAgICAgICAgIGlmIChvcHRpb25zLmxlbmd0aCkge1xyXG4gICAgICAgICAgICBsZXQgb3B0aW9uID0gb3B0aW9uc1swXVxyXG4gICAgICAgICAgICBvcHRpb24uZGF0YSA9IFhFVXRpbHMuZ2V0KHJvdywgcHJvcGVydHkpXHJcbiAgICAgICAgICAgIG9wdGlvbi5jaGVja2VkID0gdHJ1ZVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLnRoZW4oKCkgPT4gJHRhYmxlLnVwZGF0ZURhdGEoKSlcclxuICAgIH1cclxuICB9LFxyXG4gIEVYUE9SVF9ST1cgKHsgJHRhYmxlLCBtZW51LCByb3cgfTogYW55KSB7XHJcbiAgICBpZiAocm93KSB7XHJcbiAgICAgIGxldCBvcHRzID0geyBkYXRhOiBbcm93XSB9XHJcbiAgICAgICR0YWJsZS5leHBvcnRDc3YobWVudS5wYXJhbXMgPyBYRVV0aWxzLmFzc2lnbihvcHRzLCBtZW51LnBhcmFtc1swXSkgOiBvcHRzKVxyXG4gICAgfVxyXG4gIH0sXHJcbiAgRVhQT1JUX1NFTEVDVElPTl9ST1cgKHsgJHRhYmxlLCBtZW51IH06IGFueSkge1xyXG4gICAgbGV0IG9wdHMgPSB7IGRhdGE6ICR0YWJsZS5nZXRTZWxlY3RSZWNvcmRzKCkgfVxyXG4gICAgJHRhYmxlLmV4cG9ydENzdihtZW51LnBhcmFtcyA/IFhFVXRpbHMuYXNzaWduKG9wdHMsIG1lbnUucGFyYW1zWzBdKSA6IG9wdHMpXHJcbiAgfSxcclxuICBFWFBPUlRfQUxMICh7ICR0YWJsZSB9OiBhbnkpIHtcclxuICAgICR0YWJsZS5leHBvcnRDc3YoKVxyXG4gIH0sXHJcbiAgSElEREVOX0NPTFVNTiAoeyAkdGFibGUsIGNvbHVtbiB9OiBhbnkpIHtcclxuICAgIGlmIChjb2x1bW4pIHtcclxuICAgICAgJHRhYmxlLmhpZGVDb2x1bW4oKVxyXG4gICAgfVxyXG4gIH0sXHJcbiAgUkVTRVRfQ09MVU1OICh7ICR0YWJsZSB9OiBhbnkpIHtcclxuICAgICR0YWJsZS5yZXNldEN1c3RvbXMoKVxyXG4gIH0sXHJcbiAgUkVTRVRfUkVTSVpBQkxFICh7ICR0YWJsZSB9OiBhbnkpIHtcclxuICAgICR0YWJsZS5yZXNldFJlc2l6YWJsZSgpXHJcbiAgfSxcclxuICBSRVNFVF9BTEwgKHsgJHRhYmxlIH06IGFueSkge1xyXG4gICAgJHRhYmxlLnJlc2V0QWxsKClcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNoZWNrUHJpdmlsZWdlIChpdGVtOiBhbnksIHBhcmFtczogYW55KSB7XHJcbiAgbGV0IHsgY29kZSB9ID0gaXRlbVxyXG4gIGxldCB7IGNvbHVtbnMsIGNvbHVtbiB9ID0gcGFyYW1zXHJcbiAgc3dpdGNoIChjb2RlKSB7XHJcbiAgICBjYXNlICdDTEVBUl9TT1JUJzpcclxuICAgICAgaXRlbS5kaXNhYmxlZCA9ICFjb2x1bW5zLnNvbWUoKGNvbHVtbjogYW55KSA9PiBjb2x1bW4uc29ydGFibGUgJiYgY29sdW1uLm9yZGVyKVxyXG4gICAgICBicmVha1xyXG4gICAgY2FzZSAnQ0xFQVJfQUxMX0ZJTFRFUic6XHJcbiAgICAgIGl0ZW0uZGlzYWJsZWQgPSAhY29sdW1ucy5zb21lKChjb2x1bW46IGFueSkgPT4gY29sdW1uLmZpbHRlcnMgJiYgY29sdW1uLmZpbHRlcnMuc29tZSgob3B0aW9uOiBhbnkpID0+IG9wdGlvbi5jaGVja2VkKSlcclxuICAgICAgYnJlYWtcclxuICAgIGNhc2UgJ0NMRUFSX0NFTEwnOlxyXG4gICAgY2FzZSAnQ0xFQVJfUk9XJzpcclxuICAgIGNhc2UgJ1JFVkVSVF9DRUxMJzpcclxuICAgIGNhc2UgJ1JFVkVSVF9ST1cnOlxyXG4gICAgY2FzZSAnSU5TRVJUX0FUX1JPVyc6XHJcbiAgICBjYXNlICdJTlNFUlRfQVRfQUNUSVZFRF9ST1cnOlxyXG4gICAgY2FzZSAnREVMRVRFX1JPVyc6XHJcbiAgICBjYXNlICdTT1JUX0FTQyc6XHJcbiAgICBjYXNlICdTT1JUX0RFU0MnOlxyXG4gICAgY2FzZSAnQ0xFQVJfRklMVEVSJzpcclxuICAgIGNhc2UgJ0ZJTFRFUl9DRUxMJzpcclxuICAgIGNhc2UgJ0VYUE9SVF9ST1cnOlxyXG4gICAgY2FzZSAnSElEREVOX0NPTFVNTic6XHJcbiAgICAgIGl0ZW0uZGlzYWJsZWQgPSAhY29sdW1uXHJcbiAgICAgIGlmICghaXRlbS5kaXNhYmxlZCkge1xyXG4gICAgICAgIHN3aXRjaCAoY29kZSkge1xyXG4gICAgICAgICAgY2FzZSAnU09SVF9BU0MnOlxyXG4gICAgICAgICAgY2FzZSAnU09SVF9ERVNDJzpcclxuICAgICAgICAgICAgaXRlbS5kaXNhYmxlZCA9ICFjb2x1bW4uc29ydGFibGVcclxuICAgICAgICAgICAgYnJlYWtcclxuICAgICAgICAgIGNhc2UgJ0ZJTFRFUl9DRUxMJzpcclxuICAgICAgICAgIGNhc2UgJ0NMRUFSX0ZJTFRFUic6XHJcbiAgICAgICAgICAgIGl0ZW0uZGlzYWJsZWQgPSAhY29sdW1uLmZpbHRlcnMgfHwgIWNvbHVtbi5maWx0ZXJzLmxlbmd0aFxyXG4gICAgICAgICAgICBpZiAoIWl0ZW0uZGlzYWJsZWQpIHtcclxuICAgICAgICAgICAgICBzd2l0Y2ggKGNvZGUpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgJ0NMRUFSX0ZJTFRFUic6XHJcbiAgICAgICAgICAgICAgICAgIGl0ZW0uZGlzYWJsZWQgPSAhY29sdW1uLmZpbHRlcnMuc29tZSgob3B0aW9uOiBhbnkpID0+IG9wdGlvbi5jaGVja2VkKVxyXG4gICAgICAgICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBicmVha1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBicmVha1xyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlUHJpdmlsZWdlRXZlbnQgKHBhcmFtczogYW55KSB7XHJcbiAgcGFyYW1zLm9wdGlvbnMuZm9yRWFjaCgobGlzdDogQXJyYXk8YW55PikgPT4ge1xyXG4gICAgbGlzdC5mb3JFYWNoKChpdGVtOiBhbnkpID0+IHtcclxuICAgICAgY2hlY2tQcml2aWxlZ2UoaXRlbSwgcGFyYW1zKVxyXG4gICAgICBpZiAoaXRlbS5jaGlsZHJlbikge1xyXG4gICAgICAgIGl0ZW0uY2hpbGRyZW4uZm9yRWFjaCgoY2hpbGQ6IGFueSkgPT4ge1xyXG4gICAgICAgICAgY2hlY2tQcml2aWxlZ2UoY2hpbGQsIHBhcmFtcylcclxuICAgICAgICB9KVxyXG4gICAgICB9XHJcbiAgICB9KVxyXG4gIH0pXHJcbn1cclxuXHJcbi8qKlxyXG4gKiDln7rkuo4gdnhlLXRhYmxlIOihqOagvOeahOWinuW8uuaPkuS7tu+8jOaPkOS+m+WunueUqOeahOW/q+aNt+iPnOWNlembhlxyXG4gKi9cclxuZXhwb3J0IGNvbnN0IFZYRVRhYmxlUGx1Z2luTWVudXMgPSB7XHJcbiAgaW5zdGFsbCAoeHRhYmxlOiBhbnkpIHtcclxuICAgIHh0YWJsZS5pbnRlcmNlcHRvci5hZGQoJ2V2ZW50LnNob3dfbWVudScsIGhhbmRsZVByaXZpbGVnZUV2ZW50KVxyXG4gICAgeHRhYmxlLm1lbnVzLm1peGluKG1lbnVNYXApXHJcbiAgfVxyXG59XHJcblxyXG5kZWNsYXJlIGdsb2JhbCB7XHJcbiAgaW50ZXJmYWNlIFdpbmRvdyB7XHJcbiAgICBWWEVUYWJsZTogYW55XHJcbiAgfVxyXG59XHJcblxyXG5pZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiYgd2luZG93LlZYRVRhYmxlKSB7XHJcbiAgd2luZG93LlZYRVRhYmxlLnVzZShWWEVUYWJsZVBsdWdpbk1lbnVzKVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBWWEVUYWJsZVBsdWdpbk1lbnVzXHJcbiJdfQ==
