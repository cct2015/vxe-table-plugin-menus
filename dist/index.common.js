"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = exports.VXETablePluginMenus = void 0;

var _xeUtils = _interopRequireDefault(require("xe-utils/methods/xe-utils"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

var menuMap = {
  CLEAR_CELL: function CLEAR_CELL(_ref) {
    var $table = _ref.$table,
        row = _ref.row,
        column = _ref.column;

    if (row && column) {
      $table.clearData(row, column.property);
    }
  },
  CLEAR_ROW: function CLEAR_ROW(_ref2) {
    var $table = _ref2.$table,
        row = _ref2.row;

    if (row) {
      $table.clearData(row);
    }
  },
  CLEAR_SELECTED_ROW: function CLEAR_SELECTED_ROW(_ref3) {
    var $table = _ref3.$table;
    $table.clearData($table.getSelectRecords());
  },
  CLEAR_ALL: function CLEAR_ALL(_ref4) {
    var $table = _ref4.$table;
    $table.clearData();
  },
  REVERT_CELL: function REVERT_CELL(_ref5) {
    var $table = _ref5.$table,
        row = _ref5.row,
        column = _ref5.column;

    if (row && column) {
      $table.revertData(row, column.property);
    }
  },
  REVERT_ROW: function REVERT_ROW(_ref6) {
    var $table = _ref6.$table,
        row = _ref6.row;

    if (row) {
      $table.revertData(row);
    }
  },
  REVERT_SELECTED_ROW: function REVERT_SELECTED_ROW(_ref7) {
    var $table = _ref7.$table;
    $table.revertData($table.getSelectRecords());
  },
  REVERT_ALL: function REVERT_ALL(_ref8) {
    var $table = _ref8.$table;
    $table.revertData();
  },
  INSERT_ROW: function INSERT_ROW(_ref9) {
    var $table = _ref9.$table,
        menu = _ref9.menu;
    $table.insert(menu.params);
  },
  INSERT_ACTIVED_ROW: function INSERT_ACTIVED_ROW(_ref10) {
    var $table = _ref10.$table,
        menu = _ref10.menu,
        column = _ref10.column;
    var args = menu.params || [];
    $table.insert(args[0]).then(function (_ref11) {
      var row = _ref11.row;
      return $table.setActiveCell(row, args[1] || column.property);
    });
  },
  INSERT_AT_ROW: function INSERT_AT_ROW(_ref12) {
    var $table = _ref12.$table,
        menu = _ref12.menu,
        row = _ref12.row;

    if (row) {
      $table.insertAt(menu.params, row);
    }
  },
  INSERT_AT_ACTIVED_ROW: function INSERT_AT_ACTIVED_ROW(_ref13) {
    var $table = _ref13.$table,
        menu = _ref13.menu,
        row = _ref13.row,
        column = _ref13.column;

    if (row) {
      var args = menu.params || [];
      $table.insertAt(args[0], row).then(function (_ref14) {
        var row = _ref14.row;
        return $table.setActiveCell(row, args[1] || column.property);
      });
    }
  },
  DELETE_ROW: function DELETE_ROW(_ref15) {
    var $table = _ref15.$table,
        row = _ref15.row;

    if (row) {
      $table.remove(row);
    }
  },
  DELETE_SELECTED_ROW: function DELETE_SELECTED_ROW(_ref16) {
    var $table = _ref16.$table;

    if ($table.removeCheckboxRow) {
      $table.removeCheckboxRow();
    } else {
      $table.removeSelecteds();
    }
  },
  DELETE_ALL: function DELETE_ALL(_ref17) {
    var $table = _ref17.$table;
    $table.remove();
  },
  CLEAR_SORT: function CLEAR_SORT(_ref18) {
    var $table = _ref18.$table;
    $table.clearSort();
  },
  SORT_ASC: function SORT_ASC(_ref19, evnt) {
    var $table = _ref19.$table,
        column = _ref19.column;

    if (column) {
      $table.triggerSortEvent(evnt, column, 'asc');
    }
  },
  SORT_DESC: function SORT_DESC(_ref20, evnt) {
    var $table = _ref20.$table,
        column = _ref20.column;

    if (column) {
      $table.triggerSortEvent(evnt, column, 'desc');
    }
  },
  CLEAR_FILTER: function CLEAR_FILTER(_ref21) {
    var $table = _ref21.$table,
        column = _ref21.column;

    if (column) {
      $table.clearFilter(column.property);
    }
  },
  CLEAR_ALL_FILTER: function CLEAR_ALL_FILTER(_ref22) {
    var $table = _ref22.$table;
    $table.clearFilter();
  },
  FILTER_CELL: function FILTER_CELL(_ref23) {
    var $table = _ref23.$table,
        row = _ref23.row,
        column = _ref23.column;

    if (row && column) {
      var property = column.property;
      $table.filter(property).then(function (options) {
        if (options.length) {
          var option = options[0];
          option.data = _xeUtils["default"].get(row, property);
          option.checked = true;
        }
      }).then(function () {
        return $table.updateData();
      });
    }
  },
  EXPORT_ROW: function EXPORT_ROW(_ref24) {
    var $table = _ref24.$table,
        menu = _ref24.menu,
        row = _ref24.row;

    if (row) {
      var opts = {
        data: [row]
      };
      $table.exportData(_xeUtils["default"].assign(opts, menu.params[0]));
    }
  },
  EXPORT_SELECTED_ROW: function EXPORT_SELECTED_ROW(_ref25) {
    var $table = _ref25.$table,
        menu = _ref25.menu;
    var opts = {
      data: $table.getSelectRecords()
    };
    $table.exportData(_xeUtils["default"].assign(opts, menu.params[0]));
  },
  EXPORT_ALL: function EXPORT_ALL(_ref26) {
    var $table = _ref26.$table,
        menu = _ref26.menu;
    $table.exportData(menu.params);
  },
  PRINT_ALL: function PRINT_ALL(_ref27) {
    var $table = _ref27.$table,
        menu = _ref27.menu;
    $table.print(menu.params);
  },
  PRINT_SELECTED_ROW: function PRINT_SELECTED_ROW(_ref28) {
    var $table = _ref28.$table,
        menu = _ref28.menu;
    var opts = {
      data: $table.getSelectRecords()
    };
    $table.print(_xeUtils["default"].assign(opts, menu.params));
  },
  HIDDEN_COLUMN: function HIDDEN_COLUMN(_ref29) {
    var $table = _ref29.$table,
        column = _ref29.column;

    if (column) {
      $table.hideColumn();
    }
  },
  RESET_COLUMN: function RESET_COLUMN(_ref30) {
    var $table = _ref30.$table;
    $table.resetCustoms();
  },
  RESET_RESIZABLE: function RESET_RESIZABLE(_ref31) {
    var $table = _ref31.$table;
    $table.resetResizable();
  },
  RESET_ALL: function RESET_ALL(_ref32) {
    var $table = _ref32.$table;
    $table.resetAll();
  }
};

function checkPrivilege(item, params) {
  var code = item.code;
  var columns = params.columns,
      column = params.column;

  switch (code) {
    case 'CLEAR_SORT':
      item.disabled = !columns.some(function (column) {
        return column.sortable && column.order;
      });
      break;

    case 'CLEAR_ALL_FILTER':
      item.disabled = !columns.some(function (column) {
        return column.filters && column.filters.some(function (option) {
          return option.checked;
        });
      });
      break;

    case 'CLEAR_CELL':
    case 'CLEAR_ROW':
    case 'REVERT_CELL':
    case 'REVERT_ROW':
    case 'INSERT_AT_ROW':
    case 'INSERT_AT_ACTIVED_ROW':
    case 'DELETE_ROW':
    case 'SORT_ASC':
    case 'SORT_DESC':
    case 'CLEAR_FILTER':
    case 'FILTER_CELL':
    case 'EXPORT_ROW':
    case 'HIDDEN_COLUMN':
      item.disabled = !column;

      if (!item.disabled) {
        switch (code) {
          case 'SORT_ASC':
          case 'SORT_DESC':
            item.disabled = !column.sortable;
            break;

          case 'FILTER_CELL':
          case 'CLEAR_FILTER':
            item.disabled = !column.filters || !column.filters.length;

            if (!item.disabled) {
              switch (code) {
                case 'CLEAR_FILTER':
                  item.disabled = !column.filters.some(function (option) {
                    return option.checked;
                  });
                  break;
              }
            }

            break;
        }
      }

      break;
  }
}

function handlePrivilegeEvent(params) {
  params.options.forEach(function (list) {
    list.forEach(function (item) {
      checkPrivilege(item, params);

      if (item.children) {
        item.children.forEach(function (child) {
          checkPrivilege(child, params);
        });
      }
    });
  });
}
/**
 * 基于 vxe-table 表格的增强插件，提供实用的快捷菜单集
 */


var VXETablePluginMenus = {
  install: function install(xtable) {
    xtable.interceptor.add('event.showMenu', handlePrivilegeEvent);
    xtable.menus.mixin(menuMap);
  }
};
exports.VXETablePluginMenus = VXETablePluginMenus;

if (typeof window !== 'undefined' && window.VXETable) {
  window.VXETable.use(VXETablePluginMenus);
}

var _default = VXETablePluginMenus;
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LnRzIl0sIm5hbWVzIjpbIm1lbnVNYXAiLCJDTEVBUl9DRUxMIiwiJHRhYmxlIiwicm93IiwiY29sdW1uIiwiY2xlYXJEYXRhIiwicHJvcGVydHkiLCJDTEVBUl9ST1ciLCJDTEVBUl9TRUxFQ1RFRF9ST1ciLCJnZXRTZWxlY3RSZWNvcmRzIiwiQ0xFQVJfQUxMIiwiUkVWRVJUX0NFTEwiLCJyZXZlcnREYXRhIiwiUkVWRVJUX1JPVyIsIlJFVkVSVF9TRUxFQ1RFRF9ST1ciLCJSRVZFUlRfQUxMIiwiSU5TRVJUX1JPVyIsIm1lbnUiLCJpbnNlcnQiLCJwYXJhbXMiLCJJTlNFUlRfQUNUSVZFRF9ST1ciLCJhcmdzIiwidGhlbiIsInNldEFjdGl2ZUNlbGwiLCJJTlNFUlRfQVRfUk9XIiwiaW5zZXJ0QXQiLCJJTlNFUlRfQVRfQUNUSVZFRF9ST1ciLCJERUxFVEVfUk9XIiwicmVtb3ZlIiwiREVMRVRFX1NFTEVDVEVEX1JPVyIsInJlbW92ZUNoZWNrYm94Um93IiwicmVtb3ZlU2VsZWN0ZWRzIiwiREVMRVRFX0FMTCIsIkNMRUFSX1NPUlQiLCJjbGVhclNvcnQiLCJTT1JUX0FTQyIsImV2bnQiLCJ0cmlnZ2VyU29ydEV2ZW50IiwiU09SVF9ERVNDIiwiQ0xFQVJfRklMVEVSIiwiY2xlYXJGaWx0ZXIiLCJDTEVBUl9BTExfRklMVEVSIiwiRklMVEVSX0NFTEwiLCJmaWx0ZXIiLCJvcHRpb25zIiwibGVuZ3RoIiwib3B0aW9uIiwiZGF0YSIsIlhFVXRpbHMiLCJnZXQiLCJjaGVja2VkIiwidXBkYXRlRGF0YSIsIkVYUE9SVF9ST1ciLCJvcHRzIiwiZXhwb3J0RGF0YSIsImFzc2lnbiIsIkVYUE9SVF9TRUxFQ1RFRF9ST1ciLCJFWFBPUlRfQUxMIiwiUFJJTlRfQUxMIiwicHJpbnQiLCJQUklOVF9TRUxFQ1RFRF9ST1ciLCJISURERU5fQ09MVU1OIiwiaGlkZUNvbHVtbiIsIlJFU0VUX0NPTFVNTiIsInJlc2V0Q3VzdG9tcyIsIlJFU0VUX1JFU0laQUJMRSIsInJlc2V0UmVzaXphYmxlIiwiUkVTRVRfQUxMIiwicmVzZXRBbGwiLCJjaGVja1ByaXZpbGVnZSIsIml0ZW0iLCJjb2RlIiwiY29sdW1ucyIsImRpc2FibGVkIiwic29tZSIsInNvcnRhYmxlIiwib3JkZXIiLCJmaWx0ZXJzIiwiaGFuZGxlUHJpdmlsZWdlRXZlbnQiLCJmb3JFYWNoIiwibGlzdCIsImNoaWxkcmVuIiwiY2hpbGQiLCJWWEVUYWJsZVBsdWdpbk1lbnVzIiwiaW5zdGFsbCIsInh0YWJsZSIsImludGVyY2VwdG9yIiwiYWRkIiwibWVudXMiLCJtaXhpbiIsIndpbmRvdyIsIlZYRVRhYmxlIiwidXNlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7Ozs7QUFHQSxJQUFNQSxPQUFPLEdBQUc7QUFDZEMsRUFBQUEsVUFEYyw0QkFDeUI7QUFBQSxRQUExQkMsTUFBMEIsUUFBMUJBLE1BQTBCO0FBQUEsUUFBbEJDLEdBQWtCLFFBQWxCQSxHQUFrQjtBQUFBLFFBQWJDLE1BQWEsUUFBYkEsTUFBYTs7QUFDckMsUUFBSUQsR0FBRyxJQUFJQyxNQUFYLEVBQW1CO0FBQ2pCRixNQUFBQSxNQUFNLENBQUNHLFNBQVAsQ0FBaUJGLEdBQWpCLEVBQXNCQyxNQUFNLENBQUNFLFFBQTdCO0FBQ0Q7QUFDRixHQUxhO0FBTWRDLEVBQUFBLFNBTmMsNEJBTWdCO0FBQUEsUUFBbEJMLE1BQWtCLFNBQWxCQSxNQUFrQjtBQUFBLFFBQVZDLEdBQVUsU0FBVkEsR0FBVTs7QUFDNUIsUUFBSUEsR0FBSixFQUFTO0FBQ1BELE1BQUFBLE1BQU0sQ0FBQ0csU0FBUCxDQUFpQkYsR0FBakI7QUFDRDtBQUNGLEdBVmE7QUFXZEssRUFBQUEsa0JBWGMscUNBV29CO0FBQUEsUUFBYk4sTUFBYSxTQUFiQSxNQUFhO0FBQ2hDQSxJQUFBQSxNQUFNLENBQUNHLFNBQVAsQ0FBaUJILE1BQU0sQ0FBQ08sZ0JBQVAsRUFBakI7QUFDRCxHQWJhO0FBY2RDLEVBQUFBLFNBZGMsNEJBY1c7QUFBQSxRQUFiUixNQUFhLFNBQWJBLE1B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QkMsR0FBbkIsQ0FBdUIsZ0JBQXZCLEVBQXlDVCxvQkFBekM7QUFDQU8sSUFBQUEsTUFBTSxDQUFDRyxLQUFQLENBQWFDLEtBQWIsQ0FBbUJ6RixPQUFuQjtBQUNEO0FBSmdDLENBQTVCOzs7QUFPUCxJQUFJLE9BQU8wRixNQUFQLEtBQWtCLFdBQWxCLElBQWlDQSxNQUFNLENBQUNDLFFBQTVDLEVBQXNEO0FBQ3BERCxFQUFBQSxNQUFNLENBQUNDLFFBQVAsQ0FBZ0JDLEdBQWhCLENBQW9CVCxtQkFBcEI7QUFDRDs7ZUFFY0EsbUIiLCJmaWxlIjoiaW5kZXguY29tbW9uLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFhFVXRpbHMgZnJvbSAneGUtdXRpbHMvbWV0aG9kcy94ZS11dGlscydcclxuaW1wb3J0IFZYRVRhYmxlIGZyb20gJ3Z4ZS10YWJsZS9saWIvdnhlLXRhYmxlJ1xyXG5cclxuY29uc3QgbWVudU1hcCA9IHtcclxuICBDTEVBUl9DRUxMKHsgJHRhYmxlLCByb3csIGNvbHVtbiB9OiBhbnkpIHtcclxuICAgIGlmIChyb3cgJiYgY29sdW1uKSB7XHJcbiAgICAgICR0YWJsZS5jbGVhckRhdGEocm93LCBjb2x1bW4ucHJvcGVydHkpXHJcbiAgICB9XHJcbiAgfSxcclxuICBDTEVBUl9ST1coeyAkdGFibGUsIHJvdyB9OiBhbnkpIHtcclxuICAgIGlmIChyb3cpIHtcclxuICAgICAgJHRhYmxlLmNsZWFyRGF0YShyb3cpXHJcbiAgICB9XHJcbiAgfSxcclxuICBDTEVBUl9TRUxFQ1RFRF9ST1coeyAkdGFibGUgfTogYW55KSB7XHJcbiAgICAkdGFibGUuY2xlYXJEYXRhKCR0YWJsZS5nZXRTZWxlY3RSZWNvcmRzKCkpXHJcbiAgfSxcclxuICBDTEVBUl9BTEwoeyAkdGFibGUgfTogYW55KSB7XHJcbiAgICAkdGFibGUuY2xlYXJEYXRhKClcclxuICB9LFxyXG4gIFJFVkVSVF9DRUxMKHsgJHRhYmxlLCByb3csIGNvbHVtbiB9OiBhbnkpIHtcclxuICAgIGlmIChyb3cgJiYgY29sdW1uKSB7XHJcbiAgICAgICR0YWJsZS5yZXZlcnREYXRhKHJvdywgY29sdW1uLnByb3BlcnR5KVxyXG4gICAgfVxyXG4gIH0sXHJcbiAgUkVWRVJUX1JPVyh7ICR0YWJsZSwgcm93IH06IGFueSkge1xyXG4gICAgaWYgKHJvdykge1xyXG4gICAgICAkdGFibGUucmV2ZXJ0RGF0YShyb3cpXHJcbiAgICB9XHJcbiAgfSxcclxuICBSRVZFUlRfU0VMRUNURURfUk9XKHsgJHRhYmxlIH06IGFueSkge1xyXG4gICAgJHRhYmxlLnJldmVydERhdGEoJHRhYmxlLmdldFNlbGVjdFJlY29yZHMoKSlcclxuICB9LFxyXG4gIFJFVkVSVF9BTEwoeyAkdGFibGUgfTogYW55KSB7XHJcbiAgICAkdGFibGUucmV2ZXJ0RGF0YSgpXHJcbiAgfSxcclxuICBJTlNFUlRfUk9XKHsgJHRhYmxlLCBtZW51IH06IGFueSkge1xyXG4gICAgJHRhYmxlLmluc2VydChtZW51LnBhcmFtcylcclxuICB9LFxyXG4gIElOU0VSVF9BQ1RJVkVEX1JPVyh7ICR0YWJsZSwgbWVudSwgY29sdW1uIH06IGFueSkge1xyXG4gICAgY29uc3QgYXJncyA9IG1lbnUucGFyYW1zIHx8IFtdXHJcbiAgICAkdGFibGUuaW5zZXJ0KGFyZ3NbMF0pXHJcbiAgICAgIC50aGVuKCh7IHJvdyB9OiBhbnkpID0+ICR0YWJsZS5zZXRBY3RpdmVDZWxsKHJvdywgYXJnc1sxXSB8fCBjb2x1bW4ucHJvcGVydHkpKVxyXG4gIH0sXHJcbiAgSU5TRVJUX0FUX1JPVyh7ICR0YWJsZSwgbWVudSwgcm93IH06IGFueSkge1xyXG4gICAgaWYgKHJvdykge1xyXG4gICAgICAkdGFibGUuaW5zZXJ0QXQobWVudS5wYXJhbXMsIHJvdylcclxuICAgIH1cclxuICB9LFxyXG4gIElOU0VSVF9BVF9BQ1RJVkVEX1JPVyh7ICR0YWJsZSwgbWVudSwgcm93LCBjb2x1bW4gfTogYW55KSB7XHJcbiAgICBpZiAocm93KSB7XHJcbiAgICAgIGNvbnN0IGFyZ3MgPSBtZW51LnBhcmFtcyB8fCBbXVxyXG4gICAgICAkdGFibGUuaW5zZXJ0QXQoYXJnc1swXSwgcm93KVxyXG4gICAgICAgIC50aGVuKCh7IHJvdyB9OiBhbnkpID0+ICR0YWJsZS5zZXRBY3RpdmVDZWxsKHJvdywgYXJnc1sxXSB8fCBjb2x1bW4ucHJvcGVydHkpKVxyXG4gICAgfVxyXG4gIH0sXHJcbiAgREVMRVRFX1JPVyh7ICR0YWJsZSwgcm93IH06IGFueSkge1xyXG4gICAgaWYgKHJvdykge1xyXG4gICAgICAkdGFibGUucmVtb3ZlKHJvdylcclxuICAgIH1cclxuICB9LFxyXG4gIERFTEVURV9TRUxFQ1RFRF9ST1coeyAkdGFibGUgfTogYW55KSB7XHJcbiAgICBpZiAoJHRhYmxlLnJlbW92ZUNoZWNrYm94Um93KSB7XHJcbiAgICAgICR0YWJsZS5yZW1vdmVDaGVja2JveFJvdygpXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAkdGFibGUucmVtb3ZlU2VsZWN0ZWRzKClcclxuICAgIH1cclxuICB9LFxyXG4gIERFTEVURV9BTEwoeyAkdGFibGUgfTogYW55KSB7XHJcbiAgICAkdGFibGUucmVtb3ZlKClcclxuICB9LFxyXG4gIENMRUFSX1NPUlQoeyAkdGFibGUgfTogYW55KSB7XHJcbiAgICAkdGFibGUuY2xlYXJTb3J0KClcclxuICB9LFxyXG4gIFNPUlRfQVNDKHsgJHRhYmxlLCBjb2x1bW4gfTogYW55LCBldm50OiBhbnkpIHtcclxuICAgIGlmIChjb2x1bW4pIHtcclxuICAgICAgJHRhYmxlLnRyaWdnZXJTb3J0RXZlbnQoZXZudCwgY29sdW1uLCAnYXNjJylcclxuICAgIH1cclxuICB9LFxyXG4gIFNPUlRfREVTQyh7ICR0YWJsZSwgY29sdW1uIH06IGFueSwgZXZudDogYW55KSB7XHJcbiAgICBpZiAoY29sdW1uKSB7XHJcbiAgICAgICR0YWJsZS50cmlnZ2VyU29ydEV2ZW50KGV2bnQsIGNvbHVtbiwgJ2Rlc2MnKVxyXG4gICAgfVxyXG4gIH0sXHJcbiAgQ0xFQVJfRklMVEVSKHsgJHRhYmxlLCBjb2x1bW4gfTogYW55KSB7XHJcbiAgICBpZiAoY29sdW1uKSB7XHJcbiAgICAgICR0YWJsZS5jbGVhckZpbHRlcihjb2x1bW4ucHJvcGVydHkpXHJcbiAgICB9XHJcbiAgfSxcclxuICBDTEVBUl9BTExfRklMVEVSKHsgJHRhYmxlIH06IGFueSkge1xyXG4gICAgJHRhYmxlLmNsZWFyRmlsdGVyKClcclxuICB9LFxyXG4gIEZJTFRFUl9DRUxMKHsgJHRhYmxlLCByb3csIGNvbHVtbiB9OiBhbnkpIHtcclxuICAgIGlmIChyb3cgJiYgY29sdW1uKSB7XHJcbiAgICAgIGxldCB7IHByb3BlcnR5IH0gPSBjb2x1bW5cclxuICAgICAgJHRhYmxlLmZpbHRlcihwcm9wZXJ0eSlcclxuICAgICAgICAudGhlbigob3B0aW9uczogQXJyYXk8YW55PikgPT4ge1xyXG4gICAgICAgICAgaWYgKG9wdGlvbnMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIGxldCBvcHRpb24gPSBvcHRpb25zWzBdXHJcbiAgICAgICAgICAgIG9wdGlvbi5kYXRhID0gWEVVdGlscy5nZXQocm93LCBwcm9wZXJ0eSlcclxuICAgICAgICAgICAgb3B0aW9uLmNoZWNrZWQgPSB0cnVlXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgICAgICAudGhlbigoKSA9PiAkdGFibGUudXBkYXRlRGF0YSgpKVxyXG4gICAgfVxyXG4gIH0sXHJcbiAgRVhQT1JUX1JPVyh7ICR0YWJsZSwgbWVudSwgcm93IH06IGFueSkge1xyXG4gICAgaWYgKHJvdykge1xyXG4gICAgICBsZXQgb3B0cyA9IHsgZGF0YTogW3Jvd10gfVxyXG4gICAgICAkdGFibGUuZXhwb3J0RGF0YShYRVV0aWxzLmFzc2lnbihvcHRzLCBtZW51LnBhcmFtc1swXSkpXHJcbiAgICB9XHJcbiAgfSxcclxuICBFWFBPUlRfU0VMRUNURURfUk9XKHsgJHRhYmxlLCBtZW51IH06IGFueSkge1xyXG4gICAgbGV0IG9wdHMgPSB7IGRhdGE6ICR0YWJsZS5nZXRTZWxlY3RSZWNvcmRzKCkgfVxyXG4gICAgJHRhYmxlLmV4cG9ydERhdGEoWEVVdGlscy5hc3NpZ24ob3B0cywgbWVudS5wYXJhbXNbMF0pKVxyXG4gIH0sXHJcbiAgRVhQT1JUX0FMTCh7ICR0YWJsZSwgbWVudSB9OiBhbnkpIHtcclxuICAgICR0YWJsZS5leHBvcnREYXRhKG1lbnUucGFyYW1zKVxyXG4gIH0sXHJcbiAgUFJJTlRfQUxMKHsgJHRhYmxlLCBtZW51IH06IGFueSkge1xyXG4gICAgJHRhYmxlLnByaW50KG1lbnUucGFyYW1zKVxyXG4gIH0sXHJcbiAgUFJJTlRfU0VMRUNURURfUk9XKHsgJHRhYmxlLCBtZW51IH06IGFueSkge1xyXG4gICAgbGV0IG9wdHMgPSB7IGRhdGE6ICR0YWJsZS5nZXRTZWxlY3RSZWNvcmRzKCkgfVxyXG4gICAgJHRhYmxlLnByaW50KFhFVXRpbHMuYXNzaWduKG9wdHMsIG1lbnUucGFyYW1zKSlcclxuICB9LFxyXG4gIEhJRERFTl9DT0xVTU4oeyAkdGFibGUsIGNvbHVtbiB9OiBhbnkpIHtcclxuICAgIGlmIChjb2x1bW4pIHtcclxuICAgICAgJHRhYmxlLmhpZGVDb2x1bW4oKVxyXG4gICAgfVxyXG4gIH0sXHJcbiAgUkVTRVRfQ09MVU1OKHsgJHRhYmxlIH06IGFueSkge1xyXG4gICAgJHRhYmxlLnJlc2V0Q3VzdG9tcygpXHJcbiAgfSxcclxuICBSRVNFVF9SRVNJWkFCTEUoeyAkdGFibGUgfTogYW55KSB7XHJcbiAgICAkdGFibGUucmVzZXRSZXNpemFibGUoKVxyXG4gIH0sXHJcbiAgUkVTRVRfQUxMKHsgJHRhYmxlIH06IGFueSkge1xyXG4gICAgJHRhYmxlLnJlc2V0QWxsKClcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNoZWNrUHJpdmlsZWdlKGl0ZW06IGFueSwgcGFyYW1zOiBhbnkpIHtcclxuICBsZXQgeyBjb2RlIH0gPSBpdGVtXHJcbiAgbGV0IHsgY29sdW1ucywgY29sdW1uIH0gPSBwYXJhbXNcclxuICBzd2l0Y2ggKGNvZGUpIHtcclxuICAgIGNhc2UgJ0NMRUFSX1NPUlQnOlxyXG4gICAgICBpdGVtLmRpc2FibGVkID0gIWNvbHVtbnMuc29tZSgoY29sdW1uOiBhbnkpID0+IGNvbHVtbi5zb3J0YWJsZSAmJiBjb2x1bW4ub3JkZXIpXHJcbiAgICAgIGJyZWFrXHJcbiAgICBjYXNlICdDTEVBUl9BTExfRklMVEVSJzpcclxuICAgICAgaXRlbS5kaXNhYmxlZCA9ICFjb2x1bW5zLnNvbWUoKGNvbHVtbjogYW55KSA9PiBjb2x1bW4uZmlsdGVycyAmJiBjb2x1bW4uZmlsdGVycy5zb21lKChvcHRpb246IGFueSkgPT4gb3B0aW9uLmNoZWNrZWQpKVxyXG4gICAgICBicmVha1xyXG4gICAgY2FzZSAnQ0xFQVJfQ0VMTCc6XHJcbiAgICBjYXNlICdDTEVBUl9ST1cnOlxyXG4gICAgY2FzZSAnUkVWRVJUX0NFTEwnOlxyXG4gICAgY2FzZSAnUkVWRVJUX1JPVyc6XHJcbiAgICBjYXNlICdJTlNFUlRfQVRfUk9XJzpcclxuICAgIGNhc2UgJ0lOU0VSVF9BVF9BQ1RJVkVEX1JPVyc6XHJcbiAgICBjYXNlICdERUxFVEVfUk9XJzpcclxuICAgIGNhc2UgJ1NPUlRfQVNDJzpcclxuICAgIGNhc2UgJ1NPUlRfREVTQyc6XHJcbiAgICBjYXNlICdDTEVBUl9GSUxURVInOlxyXG4gICAgY2FzZSAnRklMVEVSX0NFTEwnOlxyXG4gICAgY2FzZSAnRVhQT1JUX1JPVyc6XHJcbiAgICBjYXNlICdISURERU5fQ09MVU1OJzpcclxuICAgICAgaXRlbS5kaXNhYmxlZCA9ICFjb2x1bW5cclxuICAgICAgaWYgKCFpdGVtLmRpc2FibGVkKSB7XHJcbiAgICAgICAgc3dpdGNoIChjb2RlKSB7XHJcbiAgICAgICAgICBjYXNlICdTT1JUX0FTQyc6XHJcbiAgICAgICAgICBjYXNlICdTT1JUX0RFU0MnOlxyXG4gICAgICAgICAgICBpdGVtLmRpc2FibGVkID0gIWNvbHVtbi5zb3J0YWJsZVxyXG4gICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgY2FzZSAnRklMVEVSX0NFTEwnOlxyXG4gICAgICAgICAgY2FzZSAnQ0xFQVJfRklMVEVSJzpcclxuICAgICAgICAgICAgaXRlbS5kaXNhYmxlZCA9ICFjb2x1bW4uZmlsdGVycyB8fCAhY29sdW1uLmZpbHRlcnMubGVuZ3RoXHJcbiAgICAgICAgICAgIGlmICghaXRlbS5kaXNhYmxlZCkge1xyXG4gICAgICAgICAgICAgIHN3aXRjaCAoY29kZSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnQ0xFQVJfRklMVEVSJzpcclxuICAgICAgICAgICAgICAgICAgaXRlbS5kaXNhYmxlZCA9ICFjb2x1bW4uZmlsdGVycy5zb21lKChvcHRpb246IGFueSkgPT4gb3B0aW9uLmNoZWNrZWQpXHJcbiAgICAgICAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGJyZWFrXHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVQcml2aWxlZ2VFdmVudChwYXJhbXM6IGFueSkge1xyXG4gIHBhcmFtcy5vcHRpb25zLmZvckVhY2goKGxpc3Q6IEFycmF5PGFueT4pID0+IHtcclxuICAgIGxpc3QuZm9yRWFjaCgoaXRlbTogYW55KSA9PiB7XHJcbiAgICAgIGNoZWNrUHJpdmlsZWdlKGl0ZW0sIHBhcmFtcylcclxuICAgICAgaWYgKGl0ZW0uY2hpbGRyZW4pIHtcclxuICAgICAgICBpdGVtLmNoaWxkcmVuLmZvckVhY2goKGNoaWxkOiBhbnkpID0+IHtcclxuICAgICAgICAgIGNoZWNrUHJpdmlsZWdlKGNoaWxkLCBwYXJhbXMpXHJcbiAgICAgICAgfSlcclxuICAgICAgfVxyXG4gICAgfSlcclxuICB9KVxyXG59XHJcblxyXG4vKipcclxuICog5Z+65LqOIHZ4ZS10YWJsZSDooajmoLznmoTlop7lvLrmj5Lku7bvvIzmj5Dkvpvlrp7nlKjnmoTlv6vmjbfoj5zljZXpm4ZcclxuICovXHJcbmV4cG9ydCBjb25zdCBWWEVUYWJsZVBsdWdpbk1lbnVzID0ge1xyXG4gIGluc3RhbGwoeHRhYmxlOiB0eXBlb2YgVlhFVGFibGUpIHtcclxuICAgIHh0YWJsZS5pbnRlcmNlcHRvci5hZGQoJ2V2ZW50LnNob3dNZW51JywgaGFuZGxlUHJpdmlsZWdlRXZlbnQpXHJcbiAgICB4dGFibGUubWVudXMubWl4aW4obWVudU1hcClcclxuICB9XHJcbn1cclxuXHJcbmlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB3aW5kb3cuVlhFVGFibGUpIHtcclxuICB3aW5kb3cuVlhFVGFibGUudXNlKFZYRVRhYmxlUGx1Z2luTWVudXMpXHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFZYRVRhYmxlUGx1Z2luTWVudXNcclxuIl19
