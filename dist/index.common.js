"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = exports.VXETablePluginMenus = void 0;

var _xeUtils = _interopRequireDefault(require("xe-utils/methods/xe-utils"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

var menuMap = {
  CLEAR_CELL: function CLEAR_CELL(_ref) {
    var $table = _ref.$table,
        row = _ref.row,
        column = _ref.column;

    if (row && column) {
      $table.clearData(row, column.property);
    }
  },
  CLEAR_ROW: function CLEAR_ROW(_ref2) {
    var $table = _ref2.$table,
        row = _ref2.row;

    if (row) {
      $table.clearData(row);
    }
  },
  CLEAR_SELECTION_ROW: function CLEAR_SELECTION_ROW(_ref3) {
    var $table = _ref3.$table;
    $table.clearData($table.getSelectRecords());
  },
  CLEAR_ALL: function CLEAR_ALL(_ref4) {
    var $table = _ref4.$table;
    $table.clearData();
  },
  REVERT_CELL: function REVERT_CELL(_ref5) {
    var $table = _ref5.$table,
        row = _ref5.row,
        column = _ref5.column;

    if (row && column) {
      $table.revertData(row, column.property);
    }
  },
  REVERT_ROW: function REVERT_ROW(_ref6) {
    var $table = _ref6.$table,
        row = _ref6.row;

    if (row) {
      $table.revertData(row);
    }
  },
  REVERT_SELECTION_ROW: function REVERT_SELECTION_ROW(_ref7) {
    var $table = _ref7.$table;
    $table.revertData($table.getSelectRecords());
  },
  REVERT_ALL: function REVERT_ALL(_ref8) {
    var $table = _ref8.$table;
    $table.revertData();
  },
  INSERT_ROW: function INSERT_ROW(_ref9) {
    var $table = _ref9.$table,
        menu = _ref9.menu;
    $table.insert(menu.params);
  },
  INSERT_ACTIVED_ROW: function INSERT_ACTIVED_ROW(_ref10) {
    var $table = _ref10.$table,
        menu = _ref10.menu,
        column = _ref10.column;
    var args = menu.params || [];
    $table.insert(args[0]).then(function (_ref11) {
      var row = _ref11.row;
      return $table.setActiveCell(row, args[1] || column.property);
    });
  },
  INSERT_AT_ROW: function INSERT_AT_ROW(_ref12) {
    var $table = _ref12.$table,
        menu = _ref12.menu,
        row = _ref12.row;

    if (row) {
      $table.insertAt(menu.params, row);
    }
  },
  INSERT_AT_ACTIVED_ROW: function INSERT_AT_ACTIVED_ROW(_ref13) {
    var $table = _ref13.$table,
        menu = _ref13.menu,
        row = _ref13.row,
        column = _ref13.column;

    if (row) {
      var args = menu.params || [];
      $table.insertAt(args[0], row).then(function (_ref14) {
        var row = _ref14.row;
        return $table.setActiveCell(row, args[1] || column.property);
      });
    }
  },
  DELETE_ROW: function DELETE_ROW(_ref15) {
    var $table = _ref15.$table,
        row = _ref15.row;

    if (row) {
      $table.remove(row);
    }
  },
  DELETE_SELECTION_ROW: function DELETE_SELECTION_ROW(_ref16) {
    var $table = _ref16.$table;
    $table.removeSelecteds();
  },
  DELETE_ALL: function DELETE_ALL(_ref17) {
    var $table = _ref17.$table;
    $table.remove();
  },
  CLEAR_SORT: function CLEAR_SORT(_ref18) {
    var $table = _ref18.$table;
    $table.clearSort();
  },
  SORT_ASC: function SORT_ASC(_ref19, evnt) {
    var $table = _ref19.$table,
        column = _ref19.column;

    if (column) {
      $table.triggerSortEvent(evnt, column, 'asc');
    }
  },
  SORT_DESC: function SORT_DESC(_ref20, evnt) {
    var $table = _ref20.$table,
        column = _ref20.column;

    if (column) {
      $table.triggerSortEvent(evnt, column, 'desc');
    }
  },
  CLEAR_FILTER: function CLEAR_FILTER(_ref21) {
    var $table = _ref21.$table,
        column = _ref21.column;

    if (column) {
      $table.clearFilter(column.property);
    }
  },
  CLEAR_ALL_FILTER: function CLEAR_ALL_FILTER(_ref22) {
    var $table = _ref22.$table;
    $table.clearFilter();
  },
  FILTER_CELL: function FILTER_CELL(_ref23) {
    var $table = _ref23.$table,
        row = _ref23.row,
        column = _ref23.column;

    if (row && column) {
      var property = column.property;
      $table.filter(property).then(function (options) {
        if (options.length) {
          var option = options[0];
          option.data = _xeUtils["default"].get(row, property);
          option.checked = true;
        }
      }).then(function () {
        return $table.updateData();
      });
    }
  },
  EXPORT_ROW: function EXPORT_ROW(_ref24) {
    var $table = _ref24.$table,
        menu = _ref24.menu,
        row = _ref24.row;

    if (row) {
      var opts = {
        data: [row]
      };
      $table.exportData(menu.params ? _xeUtils["default"].assign(opts, menu.params[0]) : opts);
    }
  },
  EXPORT_SELECTION_ROW: function EXPORT_SELECTION_ROW(_ref25) {
    var $table = _ref25.$table,
        menu = _ref25.menu;
    var opts = {
      data: $table.getSelectRecords()
    };
    $table.exportData(menu.params ? _xeUtils["default"].assign(opts, menu.params[0]) : opts);
  },
  EXPORT_ALL: function EXPORT_ALL(_ref26) {
    var $table = _ref26.$table,
        menu = _ref26.menu;
    $table.exportData(menu.params);
  },
  HIDDEN_COLUMN: function HIDDEN_COLUMN(_ref27) {
    var $table = _ref27.$table,
        column = _ref27.column;

    if (column) {
      $table.hideColumn();
    }
  },
  RESET_COLUMN: function RESET_COLUMN(_ref28) {
    var $table = _ref28.$table;
    $table.resetCustoms();
  },
  RESET_RESIZABLE: function RESET_RESIZABLE(_ref29) {
    var $table = _ref29.$table;
    $table.resetResizable();
  },
  RESET_ALL: function RESET_ALL(_ref30) {
    var $table = _ref30.$table;
    $table.resetAll();
  }
};

function checkPrivilege(item, params) {
  var code = item.code;
  var columns = params.columns,
      column = params.column;

  switch (code) {
    case 'CLEAR_SORT':
      item.disabled = !columns.some(function (column) {
        return column.sortable && column.order;
      });
      break;

    case 'CLEAR_ALL_FILTER':
      item.disabled = !columns.some(function (column) {
        return column.filters && column.filters.some(function (option) {
          return option.checked;
        });
      });
      break;

    case 'CLEAR_CELL':
    case 'CLEAR_ROW':
    case 'REVERT_CELL':
    case 'REVERT_ROW':
    case 'INSERT_AT_ROW':
    case 'INSERT_AT_ACTIVED_ROW':
    case 'DELETE_ROW':
    case 'SORT_ASC':
    case 'SORT_DESC':
    case 'CLEAR_FILTER':
    case 'FILTER_CELL':
    case 'EXPORT_ROW':
    case 'HIDDEN_COLUMN':
      item.disabled = !column;

      if (!item.disabled) {
        switch (code) {
          case 'SORT_ASC':
          case 'SORT_DESC':
            item.disabled = !column.sortable;
            break;

          case 'FILTER_CELL':
          case 'CLEAR_FILTER':
            item.disabled = !column.filters || !column.filters.length;

            if (!item.disabled) {
              switch (code) {
                case 'CLEAR_FILTER':
                  item.disabled = !column.filters.some(function (option) {
                    return option.checked;
                  });
                  break;
              }
            }

            break;
        }
      }

      break;
  }
}

function handlePrivilegeEvent(params) {
  params.options.forEach(function (list) {
    list.forEach(function (item) {
      checkPrivilege(item, params);

      if (item.children) {
        item.children.forEach(function (child) {
          checkPrivilege(child, params);
        });
      }
    });
  });
}
/**
 * 基于 vxe-table 表格的增强插件，提供实用的快捷菜单集
 */


var VXETablePluginMenus = {
  install: function install(xtable) {
    xtable.interceptor.add('event.showMenu', handlePrivilegeEvent);
    xtable.menus.mixin(menuMap);
  }
};
exports.VXETablePluginMenus = VXETablePluginMenus;

if (typeof window !== 'undefined' && window.VXETable) {
  window.VXETable.use(VXETablePluginMenus);
}

var _default = VXETablePluginMenus;
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LnRzIl0sIm5hbWVzIjpbIm1lbnVNYXAiLCJDTEVBUl9DRUxMIiwiJHRhYmxlIiwicm93IiwiY29sdW1uIiwiY2xlYXJEYXRhIiwicHJvcGVydHkiLCJDTEVBUl9ST1ciLCJDTEVBUl9TRUxFQ1RJT05fUk9XIiwiZ2V0U2VsZWN0UmVjb3JkcyIsIkNMRUFSX0FMTCIsIlJFVkVSVF9DRUxMIiwicmV2ZXJ0RGF0YSIsIlJFVkVSVF9ST1ciLCJSRVZFUlRfU0VMRUNUSU9OX1JPVyIsIlJFVkVSVF9BTEwiLCJJTlNFUlRfUk9XIiwibWVudSIsImluc2VydCIsInBhcmFtcyIsIklOU0VSVF9BQ1RJVkVEX1JPVyIsImFyZ3MiLCJ0aGVuIiwic2V0QWN0aXZlQ2VsbCIsIklOU0VSVF9BVF9ST1ciLCJpbnNlcnRBdCIsIklOU0VSVF9BVF9BQ1RJVkVEX1JPVyIsIkRFTEVURV9ST1ciLCJyZW1vdmUiLCJERUxFVEVfU0VMRUNUSU9OX1JPVyIsInJlbW92ZVNlbGVjdGVkcyIsIkRFTEVURV9BTEwiLCJDTEVBUl9TT1JUIiwiY2xlYXJTb3J0IiwiU09SVF9BU0MiLCJldm50IiwidHJpZ2dlclNvcnRFdmVudCIsIlNPUlRfREVTQyIsIkNMRUFSX0ZJTFRFUiIsImNsZWFyRmlsdGVyIiwiQ0xFQVJfQUxMX0ZJTFRFUiIsIkZJTFRFUl9DRUxMIiwiZmlsdGVyIiwib3B0aW9ucyIsImxlbmd0aCIsIm9wdGlvbiIsImRhdGEiLCJYRVV0aWxzIiwiZ2V0IiwiY2hlY2tlZCIsInVwZGF0ZURhdGEiLCJFWFBPUlRfUk9XIiwib3B0cyIsImV4cG9ydERhdGEiLCJhc3NpZ24iLCJFWFBPUlRfU0VMRUNUSU9OX1JPVyIsIkVYUE9SVF9BTEwiLCJISURERU5fQ09MVU1OIiwiaGlkZUNvbHVtbiIsIlJFU0VUX0NPTFVNTiIsInJlc2V0Q3VzdG9tcyIsIlJFU0VUX1JFU0laQUJMRSIsInJlc2V0UmVzaXphYmxlIiwiUkVTRVRfQUxMIiwicmVzZXRBbGwiLCJjaGVja1ByaXZpbGVnZSIsIml0ZW0iLCJjb2RlIiwiY29sdW1ucyIsImRpc2FibGVkIiwic29tZSIsInNvcnRhYmxlIiwib3JkZXIiLCJmaWx0ZXJzIiwiaGFuZGxlUHJpdmlsZWdlRXZlbnQiLCJmb3JFYWNoIiwibGlzdCIsImNoaWxkcmVuIiwiY2hpbGQiLCJWWEVUYWJsZVBsdWdpbk1lbnVzIiwiaW5zdGFsbCIsInh0YWJsZSIsImludGVyY2VwdG9yIiwiYWRkIiwibWVudXMiLCJtaXhpbiIsIndpbmRvdyIsIlZYRVRhYmxlIiwidXNlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7Ozs7QUFHQSxJQUFNQSxPQUFPLEdBQUc7QUFDZEMsRUFBQUEsVUFEYyw0QkFDMEI7QUFBQSxRQUExQkMsTUFBMEIsUUFBMUJBLE1BQTBCO0FBQUEsUUFBbEJDLEdBQWtCLFFBQWxCQSxHQUFrQjtBQUFBLFFBQWJDLE1BQWEsUUFBYkEsTUFBYTs7QUFDdEMsUUFBSUQsR0FBRyxJQUFJQyxNQUFYLEVBQW1CO0FBQ2pCRixNQUFBQSxNQUFNLENBQUNHLFNBQVAsQ0FBaUJGLEdBQWpCLEVBQXNCQyxNQUFNLENBQUNFLFFBQTdCO0FBQ0Q7QUFDRixHQUxhO0FBTWRDLEVBQUFBLFNBTmMsNEJBTWlCO0FBQUEsUUFBbEJMLE1BQWtCLFNBQWxCQSxNQUFrQjtBQUFBLFFBQVZDLEdBQVUsU0FBVkEsR0FBVTs7QUFDN0IsUUFBSUEsR0FBSixFQUFTO0FBQ1BELE1BQUFBLE1BQU0sQ0FBQ0csU0FBUCxDQUFpQkYsR0FBakI7QUFDRDtBQUNGLEdBVmE7QUFXZEssRUFBQUEsbUJBWGMsc0NBV3NCO0FBQUEsUUFBYk4sTUFBYSxTQUFiQSxNQUFhO0FBQ2xDQSxJQUFBQSxNQUFNLENBQUNHLFNBQVAsQ0FBaUJILE1BQU0sQ0FBQ08sZ0JBQVAsRUFBakI7QUFDRCxHQWJhO0FBY2RDLEVBQUFBLFNBZGMsNEJBY1k7QUFBQSxRQUFiUixNQUFhLFNBQWJBLE1BQWE7QUFDeEJBLElBQUFBLE1BQU0sQ0FBQ0csU0FBUDtBQUNELEdBaEJhO0FBaUJkTSxFQUFBQSxX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QyxPQUFmLENBQXVCLFVBQUNDLElBQUQsRUFBcUI7QUFDMUNBLElBQUFBLElBQUksQ0FBQ0QsT0FBTCxDQUFhLFVBQUNULElBQUQsRUFBYztBQUN6QkQsTUFBQUEsY0FBYyxDQUFDQyxJQUFELEVBQU8vQyxNQUFQLENBQWQ7O0FBQ0EsVUFBSStDLElBQUksQ0FBQ1csUUFBVCxFQUFtQjtBQUNqQlgsUUFBQUEsSUFBSSxDQUFDVyxRQUFMLENBQWNGLE9BQWQsQ0FBc0IsVUFBQ0csS0FBRCxFQUFlO0FBQ25DYixVQUFBQSxjQUFjLENBQUNhLEtBQUQsRUFBUTNELE1BQVIsQ0FBZDtBQUNELFNBRkQ7QUFHRDtBQUNGLEtBUEQ7QUFRRCxHQVREO0FBVUQ7QUFFRDs7Ozs7QUFHTyxJQUFNNEQsbUJBQW1CLEdBQUc7QUFDakNDLEVBQUFBLE9BRGlDLG1CQUN4QkMsTUFEd0IsRUFDRDtBQUM5QkEsSUFBQUEsTUFBTSxDQUFDQyxXQUFQLENBQW1CQyxHQUFuQixDQUF1QixnQkFBdkIsRUFBeUNULG9CQUF6QztBQUNBTyxJQUFBQSxNQUFNLENBQUNHLEtBQVAsQ0FBYUMsS0FBYixDQUFtQnJGLE9BQW5CO0FBQ0Q7QUFKZ0MsQ0FBNUI7OztBQU9QLElBQUksT0FBT3NGLE1BQVAsS0FBa0IsV0FBbEIsSUFBaUNBLE1BQU0sQ0FBQ0MsUUFBNUMsRUFBc0Q7QUFDcERELEVBQUFBLE1BQU0sQ0FBQ0MsUUFBUCxDQUFnQkMsR0FBaEIsQ0FBb0JULG1CQUFwQjtBQUNEOztlQUVjQSxtQiIsImZpbGUiOiJpbmRleC5jb21tb24uanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgWEVVdGlscyBmcm9tICd4ZS11dGlscy9tZXRob2RzL3hlLXV0aWxzJ1xyXG5pbXBvcnQgVlhFVGFibGUgZnJvbSAndnhlLXRhYmxlL2xpYi92eGUtdGFibGUnXHJcblxyXG5jb25zdCBtZW51TWFwID0ge1xyXG4gIENMRUFSX0NFTEwgKHsgJHRhYmxlLCByb3csIGNvbHVtbiB9OiBhbnkpIHtcclxuICAgIGlmIChyb3cgJiYgY29sdW1uKSB7XHJcbiAgICAgICR0YWJsZS5jbGVhckRhdGEocm93LCBjb2x1bW4ucHJvcGVydHkpXHJcbiAgICB9XHJcbiAgfSxcclxuICBDTEVBUl9ST1cgKHsgJHRhYmxlLCByb3cgfTogYW55KSB7XHJcbiAgICBpZiAocm93KSB7XHJcbiAgICAgICR0YWJsZS5jbGVhckRhdGEocm93KVxyXG4gICAgfVxyXG4gIH0sXHJcbiAgQ0xFQVJfU0VMRUNUSU9OX1JPVyAoeyAkdGFibGUgfTogYW55KSB7XHJcbiAgICAkdGFibGUuY2xlYXJEYXRhKCR0YWJsZS5nZXRTZWxlY3RSZWNvcmRzKCkpXHJcbiAgfSxcclxuICBDTEVBUl9BTEwgKHsgJHRhYmxlIH06IGFueSkge1xyXG4gICAgJHRhYmxlLmNsZWFyRGF0YSgpXHJcbiAgfSxcclxuICBSRVZFUlRfQ0VMTCAoeyAkdGFibGUsIHJvdywgY29sdW1uIH06IGFueSkge1xyXG4gICAgaWYgKHJvdyAmJiBjb2x1bW4pIHtcclxuICAgICAgJHRhYmxlLnJldmVydERhdGEocm93LCBjb2x1bW4ucHJvcGVydHkpXHJcbiAgICB9XHJcbiAgfSxcclxuICBSRVZFUlRfUk9XICh7ICR0YWJsZSwgcm93IH06IGFueSkge1xyXG4gICAgaWYgKHJvdykge1xyXG4gICAgICAkdGFibGUucmV2ZXJ0RGF0YShyb3cpXHJcbiAgICB9XHJcbiAgfSxcclxuICBSRVZFUlRfU0VMRUNUSU9OX1JPVyAoeyAkdGFibGUgfTogYW55KSB7XHJcbiAgICAkdGFibGUucmV2ZXJ0RGF0YSgkdGFibGUuZ2V0U2VsZWN0UmVjb3JkcygpKVxyXG4gIH0sXHJcbiAgUkVWRVJUX0FMTCAoeyAkdGFibGUgfTogYW55KSB7XHJcbiAgICAkdGFibGUucmV2ZXJ0RGF0YSgpXHJcbiAgfSxcclxuICBJTlNFUlRfUk9XICh7ICR0YWJsZSwgbWVudSB9OiBhbnkpIHtcclxuICAgICR0YWJsZS5pbnNlcnQobWVudS5wYXJhbXMpXHJcbiAgfSxcclxuICBJTlNFUlRfQUNUSVZFRF9ST1cgKHsgJHRhYmxlLCBtZW51LCBjb2x1bW4gfTogYW55KSB7XHJcbiAgICBjb25zdCBhcmdzID0gbWVudS5wYXJhbXMgfHwgW11cclxuICAgICR0YWJsZS5pbnNlcnQoYXJnc1swXSlcclxuICAgICAgLnRoZW4oKHsgcm93IH06IGFueSkgPT4gJHRhYmxlLnNldEFjdGl2ZUNlbGwocm93LCBhcmdzWzFdIHx8IGNvbHVtbi5wcm9wZXJ0eSkpXHJcbiAgfSxcclxuICBJTlNFUlRfQVRfUk9XICh7ICR0YWJsZSwgbWVudSwgcm93IH06IGFueSkge1xyXG4gICAgaWYgKHJvdykge1xyXG4gICAgICAkdGFibGUuaW5zZXJ0QXQobWVudS5wYXJhbXMsIHJvdylcclxuICAgIH1cclxuICB9LFxyXG4gIElOU0VSVF9BVF9BQ1RJVkVEX1JPVyAoeyAkdGFibGUsIG1lbnUsIHJvdywgY29sdW1uIH06IGFueSkge1xyXG4gICAgaWYgKHJvdykge1xyXG4gICAgICBjb25zdCBhcmdzID0gbWVudS5wYXJhbXMgfHwgW11cclxuICAgICAgJHRhYmxlLmluc2VydEF0KGFyZ3NbMF0sIHJvdylcclxuICAgICAgICAudGhlbigoeyByb3cgfTogYW55KSA9PiAkdGFibGUuc2V0QWN0aXZlQ2VsbChyb3csIGFyZ3NbMV0gfHwgY29sdW1uLnByb3BlcnR5KSlcclxuICAgIH1cclxuICB9LFxyXG4gIERFTEVURV9ST1cgKHsgJHRhYmxlLCByb3cgfTogYW55KSB7XHJcbiAgICBpZiAocm93KSB7XHJcbiAgICAgICR0YWJsZS5yZW1vdmUocm93KVxyXG4gICAgfVxyXG4gIH0sXHJcbiAgREVMRVRFX1NFTEVDVElPTl9ST1cgKHsgJHRhYmxlIH06IGFueSkge1xyXG4gICAgJHRhYmxlLnJlbW92ZVNlbGVjdGVkcygpXHJcbiAgfSxcclxuICBERUxFVEVfQUxMICh7ICR0YWJsZSB9OiBhbnkpIHtcclxuICAgICR0YWJsZS5yZW1vdmUoKVxyXG4gIH0sXHJcbiAgQ0xFQVJfU09SVCAoeyAkdGFibGUgfTogYW55KSB7XHJcbiAgICAkdGFibGUuY2xlYXJTb3J0KClcclxuICB9LFxyXG4gIFNPUlRfQVNDICh7ICR0YWJsZSwgY29sdW1uIH06IGFueSwgZXZudDogYW55KSB7XHJcbiAgICBpZiAoY29sdW1uKSB7XHJcbiAgICAgICR0YWJsZS50cmlnZ2VyU29ydEV2ZW50KGV2bnQsIGNvbHVtbiwgJ2FzYycpXHJcbiAgICB9XHJcbiAgfSxcclxuICBTT1JUX0RFU0MgKHsgJHRhYmxlLCBjb2x1bW4gfTogYW55LCBldm50OiBhbnkpIHtcclxuICAgIGlmIChjb2x1bW4pIHtcclxuICAgICAgJHRhYmxlLnRyaWdnZXJTb3J0RXZlbnQoZXZudCwgY29sdW1uLCAnZGVzYycpXHJcbiAgICB9XHJcbiAgfSxcclxuICBDTEVBUl9GSUxURVIgKHsgJHRhYmxlLCBjb2x1bW4gfTogYW55KSB7XHJcbiAgICBpZiAoY29sdW1uKSB7XHJcbiAgICAgICR0YWJsZS5jbGVhckZpbHRlcihjb2x1bW4ucHJvcGVydHkpXHJcbiAgICB9XHJcbiAgfSxcclxuICBDTEVBUl9BTExfRklMVEVSICh7ICR0YWJsZSB9OiBhbnkpIHtcclxuICAgICR0YWJsZS5jbGVhckZpbHRlcigpXHJcbiAgfSxcclxuICBGSUxURVJfQ0VMTCAoeyAkdGFibGUsIHJvdywgY29sdW1uIH06IGFueSkge1xyXG4gICAgaWYgKHJvdyAmJiBjb2x1bW4pIHtcclxuICAgICAgbGV0IHsgcHJvcGVydHkgfSA9IGNvbHVtblxyXG4gICAgICAkdGFibGUuZmlsdGVyKHByb3BlcnR5KVxyXG4gICAgICAgIC50aGVuKChvcHRpb25zOiBBcnJheTxhbnk+KSA9PiB7XHJcbiAgICAgICAgICBpZiAob3B0aW9ucy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgbGV0IG9wdGlvbiA9IG9wdGlvbnNbMF1cclxuICAgICAgICAgICAgb3B0aW9uLmRhdGEgPSBYRVV0aWxzLmdldChyb3csIHByb3BlcnR5KVxyXG4gICAgICAgICAgICBvcHRpb24uY2hlY2tlZCA9IHRydWVcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgICAgIC50aGVuKCgpID0+ICR0YWJsZS51cGRhdGVEYXRhKCkpXHJcbiAgICB9XHJcbiAgfSxcclxuICBFWFBPUlRfUk9XICh7ICR0YWJsZSwgbWVudSwgcm93IH06IGFueSkge1xyXG4gICAgaWYgKHJvdykge1xyXG4gICAgICBsZXQgb3B0cyA9IHsgZGF0YTogW3Jvd10gfVxyXG4gICAgICAkdGFibGUuZXhwb3J0RGF0YShtZW51LnBhcmFtcyA/IFhFVXRpbHMuYXNzaWduKG9wdHMsIG1lbnUucGFyYW1zWzBdKSA6IG9wdHMpXHJcbiAgICB9XHJcbiAgfSxcclxuICBFWFBPUlRfU0VMRUNUSU9OX1JPVyAoeyAkdGFibGUsIG1lbnUgfTogYW55KSB7XHJcbiAgICBsZXQgb3B0cyA9IHsgZGF0YTogJHRhYmxlLmdldFNlbGVjdFJlY29yZHMoKSB9XHJcbiAgICAkdGFibGUuZXhwb3J0RGF0YShtZW51LnBhcmFtcyA/IFhFVXRpbHMuYXNzaWduKG9wdHMsIG1lbnUucGFyYW1zWzBdKSA6IG9wdHMpXHJcbiAgfSxcclxuICBFWFBPUlRfQUxMICh7ICR0YWJsZSwgbWVudSB9OiBhbnkpIHtcclxuICAgICR0YWJsZS5leHBvcnREYXRhKG1lbnUucGFyYW1zKVxyXG4gIH0sXHJcbiAgSElEREVOX0NPTFVNTiAoeyAkdGFibGUsIGNvbHVtbiB9OiBhbnkpIHtcclxuICAgIGlmIChjb2x1bW4pIHtcclxuICAgICAgJHRhYmxlLmhpZGVDb2x1bW4oKVxyXG4gICAgfVxyXG4gIH0sXHJcbiAgUkVTRVRfQ09MVU1OICh7ICR0YWJsZSB9OiBhbnkpIHtcclxuICAgICR0YWJsZS5yZXNldEN1c3RvbXMoKVxyXG4gIH0sXHJcbiAgUkVTRVRfUkVTSVpBQkxFICh7ICR0YWJsZSB9OiBhbnkpIHtcclxuICAgICR0YWJsZS5yZXNldFJlc2l6YWJsZSgpXHJcbiAgfSxcclxuICBSRVNFVF9BTEwgKHsgJHRhYmxlIH06IGFueSkge1xyXG4gICAgJHRhYmxlLnJlc2V0QWxsKClcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNoZWNrUHJpdmlsZWdlIChpdGVtOiBhbnksIHBhcmFtczogYW55KSB7XHJcbiAgbGV0IHsgY29kZSB9ID0gaXRlbVxyXG4gIGxldCB7IGNvbHVtbnMsIGNvbHVtbiB9ID0gcGFyYW1zXHJcbiAgc3dpdGNoIChjb2RlKSB7XHJcbiAgICBjYXNlICdDTEVBUl9TT1JUJzpcclxuICAgICAgaXRlbS5kaXNhYmxlZCA9ICFjb2x1bW5zLnNvbWUoKGNvbHVtbjogYW55KSA9PiBjb2x1bW4uc29ydGFibGUgJiYgY29sdW1uLm9yZGVyKVxyXG4gICAgICBicmVha1xyXG4gICAgY2FzZSAnQ0xFQVJfQUxMX0ZJTFRFUic6XHJcbiAgICAgIGl0ZW0uZGlzYWJsZWQgPSAhY29sdW1ucy5zb21lKChjb2x1bW46IGFueSkgPT4gY29sdW1uLmZpbHRlcnMgJiYgY29sdW1uLmZpbHRlcnMuc29tZSgob3B0aW9uOiBhbnkpID0+IG9wdGlvbi5jaGVja2VkKSlcclxuICAgICAgYnJlYWtcclxuICAgIGNhc2UgJ0NMRUFSX0NFTEwnOlxyXG4gICAgY2FzZSAnQ0xFQVJfUk9XJzpcclxuICAgIGNhc2UgJ1JFVkVSVF9DRUxMJzpcclxuICAgIGNhc2UgJ1JFVkVSVF9ST1cnOlxyXG4gICAgY2FzZSAnSU5TRVJUX0FUX1JPVyc6XHJcbiAgICBjYXNlICdJTlNFUlRfQVRfQUNUSVZFRF9ST1cnOlxyXG4gICAgY2FzZSAnREVMRVRFX1JPVyc6XHJcbiAgICBjYXNlICdTT1JUX0FTQyc6XHJcbiAgICBjYXNlICdTT1JUX0RFU0MnOlxyXG4gICAgY2FzZSAnQ0xFQVJfRklMVEVSJzpcclxuICAgIGNhc2UgJ0ZJTFRFUl9DRUxMJzpcclxuICAgIGNhc2UgJ0VYUE9SVF9ST1cnOlxyXG4gICAgY2FzZSAnSElEREVOX0NPTFVNTic6XHJcbiAgICAgIGl0ZW0uZGlzYWJsZWQgPSAhY29sdW1uXHJcbiAgICAgIGlmICghaXRlbS5kaXNhYmxlZCkge1xyXG4gICAgICAgIHN3aXRjaCAoY29kZSkge1xyXG4gICAgICAgICAgY2FzZSAnU09SVF9BU0MnOlxyXG4gICAgICAgICAgY2FzZSAnU09SVF9ERVNDJzpcclxuICAgICAgICAgICAgaXRlbS5kaXNhYmxlZCA9ICFjb2x1bW4uc29ydGFibGVcclxuICAgICAgICAgICAgYnJlYWtcclxuICAgICAgICAgIGNhc2UgJ0ZJTFRFUl9DRUxMJzpcclxuICAgICAgICAgIGNhc2UgJ0NMRUFSX0ZJTFRFUic6XHJcbiAgICAgICAgICAgIGl0ZW0uZGlzYWJsZWQgPSAhY29sdW1uLmZpbHRlcnMgfHwgIWNvbHVtbi5maWx0ZXJzLmxlbmd0aFxyXG4gICAgICAgICAgICBpZiAoIWl0ZW0uZGlzYWJsZWQpIHtcclxuICAgICAgICAgICAgICBzd2l0Y2ggKGNvZGUpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgJ0NMRUFSX0ZJTFRFUic6XHJcbiAgICAgICAgICAgICAgICAgIGl0ZW0uZGlzYWJsZWQgPSAhY29sdW1uLmZpbHRlcnMuc29tZSgob3B0aW9uOiBhbnkpID0+IG9wdGlvbi5jaGVja2VkKVxyXG4gICAgICAgICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBicmVha1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBicmVha1xyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlUHJpdmlsZWdlRXZlbnQgKHBhcmFtczogYW55KSB7XHJcbiAgcGFyYW1zLm9wdGlvbnMuZm9yRWFjaCgobGlzdDogQXJyYXk8YW55PikgPT4ge1xyXG4gICAgbGlzdC5mb3JFYWNoKChpdGVtOiBhbnkpID0+IHtcclxuICAgICAgY2hlY2tQcml2aWxlZ2UoaXRlbSwgcGFyYW1zKVxyXG4gICAgICBpZiAoaXRlbS5jaGlsZHJlbikge1xyXG4gICAgICAgIGl0ZW0uY2hpbGRyZW4uZm9yRWFjaCgoY2hpbGQ6IGFueSkgPT4ge1xyXG4gICAgICAgICAgY2hlY2tQcml2aWxlZ2UoY2hpbGQsIHBhcmFtcylcclxuICAgICAgICB9KVxyXG4gICAgICB9XHJcbiAgICB9KVxyXG4gIH0pXHJcbn1cclxuXHJcbi8qKlxyXG4gKiDln7rkuo4gdnhlLXRhYmxlIOihqOagvOeahOWinuW8uuaPkuS7tu+8jOaPkOS+m+WunueUqOeahOW/q+aNt+iPnOWNlembhlxyXG4gKi9cclxuZXhwb3J0IGNvbnN0IFZYRVRhYmxlUGx1Z2luTWVudXMgPSB7XHJcbiAgaW5zdGFsbCAoeHRhYmxlOiB0eXBlb2YgVlhFVGFibGUpIHtcclxuICAgIHh0YWJsZS5pbnRlcmNlcHRvci5hZGQoJ2V2ZW50LnNob3dNZW51JywgaGFuZGxlUHJpdmlsZWdlRXZlbnQpXHJcbiAgICB4dGFibGUubWVudXMubWl4aW4obWVudU1hcClcclxuICB9XHJcbn1cclxuXHJcbmlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB3aW5kb3cuVlhFVGFibGUpIHtcclxuICB3aW5kb3cuVlhFVGFibGUudXNlKFZYRVRhYmxlUGx1Z2luTWVudXMpXHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFZYRVRhYmxlUGx1Z2luTWVudXNcclxuIl19
